# ============================================
# Project Valine - Local Development Environment
# ============================================
#
# This file is an example of the .env file you should create for local development.
# Copy this file to .env (or .env.local) and fill in your actual values.
#
# IMPORTANT: Never commit .env files to version control!
# These files are in .gitignore for security.
#

# --------------------------------------------
# Frontend API Configuration
# --------------------------------------------

# Backend API Base URL
# This is the primary configuration for connecting the frontend to the backend.
# IMPORTANT: Use API Gateway URL, NOT CloudFront URL for API calls
#
# For local development with serverless offline:
VITE_API_BASE=http://localhost:3001
#
# For deployed dev/staging backend:
# VITE_API_BASE=https://your-api-id.execute-api.us-west-2.amazonaws.com/dev
#
# For production (example with actual API Gateway):
# VITE_API_BASE=https://i72dxlcfcc.execute-api.us-west-2.amazonaws.com

# Enable authentication enforcement
# Set to 'true' to enforce real authentication (requires backend auth endpoints)
# Set to 'false' or leave empty to allow dev bypass mode
# Default: false (development bypass enabled)
VITE_ENABLE_AUTH=false

# Registration Control - Show/hide signup UI in frontend
# Set to 'true' to show "Sign Up" button and registration routes
# Set to 'false' to hide signup UI and disable registration routes
# Must match backend ENABLE_REGISTRATION flag
# Default: false (registration hidden in production)
VITE_ENABLE_REGISTRATION=false

# API Credentials Mode - Controls withCredentials for cookie-based authentication
# Set to 'true' if your backend uses HTTP-only cookies for auth
# Set to 'false' if using Bearer tokens (default)
# Default: false
VITE_API_USE_CREDENTIALS=true

# API Path Normalization - Strip legacy /api prefix from request paths
# Set to 'true' to automatically remove '/api' prefix from request paths
# Useful when backend doesn't use /api prefix but frontend code has legacy paths
# Default: false
VITE_API_STRIP_LEGACY_API_PREFIX=false

# Analytics - Enable analytics tracking and config fetching
# Set to 'true' to enable analytics config fetch and event tracking
# Set to 'false' to disable analytics entirely (recommended for development)
# Default: false
VITE_ANALYTICS_ENABLED=false

# Dev Bypass - LOCALHOST-ONLY authentication bypass for fast UX iteration
# Set to 'true' to enable "Dev Bypass" button on login page (LOCALHOST ONLY)
# ⚠️ MUST be 'false' in production - never deploy with this enabled
# Default: false (safe default)
VITE_ENABLE_DEV_BYPASS=true

# Frontend URL - Used for CORS and dev bypass production domain check
# Development: http://localhost:5173
# Production: https://d1abc.cloudfront.net or https://projectvaline.com
# Default: http://localhost:5173
VITE_FRONTEND_URL=http://localhost:5173

# --------------------------------------------
# How to Get Your API URL
# --------------------------------------------
#
# 1. Local Development (Serverless Offline):
#    - Navigate to the serverless/ directory
#    - Run: npm install
#    - Run: npx serverless offline
#    - Use: http://localhost:3001
#
# 2. Deployed Backend (AWS):
#    - Deploy backend: cd serverless && npx serverless deploy
#    - Copy the API Gateway URL from the deployment output
#    - It will look like: https://abc123xyz.execute-api.us-west-2.amazonaws.com/dev
#
# 3. Using the Configuration Script:
#    - Run: ./scripts/deployment/configure-frontend.sh --api-url <YOUR_API_URL>
#    - This will automatically update your .env file
#

# --------------------------------------------
# API Fallback Behavior
# --------------------------------------------
#
# The application uses the useApiFallback hook to gracefully handle API failures:
#
# - Network errors (offline, connection refused) → Use mock data
# - 5xx server errors → Use mock data
# - 4xx client errors → Show error to user (no fallback)
#
# Diagnostics are logged to browser localStorage and console.
# Access diagnostics in dev tools: window.__diagnostics.summary()
#

# --------------------------------------------
# Backend Configuration (NOT used by frontend)
# --------------------------------------------
# These variables are only used by the serverless backend.
# They should be set in the serverless/.env file or AWS Lambda environment.

# Database connection (backend only)
# DATABASE_URL=postgresql://username:password@localhost:5432/valine_db

# AWS Region (backend only)
# AWS_REGION=us-west-2

# Deployment stage (backend only)
# STAGE=dev

# --------------------------------------------
# Quick Start Guide
# --------------------------------------------
#
# 1. Copy this file:
#    cp .env.local.example .env
#
# 2. Update VITE_API_BASE with your backend URL
#
# 3. Start the frontend dev server:
#    npm run dev
#
# 4. The app will attempt to connect to the API.
#    If the API is unavailable, it will use mock data automatically.
#
# 5. Check diagnostics in console or run:
#    window.__diagnostics.summary()
#

# --------------------------------------------
# Troubleshooting
# --------------------------------------------
#
# Frontend can't connect to API:
# - Check that VITE_API_BASE is set correctly
# - Verify backend is running (local or deployed)
# - Check CORS settings in backend
# - Look for diagnostics logs in browser console
#
# Mock data showing instead of real data:
# - API might be down or returning 5xx errors
# - Check diagnostics: window.__diagnostics.get()
# - Verify API_BASE URL is correct
# - Check network tab in browser dev tools
#
# Changes not reflecting:
# - Restart dev server after changing .env files
# - Clear browser cache and localStorage
# - Hard refresh (Ctrl+Shift+R or Cmd+Shift+R)
#
