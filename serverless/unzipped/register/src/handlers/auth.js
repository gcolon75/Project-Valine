var R0=Object.create;var Ot=Object.defineProperty;var T0=Object.getOwnPropertyDescriptor;var I0=Object.getOwnPropertyNames;var N0=Object.getPrototypeOf,M0=Object.prototype.hasOwnProperty;var P0=(t,e)=>()=>(t&&(e=t(t=0)),e);var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),q0=(t,e)=>{for(var r in e)Ot(t,r,{get:e[r],enumerable:!0})},Bi=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of I0(e))!M0.call(t,n)&&n!==r&&Ot(t,n,{get:()=>e[n],enumerable:!(s=T0(e,n))||s.enumerable});return t};var ke=(t,e,r)=>(r=t!=null?R0(N0(t)):{},Bi(e||!t||!t.__esModule?Ot(r,"default",{value:t,enumerable:!0}):r,t)),ji=t=>Bi(Ot({},"__esModule",{value:!0}),t);var Y0={};function V0(t){return typeof t=="function"?t:e=>e.$extends(t)}function z0(t){return t}var Vr,L0,D0,B0,j0,F0,$0,Fi,U0,G0,H0,Q0,$i,K0,Ui=P0(()=>{"use strict";Vr=Object.defineProperty,L0=Object.getOwnPropertyDescriptor,D0=Object.getOwnPropertyNames,B0=Object.prototype.hasOwnProperty,j0=(t,e)=>{for(var r in e)Vr(t,r,{get:e[r],enumerable:!0})},F0=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of D0(e))!B0.call(t,n)&&n!==r&&Vr(t,n,{get:()=>e[n],enumerable:!(s=L0(e,n))||s.enumerable});return t},$0=t=>F0(Vr({},"__esModule",{value:!0}),t),Fi={};j0(Fi,{Prisma:()=>$i,PrismaClient:()=>Q0,default:()=>K0});module.exports=$0(Fi);U0={enginesVersion:"2ba551f319ab1df4bc874a89965d8b3641056773"},G0="6.19.0",H0=G0,Q0=class{constructor(){throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.')}};$i={defineExtension:V0,getExtensionContext:z0,prismaVersion:{client:H0,engine:U0.enginesVersion}},K0={Prisma:$i}});var Hi=h(($E,Gi)=>{Gi.exports={...(Ui(),ji(Y0))}});var oo=h(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});function hd(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var io=hd(require("crypto")),pd=(t,e,r)=>io.createHmac(t,Buffer.from(e,"hex")).update(Buffer.from(r,"hex")).digest().toString("hex"),yd=(t,e)=>io.randomBytes(t).toString(e);Tt.createDigest=pd;Tt.createRandomBytes=yd});var co=h(es=>{"use strict";var gd="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",ao=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];function md(t){var e=Math.floor(t.length/5);return t.length%5===0?e:e+1}es.encode=function(t){Buffer.isBuffer(t)||(t=new Buffer(t));for(var e=0,r=0,s=0,n=0,i=new Buffer(md(t)*8);e<t.length;){var o=t[e];s>3?(n=o&255>>s,s=(s+5)%8,n=n<<s|(e+1<t.length?t[e+1]:0)>>8-s,e++):(n=o>>8-(s+5)&31,s=(s+5)%8,s===0&&e++),i[r]=gd.charCodeAt(n),r++}for(e=r;e<i.length;e++)i[e]=61;return i};es.decode=function(t){var e=0,r=0,s,n=0;Buffer.isBuffer(t)||(t=new Buffer(t));for(var i=new Buffer(Math.ceil(t.length*5/8)),o=0;o<t.length&&t[o]!==61;o++){var c=t[o]-48;if(c<ao.length)r=ao[c],e<=3?(e=(e+5)%8,e===0?(s|=r,i[n]=s,n++,s=0):s|=255&r<<8-e):(e=(e+5)%8,s|=255&r>>>e,i[n]=s,n++,s=255&r<<8-e);else throw new Error("Invalid input - it is not base32 encoded string")}return i.slice(0,n)}});var uo=h(ts=>{var fo=co();ts.encode=fo.encode;ts.decode=fo.decode});var ho=h(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});function xd(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var lo=xd(uo()),bd=(t,e)=>lo.decode(t).toString(e),Sd=(t,e)=>lo.encode(Buffer.from(t,e).toString("ascii")).toString().replace(/=/g,"");It.keyDecoder=bd;It.keyEncoder=Sd});var qo=h(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});function Dt(t){return Object.keys(t).map(e=>t[e])}(function(t){t.SHA1="sha1",t.SHA256="sha256",t.SHA512="sha512"})(m.HashAlgorithms||(m.HashAlgorithms={}));var Mt=Dt(m.HashAlgorithms);(function(t){t.ASCII="ascii",t.BASE64="base64",t.HEX="hex",t.LATIN1="latin1",t.UTF8="utf8"})(m.KeyEncodings||(m.KeyEncodings={}));var rs=Dt(m.KeyEncodings);(function(t){t.HOTP="hotp",t.TOTP="totp"})(m.Strategy||(m.Strategy={}));var ss=Dt(m.Strategy),Bt=()=>{throw new Error("Please provide an options.createDigest implementation.")};function os(t){return/^(\d+)$/.test(t)}function as(t,e,r){return t.length>=e?t:`${Array(e+1).join(r)}${t}`.slice(-1*e)}function cs(t){let e=`otpauth://${t.type}/{labelPrefix}:{accountName}?secret={secret}{query}`,r=[];if(ss.indexOf(t.type)<0)throw new Error(`Expecting options.type to be one of ${ss.join(", ")}. Received ${t.type}.`);if(t.type==="hotp"){if(t.counter==null||typeof t.counter!="number")throw new Error('Expecting options.counter to be a number when options.type is "hotp".');r.push(`&counter=${t.counter}`)}return t.type==="totp"&&t.step&&r.push(`&period=${t.step}`),t.digits&&r.push(`&digits=${t.digits}`),t.algorithm&&r.push(`&algorithm=${t.algorithm.toUpperCase()}`),t.issuer&&r.push(`&issuer=${encodeURIComponent(t.issuer)}`),e.replace("{labelPrefix}",encodeURIComponent(t.issuer||t.accountName)).replace("{accountName}",encodeURIComponent(t.accountName)).replace("{secret}",t.secret).replace("{query}",r.join(""))}var Pt=class t{constructor(e={}){this._defaultOptions=Object.freeze({...e}),this._options=Object.freeze({})}create(e={}){return new t(e)}clone(e={}){let r=this.create({...this._defaultOptions,...e});return r.options=this._options,r}get options(){return Object.freeze({...this._defaultOptions,...this._options})}set options(e){this._options=Object.freeze({...this._options,...e})}allOptions(){return this.options}resetOptions(){this._options=Object.freeze({})}};function fs(t){if(typeof t.createDigest!="function")throw new Error("Expecting options.createDigest to be a function.");if(typeof t.createHmacKey!="function")throw new Error("Expecting options.createHmacKey to be a function.");if(typeof t.digits!="number")throw new Error("Expecting options.digits to be a number.");if(!t.algorithm||Mt.indexOf(t.algorithm)<0)throw new Error(`Expecting options.algorithm to be one of ${Mt.join(", ")}. Received ${t.algorithm}.`);if(!t.encoding||rs.indexOf(t.encoding)<0)throw new Error(`Expecting options.encoding to be one of ${rs.join(", ")}. Received ${t.encoding}.`)}var yo=(t,e,r)=>Buffer.from(e,r).toString("hex");function go(){return{algorithm:m.HashAlgorithms.SHA1,createHmacKey:yo,createDigest:Bt,digits:6,encoding:m.KeyEncodings.ASCII}}function mo(t){let e={...go(),...t};return fs(e),Object.freeze(e)}function xo(t){let e=t.toString(16);return as(e,16,"0")}function bo(t,e){let r=Buffer.from(t,"hex"),s=r[r.length-1]&15,i=((r[s]&127)<<24|(r[s+1]&255)<<16|(r[s+2]&255)<<8|r[s+3]&255)%Math.pow(10,e);return as(String(i),e,"0")}function Ed(t,e,r){let s=xo(e),n=r.createHmacKey(r.algorithm,t,r.encoding);return r.createDigest(r.algorithm,n,s)}function jt(t,e,r){let s=r.digest||Ed(t,e,r);return bo(s,r.digits)}function So(t,e,r,s){if(!os(t))return!1;let n=jt(e,r,s);return t===n}function Eo(t,e,r,s,n){return cs({algorithm:n.algorithm,digits:n.digits,type:m.Strategy.HOTP,accountName:t,counter:s,issuer:e,secret:r})}var qt=class t extends Pt{create(e={}){return new t(e)}allOptions(){return mo(this.options)}generate(e,r){return jt(e,r,this.allOptions())}check(e,r,s){return So(e,r,s,this.allOptions())}verify(e){if(typeof e!="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(e.token,e.secret,e.counter)}keyuri(e,r,s,n){return Eo(e,r,s,n,this.allOptions())}};function wo(t){if(typeof t=="number")return[Math.abs(t),Math.abs(t)];if(Array.isArray(t)){let[e,r]=t;if(typeof e=="number"&&typeof r=="number")return[Math.abs(e),Math.abs(r)]}throw new Error("Expecting options.window to be an number or [number, number].")}function us(t){if(fs(t),wo(t.window),typeof t.epoch!="number")throw new Error("Expecting options.epoch to be a number.");if(typeof t.step!="number")throw new Error("Expecting options.step to be a number.")}var Nt=(t,e,r)=>{let s=t.length,n=Buffer.from(t,e).toString("hex");if(s<r){let i=new Array(r-s+1).join(n);return Buffer.from(i,"hex").slice(0,r).toString("hex")}return n},ls=(t,e,r)=>{switch(t){case m.HashAlgorithms.SHA1:return Nt(e,r,20);case m.HashAlgorithms.SHA256:return Nt(e,r,32);case m.HashAlgorithms.SHA512:return Nt(e,r,64);default:throw new Error(`Expecting algorithm to be one of ${Mt.join(", ")}. Received ${t}.`)}};function ko(){return{algorithm:m.HashAlgorithms.SHA1,createDigest:Bt,createHmacKey:ls,digits:6,encoding:m.KeyEncodings.ASCII,epoch:Date.now(),step:30,window:0}}function vo(t){let e={...ko(),...t};return us(e),Object.freeze(e)}function Ao(t,e){return Math.floor(t/e/1e3)}function Ft(t,e){let r=Ao(e.epoch,e.step);return jt(t,r,e)}function po(t,e,r,s){let n=[];if(s===0)return n;for(let i=1;i<=s;i++){let o=e*i*r;n.push(t+o)}return n}function Co(t,e,r){let s=wo(r),n=e*1e3;return{current:t,past:po(t,-1,n,s[0]),future:po(t,1,n,s[1])}}function ds(t,e,r){if(!os(t))return!1;let s=Ft(e,r);return t===s}function ns(t,e,r,s){let n=null;return t.some((i,o)=>ds(e,r,{...s,epoch:i})?(n=o+1,!0):!1),n}function hs(t,e,r){if(ds(t,e,r))return 0;let s=Co(r.epoch,r.step,r.window),n=ns(s.past,t,e,r);return n!==null?n*-1:ns(s.future,t,e,r)}function ps(t,e){return Math.floor(t/1e3)%e}function _o(t,e){return e-ps(t,e)}function Oo(t,e,r,s){return cs({algorithm:s.algorithm,digits:s.digits,step:s.step,type:m.Strategy.TOTP,accountName:t,issuer:e,secret:r})}var Lt=class t extends qt{create(e={}){return new t(e)}allOptions(){return vo(this.options)}generate(e){return Ft(e,this.allOptions())}checkDelta(e,r){return hs(e,r,this.allOptions())}check(e,r){return typeof this.checkDelta(e,r)=="number"}verify(e){if(typeof e!="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(e.token,e.secret)}timeRemaining(){let e=this.allOptions();return _o(e.epoch,e.step)}timeUsed(){let e=this.allOptions();return ps(e.epoch,e.step)}keyuri(e,r,s){return Oo(e,r,s,this.allOptions())}};function Ro(t){if(us(t),typeof t.keyDecoder!="function")throw new Error("Expecting options.keyDecoder to be a function.");if(t.keyEncoder&&typeof t.keyEncoder!="function")throw new Error("Expecting options.keyEncoder to be a function.")}function To(){return{algorithm:m.HashAlgorithms.SHA1,createDigest:Bt,createHmacKey:ls,digits:6,encoding:m.KeyEncodings.HEX,epoch:Date.now(),step:30,window:0}}function Io(t){let e={...To(),...t};return Ro(e),Object.freeze(e)}function ys(t,e){return e.keyEncoder(t,e.encoding)}function $t(t,e){return e.keyDecoder(t,e.encoding)}function No(t,e){let r=e.createRandomBytes(t,e.encoding);return ys(r,e)}function Mo(t,e){return Ft($t(t,e),e)}function Po(t,e,r){return hs(t,$t(e,r),r)}var is=class t extends Lt{create(e={}){return new t(e)}allOptions(){return Io(this.options)}generate(e){return Mo(e,this.allOptions())}checkDelta(e,r){return Po(e,r,this.allOptions())}encode(e){return ys(e,this.allOptions())}decode(e){return $t(e,this.allOptions())}generateSecret(e=10){return No(e,this.allOptions())}};m.Authenticator=is;m.HASH_ALGORITHMS=Mt;m.HOTP=qt;m.KEY_ENCODINGS=rs;m.OTP=Pt;m.STRATEGY=ss;m.TOTP=Lt;m.authenticatorCheckWithWindow=Po;m.authenticatorDecoder=$t;m.authenticatorDefaultOptions=To;m.authenticatorEncoder=ys;m.authenticatorGenerateSecret=No;m.authenticatorOptionValidator=Ro;m.authenticatorOptions=Io;m.authenticatorToken=Mo;m.createDigestPlaceholder=Bt;m.hotpCheck=So;m.hotpCounter=xo;m.hotpCreateHmacKey=yo;m.hotpDefaultOptions=go;m.hotpDigestToToken=bo;m.hotpKeyuri=Eo;m.hotpOptions=mo;m.hotpOptionsValidator=fs;m.hotpToken=jt;m.isTokenValid=os;m.keyuri=cs;m.objectValues=Dt;m.padStart=as;m.totpCheck=ds;m.totpCheckByEpoch=ns;m.totpCheckWithWindow=hs;m.totpCounter=Ao;m.totpCreateHmacKey=ls;m.totpDefaultOptions=ko;m.totpEpochAvailable=Co;m.totpKeyuri=Oo;m.totpOptions=vo;m.totpOptionsValidator=us;m.totpPadSecret=Nt;m.totpTimeRemaining=_o;m.totpTimeUsed=ps;m.totpToken=Ft});var Do=h(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});var Ut=oo(),Lo=ho(),gs=qo(),wd=new gs.HOTP({createDigest:Ut.createDigest}),kd=new gs.TOTP({createDigest:Ut.createDigest}),vd=new gs.Authenticator({createDigest:Ut.createDigest,createRandomBytes:Ut.createRandomBytes,keyDecoder:Lo.keyDecoder,keyEncoder:Lo.keyEncoder});tt.authenticator=vd;tt.hotp=wd;tt.totp=kd});var jo=h(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});var Bo=Do();Object.keys(Bo).forEach(function(t){t!=="default"&&Object.defineProperty(ms,t,{enumerable:!0,get:function(){return Bo[t]}})})});var Ho=h((ew,Ad)=>{Ad.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hpexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdelex:{arity:-5,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var Me=h($=>{"use strict";var Cd=$&&$.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($,"__esModule",{value:!0});$.getKeyIndexes=$.hasFlag=$.exists=$.list=void 0;var Gt=Cd(Ho());$.list=Object.keys(Gt.default);var xs={};$.list.forEach(t=>{xs[t]=Gt.default[t].flags.reduce(function(e,r){return e[r]=!0,e},{})});function _d(t){return!!Gt.default[t]}$.exists=_d;function Od(t,e){if(!xs[t])throw new Error("Unknown command "+t);return!!xs[t][e]}$.hasFlag=Od;function Rd(t,e,r){let s=Gt.default[t];if(!s)throw new Error("Unknown command "+t);if(!Array.isArray(e))throw new Error("Expect args to be an array");let n=[],i=!!(r&&r.parseExternalKey),o=(a,f)=>{let l=[],u=Number(a[f]);for(let p=0;p<u;p++)l.push(p+f+1);return l},c=(a,f,l)=>{for(let u=f;u<a.length-1;u+=1)if(String(a[u]).toLowerCase()===l.toLowerCase())return u+1;return null};switch(t){case"zunionstore":case"zinterstore":case"zdiffstore":n.push(0,...o(e,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":n.push(...o(e,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{n.push(...o(e,0));break}case"georadius":{n.push(0);let a=c(e,5,"STORE");a&&n.push(a);let f=c(e,5,"STOREDIST");f&&n.push(f);break}case"georadiusbymember":{n.push(0);let a=c(e,4,"STORE");a&&n.push(a);let f=c(e,4,"STOREDIST");f&&n.push(f);break}case"sort":case"sort_ro":n.push(0);for(let a=1;a<e.length-1;a++){let f=e[a];if(typeof f!="string")continue;let l=f.toUpperCase();l==="GET"?(a+=1,f=e[a],f!=="#"&&(i?n.push([a,Qo(f)]):n.push(a))):l==="BY"?(a+=1,i?n.push([a,Qo(e[a])]):n.push(a)):l==="STORE"&&(a+=1,n.push(a))}break;case"migrate":if(e[2]==="")for(let a=5;a<e.length-1;a++){let f=e[a];if(typeof f=="string"&&f.toUpperCase()==="KEYS"){for(let l=a+1;l<e.length;l++)n.push(l);break}}else n.push(2);break;case"xreadgroup":case"xread":for(let a=t==="xread"?0:3;a<e.length-1;a++)if(String(e[a]).toUpperCase()==="STREAMS"){for(let f=a+1;f<=a+(e.length-1-a)/2;f++)n.push(f);break}break;default:if(s.step>0){let a=s.keyStart-1,f=s.keyStop>0?s.keyStop:e.length+s.keyStop+1;for(let l=a;l<f;l+=s.step)n.push(l)}break}return n}$.getKeyIndexes=Rd;function Qo(t){typeof t!="string"&&(t=String(t));let e=t.indexOf("->");return e===-1?t.length:e}});var Vo=h(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.tryCatch=fe.errorObj=void 0;fe.errorObj={e:{}};var bs;function Td(t,e){try{let r=bs;return bs=null,r.apply(this,arguments)}catch(r){return fe.errorObj.e=r,fe.errorObj}}function Id(t){return bs=t,Td}fe.tryCatch=Id});var ue=h(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});var Pe=Vo();function zo(t){setTimeout(function(){throw t},0)}function Nd(t,e,r){return typeof e=="function"&&t.then(s=>{let n;r!==void 0&&Object(r).spread&&Array.isArray(s)?n=Pe.tryCatch(e).apply(void 0,[null].concat(s)):n=s===void 0?Pe.tryCatch(e)(null):Pe.tryCatch(e)(null,s),n===Pe.errorObj&&zo(n.e)},s=>{if(!s){let i=new Error(s+"");Object.assign(i,{cause:s}),s=i}let n=Pe.tryCatch(e)(s);n===Pe.errorObj&&zo(n.e)}),t}Ss.default=Nd});var Wo=h((nw,Yo)=>{"use strict";var Ko=require("assert"),rt=require("util");function qe(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(qe,Error);Object.defineProperty(qe.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function Es(t,e,r){Ko(e),Ko.strictEqual(typeof r,"number"),Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let s=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=s,this.offset=r,this.buffer=e}rt.inherits(Es,qe);Object.defineProperty(Es.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function ws(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let e=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=e}rt.inherits(ws,qe);Object.defineProperty(ws.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function Ht(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(Ht,qe);Object.defineProperty(Ht.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function ks(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(ks,Ht);Object.defineProperty(ks.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});Yo.exports={RedisError:qe,ParserError:Es,ReplyError:ws,AbortError:Ht,InterruptError:ks}});var Zo=h((iw,Jo)=>{"use strict";var Xo=require("assert"),Le=class extends Error{get name(){return this.constructor.name}},vs=class extends Le{constructor(e,r,s){Xo(r),Xo.strictEqual(typeof s,"number");let n=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=n,this.offset=s,this.buffer=r}get name(){return this.constructor.name}},As=class extends Le{constructor(e){let r=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=r}get name(){return this.constructor.name}},Qt=class extends Le{get name(){return this.constructor.name}},Cs=class extends Qt{get name(){return this.constructor.name}};Jo.exports={RedisError:Le,ParserError:vs,ReplyError:As,AbortError:Qt,InterruptError:Cs}});var ve=h((ow,ea)=>{"use strict";var Md=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?Wo():Zo();ea.exports=Md});var st=h((aw,_s)=>{var ta=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],Pd=function(e){for(var r,s=0,n=0,i=[],o=e.length;s<o;s++)r=e.charCodeAt(s),r<128?i[n++]=r:r<2048?(i[n++]=r>>6|192,i[n++]=r&63|128):(r&64512)===55296&&s+1<e.length&&(e.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++s)&1023),i[n++]=r>>18|240,i[n++]=r>>12&63|128,i[n++]=r>>6&63|128,i[n++]=r&63|128):(i[n++]=r>>12|224,i[n++]=r>>6&63|128,i[n++]=r&63|128);return i},ra=_s.exports=function(e){for(var r,s=0,n=-1,i=0,o=0,c=typeof e=="string"?Pd(e):e,a=c.length;s<a;){if(r=c[s++],n===-1)r===123&&(n=s);else if(r!==125)o=ta[(r^o>>8)&255]^o<<8;else if(s-1!==n)return o&16383;i=ta[(r^i>>8)&255]^i<<8}return i&16383};_s.exports.generateMulti=function(e){for(var r=1,s=e.length,n=ra(e[0]);r<s;)if(ra(e[r++])!==n)return-1;return n}});var ua=h((cw,fa)=>{var na=9007199254740991,qd="[object Arguments]",Ld="[object Function]",Dd="[object GeneratorFunction]",Bd=/^(?:0|[1-9]\d*)$/;function ia(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function jd(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}var nt=Object.prototype,it=nt.hasOwnProperty,oa=nt.toString,Fd=nt.propertyIsEnumerable,sa=Math.max;function $d(t,e){var r=Xd(t)||Wd(t)?jd(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||it.call(t,i))&&!(n&&(i=="length"||ca(i,s)))&&r.push(i);return r}function Ud(t,e,r,s){return t===void 0||Os(t,nt[r])&&!it.call(s,r)?e:t}function Gd(t,e,r){var s=t[e];(!(it.call(t,e)&&Os(s,r))||r===void 0&&!(e in t))&&(t[e]=r)}function Hd(t){if(!Ts(t))return Yd(t);var e=Kd(t),r=[];for(var s in t)s=="constructor"&&(e||!it.call(t,s))||r.push(s);return r}function aa(t,e){return e=sa(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,n=sa(r.length-e,0),i=Array(n);++s<n;)i[s]=r[e+s];s=-1;for(var o=Array(e+1);++s<e;)o[s]=r[s];return o[e]=i,ia(t,this,o)}}function Qd(t,e,r,s){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n],c=s?s(r[o],t[o],o,r,t):void 0;Gd(r,o,c===void 0?t[o]:c)}return r}function Vd(t){return aa(function(e,r){var s=-1,n=r.length,i=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(i=t.length>3&&typeof i=="function"?(n--,i):void 0,o&&zd(r[0],r[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++s<n;){var c=r[s];c&&t(e,c,s,i)}return e})}function ca(t,e){return e=e??na,!!e&&(typeof t=="number"||Bd.test(t))&&t>-1&&t%1==0&&t<e}function zd(t,e,r){if(!Ts(r))return!1;var s=typeof e;return(s=="number"?Rs(r)&&ca(e,r.length):s=="string"&&e in r)?Os(r[e],t):!1}function Kd(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||nt;return t===r}function Yd(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}function Os(t,e){return t===e||t!==t&&e!==e}function Wd(t){return Jd(t)&&it.call(t,"callee")&&(!Fd.call(t,"callee")||oa.call(t)==qd)}var Xd=Array.isArray;function Rs(t){return t!=null&&eh(t.length)&&!Zd(t)}function Jd(t){return th(t)&&Rs(t)}function Zd(t){var e=Ts(t)?oa.call(t):"";return e==Ld||e==Dd}function eh(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=na}function Ts(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function th(t){return!!t&&typeof t=="object"}var rh=Vd(function(t,e,r,s){Qd(e,nh(e),t,s)}),sh=aa(function(t){return t.push(void 0,Ud),ia(rh,void 0,t)});function nh(t){return Rs(t)?$d(t,!0):Hd(t)}fa.exports=sh});var ha=h((fw,da)=>{var ih=9007199254740991,oh="[object Arguments]",ah="[object Function]",ch="[object GeneratorFunction]",Is=Object.prototype,fh=Is.hasOwnProperty,la=Is.toString,uh=Is.propertyIsEnumerable;function lh(t){return hh(t)&&fh.call(t,"callee")&&(!uh.call(t,"callee")||la.call(t)==oh)}function dh(t){return t!=null&&yh(t.length)&&!ph(t)}function hh(t){return mh(t)&&dh(t)}function ph(t){var e=gh(t)?la.call(t):"";return e==ah||e==ch}function yh(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ih}function gh(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function mh(t){return!!t&&typeof t=="object"}da.exports=lh});var Vt=h(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.isArguments=le.defaults=le.noop=void 0;var xh=ua();le.defaults=xh;var bh=ha();le.isArguments=bh;function Sh(){}le.noop=Sh});var Ns=h((lw,pa)=>{var De=1e3,Be=De*60,je=Be*60,Ae=je*24,Eh=Ae*7,wh=Ae*365.25;pa.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return kh(t);if(r==="number"&&isFinite(t))return e.long?Ah(t):vh(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function kh(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*wh;case"weeks":case"week":case"w":return r*Eh;case"days":case"day":case"d":return r*Ae;case"hours":case"hour":case"hrs":case"hr":case"h":return r*je;case"minutes":case"minute":case"mins":case"min":case"m":return r*Be;case"seconds":case"second":case"secs":case"sec":case"s":return r*De;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function vh(t){var e=Math.abs(t);return e>=Ae?Math.round(t/Ae)+"d":e>=je?Math.round(t/je)+"h":e>=Be?Math.round(t/Be)+"m":e>=De?Math.round(t/De)+"s":t+"ms"}function Ah(t){var e=Math.abs(t);return e>=Ae?zt(t,e,Ae,"day"):e>=je?zt(t,e,je,"hour"):e>=Be?zt(t,e,Be,"minute"):e>=De?zt(t,e,De,"second"):t+" ms"}function zt(t,e,r,s){var n=e>=r*1.5;return Math.round(t/r)+" "+s+(n?"s":"")}});var Ms=h((dw,ya)=>{function Ch(t){r.debug=r,r.default=r,r.coerce=a,r.disable=o,r.enable=n,r.enabled=c,r.humanize=Ns(),r.destroy=f,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let u=0;for(let p=0;p<l.length;p++)u=(u<<5)-u+l.charCodeAt(p),u|=0;return r.colors[Math.abs(u)%r.colors.length]}r.selectColor=e;function r(l){let u,p=null,d,x;function b(...I){if(!b.enabled)return;let ae=b,we=Number(new Date),Je=we-(u||we);ae.diff=Je,ae.prev=u,ae.curr=we,u=we,I[0]=r.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let _t=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(Qr,_0)=>{if(Qr==="%%")return"%";_t++;let Di=r.formatters[_0];if(typeof Di=="function"){let O0=I[_t];Qr=Di.call(ae,O0),I.splice(_t,1),_t--}return Qr}),r.formatArgs.call(ae,I),(ae.log||r.log).apply(ae,I)}return b.namespace=l,b.useColors=r.useColors(),b.color=r.selectColor(l),b.extend=s,b.destroy=r.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(d!==r.namespaces&&(d=r.namespaces,x=r.enabled(l)),x),set:I=>{p=I}}),typeof r.init=="function"&&r.init(b),b}function s(l,u){let p=r(this.namespace+(typeof u>"u"?":":u)+l);return p.log=this.log,p}function n(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let u=(typeof l=="string"?l:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let p of u)p[0]==="-"?r.skips.push(p.slice(1)):r.names.push(p)}function i(l,u){let p=0,d=0,x=-1,b=0;for(;p<l.length;)if(d<u.length&&(u[d]===l[p]||u[d]==="*"))u[d]==="*"?(x=d,b=p,d++):(p++,d++);else if(x!==-1)d=x+1,b++,p=b;else return!1;for(;d<u.length&&u[d]==="*";)d++;return d===u.length}function o(){let l=[...r.names,...r.skips.map(u=>"-"+u)].join(",");return r.enable(""),l}function c(l){for(let u of r.skips)if(i(l,u))return!1;for(let u of r.names)if(i(l,u))return!0;return!1}function a(l){return l instanceof Error?l.stack||l.message:l}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ya.exports=Ch});var ga=h((F,Kt)=>{F.formatArgs=Oh;F.save=Rh;F.load=Th;F.useColors=_h;F.storage=Ih();F.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _h(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Oh(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Kt.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(s=r))}),t.splice(s,0,e)}F.log=console.debug||console.log||(()=>{});function Rh(t){try{t?F.storage.setItem("debug",t):F.storage.removeItem("debug")}catch{}}function Th(){let t;try{t=F.storage.getItem("debug")||F.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Ih(){try{return localStorage}catch{}}Kt.exports=Ms()(F);var{formatters:Nh}=Kt.exports;Nh.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var xa=h((hw,ma)=>{"use strict";ma.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",s=e.indexOf(r+t),n=e.indexOf("--");return s!==-1&&(n===-1||s<n)}});var Ea=h((pw,Sa)=>{"use strict";var Mh=require("os"),ba=require("tty"),G=xa(),{env:R}=process,Yt;G("no-color")||G("no-colors")||G("color=false")||G("color=never")?Yt=0:(G("color")||G("colors")||G("color=true")||G("color=always"))&&(Yt=1);function Ph(){if("FORCE_COLOR"in R)return R.FORCE_COLOR==="true"?1:R.FORCE_COLOR==="false"?0:R.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(R.FORCE_COLOR,10),3)}function qh(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Lh(t,{streamIsTTY:e,sniffFlags:r=!0}={}){let s=Ph();s!==void 0&&(Yt=s);let n=r?Yt:s;if(n===0)return 0;if(r){if(G("color=16m")||G("color=full")||G("color=truecolor"))return 3;if(G("color=256"))return 2}if(t&&!e&&n===void 0)return 0;let i=n||0;if(R.TERM==="dumb")return i;if(process.platform==="win32"){let o=Mh.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in R)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(o=>o in R)||R.CI_NAME==="codeship"?1:i;if("TEAMCITY_VERSION"in R)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(R.TEAMCITY_VERSION)?1:0;if(R.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in R){let o=Number.parseInt((R.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(R.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(R.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(R.TERM)||"COLORTERM"in R?1:i}function Ps(t,e={}){let r=Lh(t,{streamIsTTY:t&&t.isTTY,...e});return qh(r)}Sa.exports={supportsColor:Ps,stdout:Ps({isTTY:ba.isatty(1)}),stderr:Ps({isTTY:ba.isatty(2)})}});var ka=h((T,Xt)=>{var Dh=require("tty"),Wt=require("util");T.init=Hh;T.log=$h;T.formatArgs=jh;T.save=Uh;T.load=Gh;T.useColors=Bh;T.destroy=Wt.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");T.colors=[6,2,3,4,5,1];try{let t=Ea();t&&(t.stderr||t).level>=2&&(T.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}T.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[e];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),t[r]=s,t},{});function Bh(){return"colors"in T.inspectOpts?!!T.inspectOpts.colors:Dh.isatty(process.stderr.fd)}function jh(t){let{namespace:e,useColors:r}=this;if(r){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${e} \x1B[0m`;t[0]=i+t[0].split(`
`).join(`
`+i),t.push(n+"m+"+Xt.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Fh()+e+" "+t[0]}function Fh(){return T.inspectOpts.hideDate?"":new Date().toISOString()+" "}function $h(...t){return process.stderr.write(Wt.formatWithOptions(T.inspectOpts,...t)+`
`)}function Uh(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function Gh(){return process.env.DEBUG}function Hh(t){t.inspectOpts={};let e=Object.keys(T.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=T.inspectOpts[e[r]]}Xt.exports=Ms()(T);var{formatters:wa}=Xt.exports;wa.o=function(t){return this.inspectOpts.colors=this.useColors,Wt.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};wa.O=function(t){return this.inspectOpts.colors=this.useColors,Wt.inspect(t,this.inspectOpts)}});var va=h((yw,qs)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?qs.exports=ga():qs.exports=ka()});var _a=h(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.genRedactedString=ne.getStringValue=ne.MAX_ARGUMENT_LENGTH=void 0;var Qh=va(),Ls=200;ne.MAX_ARGUMENT_LENGTH=Ls;var Vh="ioredis";function Aa(t){if(t!==null)switch(typeof t){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(t))return t.toString("hex");if(Array.isArray(t))return t.join(",");try{return JSON.stringify(t)}catch{return}case"string":return t}}ne.getStringValue=Aa;function Ca(t,e){let{length:r}=t;return r<=e?t:t.slice(0,e)+' ... <REDACTED full-length="'+r+'">'}ne.genRedactedString=Ca;function zh(t){let e=(0,Qh.default)(`${Vh}:${t}`);function r(...s){if(e.enabled){for(let n=1;n<s.length;n++){let i=Aa(s[n]);typeof i=="string"&&i.length>Ls&&(s[n]=Ca(i,Ls))}return e.apply(null,s)}}return Object.defineProperties(r,{namespace:{get(){return e.namespace}},enabled:{get(){return e.enabled}},destroy:{get(){return e.destroy}},log:{get(){return e.log},set(s){e.log=s}}}),r}ne.default=zh});var Ra=h(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});var Oa=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,Kh={RedisCloudFixed:{ca:Oa},RedisCloudFlexible:{ca:Oa}};Ds.default=Kh});var N=h(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.noop=w.defaults=w.Debug=w.getPackageMeta=w.zipMap=w.CONNECTION_CLOSED_ERROR_MSG=w.shuffle=w.sample=w.resolveTLSProfile=w.parseURL=w.optimizeErrorStack=w.toArg=w.convertMapToArray=w.convertObjectToArray=w.timeout=w.packObject=w.isInt=w.wrapMultiResult=w.convertBufferToString=void 0;var Yh=require("fs"),Wh=require("path"),Ta=require("url"),Bs=Vt();Object.defineProperty(w,"defaults",{enumerable:!0,get:function(){return Bs.defaults}});Object.defineProperty(w,"noop",{enumerable:!0,get:function(){return Bs.noop}});var Xh=_a();w.Debug=Xh.default;var Jh=Ra();function Ia(t,e){if(t instanceof Buffer)return t.toString(e);if(Array.isArray(t)){let r=t.length,s=Array(r);for(let n=0;n<r;++n)s[n]=t[n]instanceof Buffer&&e==="utf8"?t[n].toString():Ia(t[n],e);return s}return t}w.convertBufferToString=Ia;function Zh(t){if(!t)return null;let e=[],r=t.length;for(let s=0;s<r;++s){let n=t[s];n instanceof Error?e.push([n]):e.push([null,n])}return e}w.wrapMultiResult=Zh;function Na(t){let e=parseFloat(t);return!isNaN(t)&&(e|0)===e}w.isInt=Na;function ep(t){let e={},r=t.length;for(let s=1;s<r;s+=2)e[t[s-1]]=t[s];return e}w.packObject=ep;function tp(t,e){let r=null,s=function(){r&&(clearTimeout(r),r=null,t.apply(this,arguments))};return r=setTimeout(s,e,new Error("timeout")),s}w.timeout=tp;function rp(t){let e=[],r=Object.keys(t);for(let s=0,n=r.length;s<n;s++)e.push(r[s],t[r[s]]);return e}w.convertObjectToArray=rp;function sp(t){let e=[],r=0;return t.forEach(function(s,n){e[r]=n,e[r+1]=s,r+=2}),e}w.convertMapToArray=sp;function np(t){return t===null||typeof t>"u"?"":String(t)}w.toArg=np;function ip(t,e,r){let s=e.split(`
`),n="",i;for(i=1;i<s.length&&s[i].indexOf(r)!==-1;++i);for(let o=i;o<s.length;++o)n+=`
`+s[o];if(t.stack){let o=t.stack.indexOf(`
`);t.stack=t.stack.slice(0,o)+n}return t}w.optimizeErrorStack=ip;function op(t){if(Na(t))return{port:t};let e=(0,Ta.parse)(t,!0,!0);!e.slashes&&t[0]!=="/"&&(t="//"+t,e=(0,Ta.parse)(t,!0,!0));let r=e.query||{},s={};if(e.auth){let n=e.auth.indexOf(":");s.username=n===-1?e.auth:e.auth.slice(0,n),s.password=n===-1?"":e.auth.slice(n+1)}if(e.pathname&&(e.protocol==="redis:"||e.protocol==="rediss:"?e.pathname.length>1&&(s.db=e.pathname.slice(1)):s.path=e.pathname),e.host&&(s.host=e.hostname),e.port&&(s.port=e.port),typeof r.family=="string"){let n=Number.parseInt(r.family,10);Number.isNaN(n)||(s.family=n)}return(0,Bs.defaults)(s,r),s}w.parseURL=op;function ap(t){let e=t?.tls;typeof e=="string"&&(e={profile:e});let r=Jh.default[e?.profile];return r&&(e=Object.assign({},r,e),delete e.profile,t=Object.assign({},t,{tls:e})),t}w.resolveTLSProfile=ap;function cp(t,e=0){let r=t.length;return e>=r?null:t[e+Math.floor(Math.random()*(r-e))]}w.sample=cp;function fp(t){let e=t.length;for(;e>0;){let r=Math.floor(Math.random()*e);e--,[t[e],t[r]]=[t[r],t[e]]}return t}w.shuffle=fp;w.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function up(t,e){let r=new Map;return t.forEach((s,n)=>{r.set(s,e[n])}),r}w.zipMap=up;var Fe=null;async function lp(){if(Fe)return Fe;try{let t=(0,Wh.resolve)(__dirname,"..","..","package.json"),e=await Yh.promises.readFile(t,"utf8");return Fe={version:JSON.parse(e).version},Fe}catch{return Fe={version:"error-fetching-version"},Fe}}w.getPackageMeta=lp});var ie=h(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});var Ma=Me(),dp=st(),hp=ue(),Ce=N(),J=class t{constructor(e,r=[],s={},n){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=s.replyEncoding,this.errorStack=s.errorStack,this.args=r.flat(),this.callback=n,this.initPromise(),s.keyPrefix){let i=s.keyPrefix instanceof Buffer,o=i?s.keyPrefix:null;this._iterateKeys(c=>c instanceof Buffer?(o===null&&(o=Buffer.from(s.keyPrefix)),Buffer.concat([o,c])):i?Buffer.concat([s.keyPrefix,Buffer.from(String(c))]):s.keyPrefix+c)}s.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,r){return!!this.getFlagMap()[e][r]}static setArgumentTransformer(e,r){this._transformer.argument[e]=r}static setReplyTransformer(e,r){this._transformer.reply[e]=r}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(t.FLAGS).reduce((e,r)=>(e[r]={},t.FLAGS[r].forEach(s=>{e[r][s]=!0}),e),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){let e=this.getKeys()[0];this.slot=e==null?null:dp(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let r,s="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let n=new js;n.push(s);for(let i=0;i<this.args.length;++i){let o=this.args[i];o instanceof Buffer?o.length===0?n.push(`$0\r
\r
`):(n.push("$"+o.length+`\r
`),n.push(o),n.push(`\r
`)):n.push("$"+Buffer.byteLength(o)+`\r
`+o+`\r
`)}r=n.toBuffer()}else{r=s;for(let n=0;n<this.args.length;++n){let i=this.args[n];r+="$"+Buffer.byteLength(i)+`\r
`+i+`\r
`}}return r}stringifyArguments(){for(let e=0;e<this.args.length;++e){let r=this.args[e];typeof r=="string"||(r instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,Ce.toArg)(r))}}transformReply(e){this.replyEncoding&&(e=(0,Ce.convertBufferToString)(e,this.replyEncoding));let r=t._transformer.reply[this.name];return r&&(e=r(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},e))}initPromise(){let e=new Promise((r,s)=>{if(!this.transformed){this.transformed=!0;let n=t._transformer.argument[this.name];n&&(this.args=n(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(r),this.errorStack?this.reject=n=>{s((0,Ce.optimizeErrorStack)(n,this.errorStack.stack,__dirname))}:this.reject=s});this.promise=(0,hp.default)(e,this.callback)}_iterateKeys(e=r=>r){if(typeof this.keys>"u"&&(this.keys=[],(0,Ma.exists)(this.name))){let r=(0,Ma.getKeyIndexes)(this.name,this.args);for(let s of r)this.args[s]=e(this.args[s]),this.keys.push(this.args[s])}return this.keys}_convertValue(e){return r=>{try{let s=this._commandTimeoutTimer;s&&(clearTimeout(s),delete this._commandTimeoutTimer),e(this.transformReply(r)),this.isResolved=!0}catch(s){this.reject(s)}return this.promise}}};Fs.default=J;J.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"],HANDSHAKE_COMMANDS:["auth","select","client","readonly","info"],IGNORE_RECONNECT_ON_ERROR:["client"]};J._transformer={argument:{},reply:{}};var Pa=function(t){if(t.length===1){if(t[0]instanceof Map)return(0,Ce.convertMapToArray)(t[0]);if(typeof t[0]=="object"&&t[0]!==null)return(0,Ce.convertObjectToArray)(t[0])}return t},qa=function(t){if(t.length===2){if(t[1]instanceof Map)return[t[0]].concat((0,Ce.convertMapToArray)(t[1]));if(typeof t[1]=="object"&&t[1]!==null)return[t[0]].concat((0,Ce.convertObjectToArray)(t[1]))}return t};J.setArgumentTransformer("mset",Pa);J.setArgumentTransformer("msetnx",Pa);J.setArgumentTransformer("hset",qa);J.setArgumentTransformer("hmset",qa);J.setReplyTransformer("hgetall",function(t){if(Array.isArray(t)){let e={};for(let r=0;r<t.length;r+=2){let s=t[r],n=t[r+1];s in e?Object.defineProperty(e,s,{value:n,configurable:!0,enumerable:!0,writable:!0}):e[s]=n}return e}return t});var js=class{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){let e=Buffer.allocUnsafe(this.length),r=0;for(let s of this.items){let n=Buffer.byteLength(s);Buffer.isBuffer(s)?s.copy(e,r):e.write(s,r,n),r+=n}return e}}});var La=h($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});var pp=ve(),Jt=class extends pp.RedisError{constructor(e,r){super(e),this.lastNodeError=r,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};$s.default=Jt;Jt.defaultMessage="Failed to refresh slots cache."});var Zt=h(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});var yp=require("stream"),Us=class extends yp.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.noValues&&e.push("NOVALUES"),this.opt.redis[this.opt.command](e,(r,s)=>{if(r){this.emit("error",r);return}this._redisCursor=s[0]instanceof Buffer?s[0].toString():s[0],this._redisCursor==="0"&&(this._redisDrained=!0),this.push(s[1])})}close(){this._redisDrained=!0}};Gs.default=Us});var Ua=h(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.executeWithAutoPipelining=O.getFirstValueInFlattenedArray=O.shouldUseAutoPipelining=O.notAllowedAutoPipelineCommands=O.kCallbacks=O.kExec=void 0;var Ba=Vt(),gp=st(),Da=ue();O.kExec=Symbol("exec");O.kCallbacks=Symbol("callbacks");O.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select","client"];function ja(t,e){if(t._runningAutoPipelines.has(e)||!t._autoPipelines.has(e))return;t._runningAutoPipelines.add(e);let r=t._autoPipelines.get(e);t._autoPipelines.delete(e);let s=r[O.kCallbacks];r[O.kCallbacks]=null,r.exec(function(n,i){if(t._runningAutoPipelines.delete(e),n)for(let o=0;o<s.length;o++)process.nextTick(s[o],n);else for(let o=0;o<s.length;o++)process.nextTick(s[o],...i[o]);t._autoPipelines.has(e)&&ja(t,e)})}function mp(t,e,r){return e&&t.options.enableAutoPipelining&&!t.isPipeline&&!O.notAllowedAutoPipelineCommands.includes(r)&&!t.options.autoPipeliningIgnoredCommands.includes(r)}O.shouldUseAutoPipelining=mp;function Fa(t){for(let e=0;e<t.length;e++){let r=t[e];if(typeof r=="string")return r;if(Array.isArray(r)||(0,Ba.isArguments)(r)){if(r.length===0)continue;return r[0]}let s=[r].flat();if(s.length>0)return s[0]}}O.getFirstValueInFlattenedArray=Fa;function $a(t,e,r,s,n){if(t.isCluster&&!t.slots.length)return t.status==="wait"&&t.connect().catch(Ba.noop),(0,Da.default)(new Promise(function(f,l){t.delayUntilReady(u=>{if(u){l(u);return}$a(t,e,r,s,null).then(f,l)})}),n);let i=t.options.keyPrefix||"",o=t.isCluster?t.slots[gp(`${i}${Fa(s)}`)].join(","):"main";if(!t._autoPipelines.has(o)){let f=t.pipeline();f[O.kExec]=!1,f[O.kCallbacks]=[],t._autoPipelines.set(o,f)}let c=t._autoPipelines.get(o);c[O.kExec]||(c[O.kExec]=!0,setImmediate(ja,t,o));let a=new Promise(function(f,l){c[O.kCallbacks].push(function(u,p){if(u){l(u);return}f(p)}),e==="call"&&s.unshift(r),c[e](...s)});return(0,Da.default)(a,n)}O.executeWithAutoPipelining=$a});var Ga=h(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});var xp=require("crypto"),bp=ie(),Sp=ue(),Hs=class{constructor(e,r=null,s="",n=!1){this.lua=e,this.numberOfKeys=r,this.keyPrefix=s,this.readOnly=n,this.sha=(0,xp.createHash)("sha1").update(e).digest("hex");let i=this.sha,o=new WeakSet;this.Command=class extends bp.default{toWritable(a){let f=this.reject;return this.reject=l=>{l.message.indexOf("NOSCRIPT")!==-1&&o.delete(a),f.call(this,l)},o.has(a)?this.name==="eval"&&(this.name="evalsha",this.args[0]=i):(o.add(a),this.name="eval",this.args[0]=e),super.toWritable(a)}}}execute(e,r,s,n){typeof this.numberOfKeys=="number"&&r.unshift(this.numberOfKeys),this.keyPrefix&&(s.keyPrefix=this.keyPrefix),this.readOnly&&(s.readOnly=!0);let i=new this.Command("evalsha",[this.sha,...r],s);return i.promise=i.promise.catch(o=>{if(o.message.indexOf("NOSCRIPT")===-1)throw o;let c=new this.Command("evalsha",[this.sha,...r],s);return(e.isPipeline?e.redis:e).sendCommand(c)}),(0,Sp.default)(i.promise,n),e.sendCommand(i)}};Qs.default=Hs});var tr=h(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});var Ep=Me(),er=Ua(),wp=ie(),kp=Ga(),oe=class{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return Vs.slice(0)}createBuiltinCommand(e){return{string:de(null,e,"utf8"),buffer:de(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=de(e,e,"utf8"),this[e+"Buffer"]=de(e+"Buffer",e,null)}defineCommand(e,r){let s=new kp.default(r.lua,r.numberOfKeys,this.options.keyPrefix,r.readOnly);this.scriptsSet[e]=s,this[e]=Ha(e,e,s,"utf8"),this[e+"Buffer"]=Ha(e+"Buffer",e,s,null)}sendCommand(e,r,s){throw new Error('"sendCommand" is not implemented')}},Vs=Ep.list.filter(t=>t!=="monitor");Vs.push("sentinel");Vs.forEach(function(t){oe.prototype[t]=de(t,t,"utf8"),oe.prototype[t+"Buffer"]=de(t+"Buffer",t,null)});oe.prototype.call=de("call","utf8");oe.prototype.callBuffer=de("callBuffer",null);oe.prototype.send_command=oe.prototype.call;function de(t,e,r){return typeof r>"u"&&(r=e,e=null),function(...s){let n=e||s.shift(),i=s[s.length-1];typeof i=="function"?s.pop():i=void 0;let o={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,er.shouldUseAutoPipelining)(this,t,n)?(0,er.executeWithAutoPipelining)(this,t,n,s,i):this.sendCommand(new wp.default(n,s,o,i))}}function Ha(t,e,r,s){return function(...n){let i=typeof n[n.length-1]=="function"?n.pop():void 0,o={replyEncoding:s};return this.options.showFriendlyErrorStack&&(o.errorStack=new Error),(0,er.shouldUseAutoPipelining)(this,t,e)?(0,er.executeWithAutoPipelining)(this,t,e,n,i):r.execute(this,n,o,i)}}zs.default=oe});var Ws=h(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});var Ks=st(),Qa=Me(),Va=ue(),vp=require("util"),Ap=ie(),Cp=N(),_p=tr();function Op(t,e){let r=Ks(e[0]),s=t._groupsBySlot[r];for(let n=1;n<e.length;n++)if(t._groupsBySlot[Ks(e[n])]!==s)return-1;return r}var he=class extends _p.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(s=>{let n=e.scriptsSet[s];this._shaToScript[n.sha]=n,this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),e.addedBuiltinSet.forEach(s=>{this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),this.promise=new Promise((s,n)=>{this.resolve=s,this.reject=n});let r=this;Object.defineProperty(this,"length",{get:function(){return r._queue.length}})}fillResult(e,r){if(this._queue[r].name==="exec"&&Array.isArray(e[1])){let n=e[1].length;for(let i=0;i<n;i++){if(e[1][i]instanceof Error)continue;let o=this._queue[r-(n-i)];try{e[1][i]=o.transformReply(e[1][i])}catch(c){e[1][i]=c}}}if(this._result[r]=e,--this.replyPending)return;if(this.isCluster){let n=!0,i;for(let o=0;o<this._result.length;++o){let c=this._result[o][0],a=this._queue[o];if(c){if(a.name==="exec"&&c.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!i)i={name:c.name,message:c.message};else if(i.name!==c.name||i.message!==c.message){n=!1;break}}else if(!a.inTransaction&&!((0,Qa.exists)(a.name)&&(0,Qa.hasFlag)(a.name,"readonly"))){n=!1;break}}if(i&&n){let o=this,c=i.message.split(" "),a=this._queue,f=!1;this._queue=[];for(let d=0;d<a.length;++d){if(c[0]==="ASK"&&!f&&a[d].name!=="asking"&&(!a[d-1]||a[d-1].name!=="asking")){let x=new Ap.default("asking");x.ignore=!0,this.sendCommand(x)}a[d].initPromise(),this.sendCommand(a[d]),f=a[d].inTransaction}let l=!0;typeof this.leftRedirections>"u"&&(this.leftRedirections={});let u=function(){o.exec()},p=this.redis;if(p.handleError(i,this.leftRedirections,{moved:function(d,x){o.preferKey=x,p.slots[c[1]]=[x],p._groupsBySlot[c[1]]=p._groupsIds[p.slots[c[1]].join(";")],p.refreshSlotsCache(),o.exec()},ask:function(d,x){o.preferKey=x,o.exec()},tryagain:u,clusterDown:u,connectionClosed:u,maxRedirections:()=>{l=!1},defaults:()=>{l=!1}}),l)return}}let s=0;for(let n=0;n<this._queue.length-s;++n)this._queue[n+s].ignore&&(s+=1),this._result[n]=this._result[n+s];this.resolve(this._result.slice(0,this._result.length-s))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);let r=this._queue.length;return e.pipelineIndex=r,e.promise.then(s=>{this.fillResult([null,s],r)}).catch(s=>{this.fillResult([s],r)}),this._queue.push(e),this}addBatch(e){let r,s,n;for(let i=0;i<e.length;++i)r=e[i],s=r[0],n=r.slice(1),this[s].apply(this,n);return this}};Ys.default=he;var Rp=he.prototype.multi;he.prototype.multi=function(){return this._transactions+=1,Rp.apply(this,arguments)};var za=he.prototype.execBuffer;he.prototype.execBuffer=(0,vp.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),za.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");he.prototype.exec=function(t){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Cp.noop),t&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,Va.default)(this.promise,t)),this.redis.delayUntilReady(n=>{if(n){this.reject(n);return}this.exec(t)}),this.promise;if(this._transactions>0)return this._transactions-=1,za.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,Va.default)(this.promise,t)),this._queue.length||this.resolve([]);let e;if(this.isCluster){let n=[];for(let i=0;i<this._queue.length;i++){let o=this._queue[i].getKeys();if(o.length&&n.push(o[0]),o.length&&Ks.generateMulti(o)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(n.length){if(e=Op(this.redis,n),e<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else e=Math.random()*16384|0}let r=this;return s(),this.promise;function s(){let n=r.replyPending=r._queue.length,i;r.isCluster&&(i={slot:e,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let o="",c,a={isPipeline:!0,destination:r.isCluster?i:{redis:r.redis},write(f){typeof f!="string"?(c||(c=[]),o&&(c.push(Buffer.from(o,"utf8")),o=""),c.push(f)):o+=f,--n||(c?(o&&c.push(Buffer.from(o,"utf8")),a.destination.redis.stream.write(Buffer.concat(c))):a.destination.redis.stream.write(o),n=r._queue.length,o="",c=void 0)}};for(let f=0;f<r._queue.length;++f)r.redis.sendCommand(r._queue[f],a,i);return r.promise}}});var Zs=h(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.addTransactionSupport=void 0;var Xs=N(),Js=ue(),Ka=Ws();function Tp(t){t.pipeline=function(s){let n=new Ka.default(this);return Array.isArray(s)&&n.addBatch(s),n};let{multi:e}=t;t.multi=function(s,n){if(typeof n>"u"&&!Array.isArray(s)&&(n=s,s=null),n&&n.pipeline===!1)return e.call(this);let i=new Ka.default(this);i.multi(),Array.isArray(s)&&i.addBatch(s);let o=i.exec;i.exec=function(a){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Xs.noop),(0,Js.default)(new Promise((l,u)=>{this.redis.delayUntilReady(p=>{if(p){u(p);return}this.exec(i).then(l,u)})}),a);if(this._transactions>0&&o.call(i),this.nodeifiedPromise)return o.call(i);let f=o.call(i);return(0,Js.default)(f.then(function(l){let u=l[l.length-1];if(typeof u>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(u[0]){u[0].previousErrors=[];for(let p=0;p<l.length-1;++p)l[p][0]&&u[0].previousErrors.push(l[p][0]);throw u[0]}return(0,Xs.wrapMultiResult)(u[1])}),a)};let{execBuffer:c}=i;return i.execBuffer=function(a){return this._transactions>0&&c.call(i),i.exec(a)},i};let{exec:r}=t;t.exec=function(s){return(0,Js.default)(r.call(this).then(function(n){return Array.isArray(n)&&(n=(0,Xs.wrapMultiResult)(n)),n}),s)}}rr.addTransactionSupport=Tp});var tn=h(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});function Ip(t,e){Object.getOwnPropertyNames(e.prototype).forEach(r=>{Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r))})}en.default=Ip});var Wa=h(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.DEFAULT_CLUSTER_OPTIONS=void 0;var Ya=require("dns");sr.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:t=>Math.min(100+t*2,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:Ya.resolveSrv,dnsLookup:Ya.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var ot=h(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.getConnectionName=P.weightSrvRecords=P.groupSrvRecords=P.getUniqueHostnamesFromOptions=P.normalizeNodeOptions=P.nodeKeyToRedisOptions=P.getNodeKey=void 0;var Xa=N(),Np=require("net");function Mp(t){return t.port=t.port||6379,t.host=t.host||"127.0.0.1",t.host+":"+t.port}P.getNodeKey=Mp;function Pp(t){let e=t.lastIndexOf(":");if(e===-1)throw new Error(`Invalid node key ${t}`);return{host:t.slice(0,e),port:Number(t.slice(e+1))}}P.nodeKeyToRedisOptions=Pp;function qp(t){return t.map(e=>{let r={};if(typeof e=="object")Object.assign(r,e);else if(typeof e=="string")Object.assign(r,(0,Xa.parseURL)(e));else if(typeof e=="number")r.port=e;else throw new Error("Invalid argument "+e);return typeof r.port=="string"&&(r.port=parseInt(r.port,10)),delete r.db,r.port||(r.port=6379),r.host||(r.host="127.0.0.1"),(0,Xa.resolveTLSProfile)(r)})}P.normalizeNodeOptions=qp;function Lp(t){let e={};return t.forEach(r=>{e[r.host]=!0}),Object.keys(e).filter(r=>!(0,Np.isIP)(r))}P.getUniqueHostnamesFromOptions=Lp;function Dp(t){let e={};for(let r of t)e.hasOwnProperty(r.priority)?(e[r.priority].totalWeight+=r.weight,e[r.priority].records.push(r)):e[r.priority]={totalWeight:r.weight,records:[r]};return e}P.groupSrvRecords=Dp;function Bp(t){if(t.records.length===1)return t.totalWeight=0,t.records.shift();let e=Math.floor(Math.random()*(t.totalWeight+t.records.length)),r=0;for(let[s,n]of t.records.entries())if(r+=1+n.weight,r>e)return t.totalWeight-=n.weight,t.records.splice(s,1),n}P.weightSrvRecords=Bp;function jp(t,e){let r=`ioredis-cluster(${t})`;return e?`${r}:${e}`:r}P.getConnectionName=jp});var on=h(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});var Ja=ot(),rn=N(),Fp=pe(),Z=(0,rn.Debug)("cluster:subscriber"),sn=class{constructor(e,r,s=!1){this.connectionPool=e,this.emitter=r,this.isSharded=s,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){Z("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}Z("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(n,i)=>{!this.started||!this.subscriber||(0,Ja.getNodeKey)(this.subscriber.options)===i&&(Z("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(Z("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}associateSlotRange(e){return this.isSharded&&(this.slotRange=e),this.slotRange}start(){this.started=!0,this.selectSubscriber(),Z("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null)}isStarted(){return this.started}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let r=(0,rn.sample)(this.connectionPool.getNodes());if(!r){Z("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:s}=r;Z("selected a subscriber %s:%s",s.host,s.port);let n="subscriber";this.isSharded&&(n="ssubscriber"),this.subscriber=new Fp.default({port:s.port,host:s.host,username:s.username,password:s.password,enableReadyCheck:!0,connectionName:(0,Ja.getConnectionName)(n,s.connectionName),lazyConnect:!0,tls:s.tls,retryStrategy:null}),this.subscriber.on("error",rn.noop),this.subscriber.on("moved",()=>{this.emitter.emit("forceRefresh")}),this.subscriber.once("end",this.onSubscriberEnd);let i={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let o=e.condition||e.prevCondition;o&&o.subscriber&&(i.subscribe=o.subscriber.channels("subscribe"),i.psubscribe=o.subscriber.channels("psubscribe"),i.ssubscribe=o.subscriber.channels("ssubscribe"))}if(i.subscribe.length||i.psubscribe.length||i.ssubscribe.length){let o=0;for(let c of["subscribe","psubscribe","ssubscribe"]){let a=i[c];if(a.length!=0)if(Z("%s %d channels",c,a.length),c==="ssubscribe")for(let f of a)o+=1,this.subscriber[c](f).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{Z("failed to ssubscribe to channel: %s",f)});else o+=1,this.subscriber[c](a).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{Z("failed to %s %d channels",c,a.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let o of["message","messageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)});for(let o of["pmessage","pmessageBuffer"])this.subscriber.on(o,(c,a,f)=>{this.emitter.emit(o,c,a,f)});if(this.isSharded==!0)for(let o of["smessage","smessageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)})}};nn.default=sn});var un=h(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});var $p=require("events"),nr=N(),an=ot(),Up=pe(),at=(0,nr.Debug)("cluster:connectionPool"),cn=class extends $p.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){let r=this.nodes[e];return Object.keys(r).map(s=>r[s])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let r=Object.keys(this.nodes[e]),s=(0,nr.sample)(r);return this.nodes[e][s]}addMasterNode(e){let r=(0,an.getNodeKey)(e.options),s=this.createRedisFromOptions(e,e.options.readOnly);return e.options.readOnly?!1:(this.nodes.all[r]=s,this.nodes.master[r]=s,!0)}createRedisFromOptions(e,r){return new Up.default((0,nr.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:r},e,this.redisOptions,{lazyConnect:!0}))}findOrCreate(e,r=!1){let s=(0,an.getNodeKey)(e);r=!!r,this.specifiedOptions[s]?Object.assign(e,this.specifiedOptions[s]):this.specifiedOptions[s]=e;let n;return this.nodes.all[s]?(n=this.nodes.all[s],n.options.readOnly!==r&&(n.options.readOnly=r,at("Change role of %s to %s",s,r?"slave":"master"),n[r?"readonly":"readwrite"]().catch(nr.noop),r?(delete this.nodes.master[s],this.nodes.slave[s]=n):(delete this.nodes.slave[s],this.nodes.master[s]=n))):(at("Connecting to %s as %s",s,r?"slave":"master"),n=this.createRedisFromOptions(e,r),this.nodes.all[s]=n,this.nodes[r?"slave":"master"][s]=n,n.once("end",()=>{this.removeNode(s),this.emit("-node",n,s),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",n,s),n.on("error",function(i){this.emit("nodeError",i,s)})),n}reset(e){at("Reset with %O",e);let r={};e.forEach(s=>{let n=(0,an.getNodeKey)(s);s.readOnly&&r[n]||(r[n]=s)}),Object.keys(this.nodes.all).forEach(s=>{r[s]||(at("Disconnect %s because the node does not hold any slot",s),this.nodes.all[s].disconnect(),this.removeNode(s))}),Object.keys(r).forEach(s=>{let n=r[s];this.findOrCreate(n,n.readOnly)})}removeNode(e){let{nodes:r}=this;r.all[e]&&(at("Remove %s from the pool",e),delete r.all[e]),delete r.master[e],delete r.slave[e]}};fn.default=cn});var ir=h((Mw,Za)=>{"use strict";function C(t,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}C.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var s=this.size();if(!(r>=s||r<-s))return r<0&&(r+=s),r=this._head+r&this._capacityMask,this._list[r]}};C.prototype.get=function(e){return this.peekAt(e)};C.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};C.prototype.peekFront=function(){return this.peek()};C.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(C.prototype,"length",{get:function(){return this.size()}});C.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.unshift=function(e){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};C.prototype.push=function(e){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),s}};C.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var s=this.size(),n=this._list.length;if(!(r>=s||r<-s)){r<0&&(r+=s),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<s/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=s-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}};C.prototype.remove=function(e,r){var s=e,n,i=r;if(s===(s|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(s>=o||s<-o||r<1)){if(s<0&&(s+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(s),n;if(s===0&&s+r>=o)return n=this.toArray(),this.clear(),n;s+r>o&&(r=o-s);var a;for(n=new Array(r),a=0;a<r;a++)n[a]=this._list[this._head+s+a&this._capacityMask];if(s=this._head+s&this._capacityMask,e+r===o){for(this._tail=this._tail-r+c&this._capacityMask,a=r;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+c&this._capacityMask,a=r-1;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(s<o/2){for(this._head=this._head+e+r+c&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[s=s-1+c&this._capacityMask]);for(s=this._head-1+c&this._capacityMask;i>0;)this._list[s=s-1+c&this._capacityMask]=void 0,i--;e<0&&(this._tail=s)}else{for(this._tail=s,s=s+r+c&this._capacityMask,a=o-(r+e);a>0;a--)this.push(this._list[s++]);for(s=this._tail;i>0;)this._list[s=s+1+c&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),n}}};C.prototype.splice=function(e,r){var s=e;if(s===(s|0)){var n=this.size();if(s<0&&(s+=n),!(s>n))if(arguments.length>2){var i,o,c,a=arguments.length,f=this._list.length,l=2;if(!n||s<n/2){for(o=new Array(s),i=0;i<s;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(c=[],s>0&&(this._head=this._head+s+f&this._capacityMask)):(c=this.remove(s,r),this._head=this._head+s+f&this._capacityMask);a>l;)this.unshift(arguments[--a]);for(i=s;i>0;i--)this.unshift(o[i-1])}else{o=new Array(n-(s+r));var u=o.length;for(i=0;i<u;i++)o[i]=this._list[this._head+s+r+i&this._capacityMask];for(r===0?(c=[],s!=n&&(this._tail=this._head+s+f&this._capacityMask)):(c=this.remove(s,r),this._tail=this._tail-u+f&this._capacityMask);l<a;)this.push(arguments[l++]);for(i=0;i<u;i++)this.push(o[i])}return c}else return this.remove(s,r)}};C.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};C.prototype.isEmpty=function(){return this._head===this._tail};C.prototype.toArray=function(){return this._copyArray(!1)};C.prototype._fromArray=function(e){var r=e.length,s=this._nextPowerOf2(r);this._list=new Array(s),this._capacityMask=s-1,this._tail=r;for(var n=0;n<r;n++)this._list[n]=e[n]};C.prototype._copyArray=function(e,r){var s=this._list,n=s.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),c=0,a;if(e||this._head>this._tail){for(a=this._head;a<n;a++)o[c++]=s[a];for(a=0;a<this._tail;a++)o[c++]=s[a]}else for(a=this._head;a<this._tail;a++)o[c++]=s[a];return o};C.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};C.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};C.prototype._nextPowerOf2=function(e){var r=Math.log(e)/Math.log(2),s=1<<r+1;return Math.max(s,4)};Za.exports=C});var ec=h(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});var Gp=N(),Hp=ir(),Qp=(0,Gp.Debug)("delayqueue"),ln=class{constructor(){this.queues={},this.timeouts={}}push(e,r,s){let n=s.callback||process.nextTick;this.queues[e]||(this.queues[e]=new Hp),this.queues[e].push(r),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{n(()=>{this.timeouts[e]=null,this.execute(e)})},s.timeout))}execute(e){let r=this.queues[e];if(!r)return;let{length:s}=r;if(s)for(Qp("send %d commands in %s queue",s,e),this.queues[e]=null;r.length>0;)r.shift()()}};dn.default=ln});var sc=h(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});var Vp=N(),zp=on(),Kp=un(),tc=ot(),or=st(),rc=(0,Vp.Debug)("cluster:subscriberGroup"),hn=class{constructor(e,r){this.cluster=e,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,e.on("+node",s=>{this._addSubscriber(s)}),e.on("-node",s=>{this._removeSubscriber(s)}),e.on("refresh",()=>{this._refreshSlots(e)}),e.on("forceRefresh",()=>{r()})}getResponsibleSubscriber(e){let r=this.clusterSlots[e][0];return this.shardedSubscribers.get(r)}addChannels(e){let r=or(e[0]);e.forEach(n=>{if(or(n)!=r)return-1});let s=this.channels.get(r);return s?this.channels.set(r,s.concat(e)):this.channels.set(r,e),[...this.channels.values()].flatMap(n=>n).length}removeChannels(e){let r=or(e[0]);e.forEach(n=>{if(or(n)!=r)return-1});let s=this.channels.get(r);if(s){let n=s.filter(i=>!e.includes(i));this.channels.set(r,n)}return[...this.channels.values()].flatMap(n=>n).length}stop(){for(let e of this.shardedSubscribers.values())e.stop()}start(){for(let e of this.shardedSubscribers.values())e.isStarted()||e.start()}_addSubscriber(e){let r=new Kp.default(e.options);if(r.addMasterNode(e)){let s=new zp.default(r,this.cluster,!0),n=(0,tc.getNodeKey)(e.options);return this.shardedSubscribers.set(n,s),s.start(),this._resubscribe(),this.cluster.emit("+subscriber"),s}return null}_removeSubscriber(e){let r=(0,tc.getNodeKey)(e.options),s=this.shardedSubscribers.get(r);return s&&(s.stop(),this.shardedSubscribers.delete(r),this._resubscribe(),this.cluster.emit("-subscriber")),this.shardedSubscribers}_refreshSlots(e){if(this._slotsAreEqual(e.slots))rc("Nothing to refresh because the new cluster map is equal to the previous one.");else{rc("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let r=0;r<e.slots.length;r++){let s=e.slots[r][0];this.subscriberToSlotsIndex.has(s)||this.subscriberToSlotsIndex.set(s,[]),this.subscriberToSlotsIndex.get(s).push(Number(r))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(e.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){this.shardedSubscribers&&this.shardedSubscribers.forEach((e,r)=>{let s=this.subscriberToSlotsIndex.get(r);s&&(e.associateSlotRange(s),s.forEach(n=>{let i=e.getInstance(),o=this.channels.get(n);o&&o.length>0&&i&&(i.ssubscribe(o),i.on("ready",()=>{i.ssubscribe(o)}))}))})}_slotsAreEqual(e){return this.clusterSlots===void 0?!1:JSON.stringify(this.clusterSlots)===JSON.stringify(e)}};pn.default=hn});var mn=h(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});var nc=Me(),fc=require("events"),ct=ve(),ic=ue(),oc=ie(),yn=La(),Yp=pe(),Wp=Zt(),Xp=Zs(),U=N(),Jp=tn(),Zp=tr(),ey=Wa(),ty=on(),ry=un(),sy=ec(),$e=ot(),ac=ir(),ny=sc(),_=(0,U.Debug)("cluster"),cc=new WeakSet,ft=class t extends Zp.default{constructor(e,r={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new sy.default,this.offlineQueue=new ac,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,fc.EventEmitter.call(this),this.startupNodes=e,this.options=(0,U.defaults)({},r,ey.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0&&(this.shardedSubscribers=new ny.default(this,this.refreshSlotsCache.bind(this))),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new ry.default(this.options.redisOptions),this.connectionPool.on("-node",(s,n)=>{this.emit("-node",s)}),this.connectionPool.on("+node",s=>{this.emit("+node",s)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(s,n)=>{this.emit("node error",s,n)}),this.subscriber=new ty.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([s,n])=>{this.defineCommand(s,n)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(s=>{_("connecting failed: %s",s)})}connect(){return new Promise((e,r)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){r(new Error("Redis is already connecting/connected"));return}let s=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(n=>{if(this.connectionEpoch!==s){_("discard connecting after resolving startup nodes because epoch not match: %d != %d",s,this.connectionEpoch),r(new ct.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){_("discard connecting after resolving startup nodes because the status changed to %s",this.status),r(new ct.RedisError("Connection is aborted"));return}this.connectionPool.reset(n);let i=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()},o,c=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",o),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((a,f)=>{a||f?(_("Ready check failed (%s). Reconnecting...",a||f),this.status==="connect"&&this.disconnect(!0)):i()}):i()};o=()=>{let a=new Error("None of startup nodes is available");this.removeListener("refresh",c),this.invokeReadyDelayedCallbacks(a),r(a)},this.once("refresh",c),this.once("close",o),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(a=>{a&&a.message===yn.default.defaultMessage&&(Yp.default.prototype.silentEmit.call(this,"error",a),this.connectionPool.reset([]))}),this.subscriber.start(),this.options.shardedSubscribers&&this.shardedSubscribers.start()}).catch(n=>{this.setStatus("close"),this.handleCloseEvent(n),this.invokeReadyDelayedCallbacks(n),r(n)})})}disconnect(e=!1){let r=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,_("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){let r=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"){let s=(0,ic.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),s}return(0,ic.default)(Promise.all(this.nodes().map(s=>s.quit().catch(n=>{if(n.message===U.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw n}))).then(()=>"OK"),e)}duplicate(e=[],r={}){let s=e.length>0?e:this.startupNodes.slice(0),n=Object.assign({},this.options,r);return new t(s,n)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave")throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;let r=this,s=c=>{this.isRefreshing=!1;for(let a of this._refreshSlotsCacheCallbacks)a(c);this._refreshSlotsCacheCallbacks=[]},n=(0,U.shuffle)(this.connectionPool.getNodes()),i=null;function o(c){if(c===n.length){let l=new yn.default(yn.default.defaultMessage,i);return s(l)}let a=n[c],f=`${a.options.host}:${a.options.port}`;_("getting slot cache from %s",f),r.getInfoFromNode(a,function(l){switch(r.status){case"close":case"end":return s(new Error("Cluster is disconnected."));case"disconnecting":return s(new Error("Cluster is disconnecting."))}l?(r.emit("node error",l,f),i=l,o(c+1)):(r.emit("refresh"),s())})}o(0)}sendCommand(e,r,s){if(this.status==="wait"&&this.connect().catch(U.noop),this.status==="end")return e.reject(new Error(U.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let n=this.options.scaleReads;n!=="master"&&(e.isReadOnly||(0,nc.exists)(e.name)&&(0,nc.hasFlag)(e.name,"readonly")||(n="master"));let i=s?s.slot:e.getSlot(),o={},c=this;if(!s&&!cc.has(e)){cc.add(e);let f=e.reject;e.reject=function(l){let u=a.bind(null,!0);c.handleError(l,o,{moved:function(p,d){_("command %s is moved to %s",e.name,d),i=Number(p),c.slots[p]?c.slots[p][0]=d:c.slots[p]=[d],c._groupsBySlot[p]=c._groupsIds[c.slots[p].join(";")],c.connectionPool.findOrCreate(c.natMapper(d)),a(),_("refreshing slot caches... (triggered by MOVED error)"),c.refreshSlotsCache()},ask:function(p,d){_("command %s is required to ask %s:%s",e.name,d);let x=c.natMapper(d);c.connectionPool.findOrCreate(x),a(!1,`${x.host}:${x.port}`)},tryagain:u,clusterDown:u,connectionClosed:u,maxRedirections:function(p){f.call(e,p)},defaults:function(){f.call(e,l)}})}}a();function a(f,l){if(c.status==="end"){e.reject(new ct.AbortError("Cluster is ended."));return}let u;if(c.status==="ready"||e.name==="cluster"){if(s&&s.redis)u=s.redis;else if(oc.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||oc.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(c.options.shardedSubscribers==!0&&(e.name=="ssubscribe"||e.name=="sunsubscribe")){let p=c.shardedSubscribers.getResponsibleSubscriber(i),d=-1;e.name=="ssubscribe"&&(d=c.shardedSubscribers.addChannels(e.getKeys())),e.name=="sunsubscribe"&&(d=c.shardedSubscribers.removeChannels(e.getKeys())),d!==-1?u=p.getInstance():e.reject(new ct.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else u=c.subscriber.getInstance();if(!u){e.reject(new ct.AbortError("No subscriber for the cluster"));return}}else{if(!f){if(typeof i=="number"&&c.slots[i]){let p=c.slots[i];if(typeof n=="function"){let d=p.map(function(x){return c.connectionPool.getInstanceByKey(x)});u=n(d,e),Array.isArray(u)&&(u=(0,U.sample)(u)),u||(u=d[0])}else{let d;n==="all"?d=(0,U.sample)(p):n==="slave"&&p.length>1?d=(0,U.sample)(p,1):d=p[0],u=c.connectionPool.getInstanceByKey(d)}}l&&(u=c.connectionPool.getInstanceByKey(l),u.asking())}u||(u=(typeof n=="function"?null:c.connectionPool.getSampleInstance(n))||c.connectionPool.getSampleInstance("all"))}s&&!s.redis&&(s.redis=u)}u?u.sendCommand(e,r):c.options.enableOfflineQueue?c.offlineQueue.push({command:e,stream:r,node:s}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return e.promise}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}handleError(e,r,s){if(typeof r.value>"u"?r.value=this.options.maxRedirections:r.value-=1,r.value<=0){s.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}let n=e.message.split(" ");if(n[0]==="MOVED"){let i=this.options.retryDelayOnMoved;i&&typeof i=="number"?this.delayQueue.push("moved",s.moved.bind(null,n[1],n[2]),{timeout:i}):s.moved(n[1],n[2])}else n[0]==="ASK"?s.ask(n[1],n[2]):n[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",s.tryagain,{timeout:this.options.retryDelayOnTryAgain}):n[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",s.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===U.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",s.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):s.defaults()}resetOfflineQueue(){this.offlineQueue=new ac}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{_('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){_("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){e&&_("closed because %s",e);let r;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(r=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),typeof r=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,_("Cluster is disconnected. Retrying after %dms",r),this.connect().catch(function(s){_("Got error %s when reconnecting. Ignoring...",s)})},r)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(e){let r;for(;r=this.offlineQueue.shift();)r.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){_("send %d commands in offline queue",this.offlineQueue.length);let e=this.offlineQueue;this.resetOfflineQueue();let r;for(;r=e.shift();)this.sendCommand(r.command,r.stream,r.node)}}natMapper(e){let r=typeof e=="string"?e:`${e.host}:${e.port}`,s=null;return this.options.natMap&&typeof this.options.natMap=="function"?s=this.options.natMap(r):this.options.natMap&&typeof this.options.natMap=="object"&&(s=this.options.natMap[r]),s?(_("NAT mapping %s -> %O",r,s),Object.assign({},s)):typeof e=="string"?(0,$e.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,r){if(!e)return r(new Error("Node is disconnected"));let s=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,$e.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});s.on("error",U.noop),s.cluster("SLOTS",(0,U.timeout)((n,i)=>{if(s.disconnect(),n)return _("error encountered running CLUSTER.SLOTS: %s",n),r(n);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){_("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",i.length,this.status),r();return}let o=[];_("cluster slots result count: %d",i.length);for(let a=0;a<i.length;++a){let f=i[a],l=f[0],u=f[1],p=[];for(let d=2;d<f.length;d++){if(!f[d][0])continue;let x=this.natMapper({host:f[d][0],port:f[d][1]});x.readOnly=d!==2,o.push(x),p.push(x.host+":"+x.port)}_("cluster slots result [%d]: slots %d~%d served by %s",a,l,u,p);for(let d=l;d<=u;d++)this.slots[d]=p}this._groupsIds=Object.create(null);let c=0;for(let a=0;a<16384;a++){let f=(this.slots[a]||[]).join(";");if(!f.length){this._groupsBySlot[a]=void 0;continue}this._groupsIds[f]||(this._groupsIds[f]=++c),this._groupsBySlot[a]=this._groupsIds[f]}this.connectionPool.reset(o),r()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(let r of this._readyDelayedCallbacks)process.nextTick(r,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(r,s)=>{if(r)return e(r);if(typeof s!="string")return e();let n,i=s.split(`\r
`);for(let o=0;o<i.length;++o){let c=i[o].split(":");if(c[0]==="cluster_state"){n=c[1];break}}n==="fail"?(_("cluster state not ok (%s)",n),e(null,n)):e()})}resolveSrv(e){return new Promise((r,s)=>{this.options.resolveSrv(e,(n,i)=>{if(n)return s(n);let o=this,c=(0,$e.groupSrvRecords)(i),a=Object.keys(c).sort((l,u)=>parseInt(l)-parseInt(u));function f(l){if(!a.length)return s(l);let u=a[0],p=c[u],d=(0,$e.weightSrvRecords)(p);p.records.length||a.shift(),o.dnsLookup(d.name).then(x=>r({host:x,port:d.port}),f)}f()})})}dnsLookup(e){return new Promise((r,s)=>{this.options.dnsLookup(e,(n,i)=>{n?(_("failed to resolve hostname %s to IP: %s",e,n.message),s(n)):(_("resolved hostname %s to IP %s",e,i),r(i))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let e=(0,$e.normalizeNodeOptions)(this.startupNodes),r=(0,$e.getUniqueHostnamesFromOptions)(e);if(r.length===0)return e;let s=await Promise.all(r.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),n=(0,U.zipMap)(r,s);return e.map(i=>{let o=n.get(i.host);return o?this.options.useSRVRecords?Object.assign({},i,o):Object.assign({},i,{host:o}):i})}createScanStream(e,{key:r,options:s={}}){return new Wp.default({objectMode:!0,key:r,redis:this,command:e,...s})}};(0,Jp.default)(ft,fc.EventEmitter);(0,Xp.addTransactionSupport)(ft.prototype);gn.default=ft});var ar=h(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});var iy=N(),oy=(0,iy.Debug)("AbstractConnector"),xn=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){let e=this.stream,r=setTimeout(()=>{oy("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(r)),e.end()}}};bn.default=xn});var uc=h(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});var ay=require("net"),cy=require("tls"),fy=N(),uy=ar(),Sn=class extends uy.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){let{options:r}=this;this.connecting=!0;let s;return"path"in r&&r.path?s={path:r.path}:(s={},"port"in r&&r.port!=null&&(s.port=r.port),"host"in r&&r.host!=null&&(s.host=r.host),"family"in r&&r.family!=null&&(s.family=r.family)),r.tls&&Object.assign(s,r.tls),new Promise((n,i)=>{process.nextTick(()=>{if(!this.connecting){i(new Error(fy.CONNECTION_CLOSED_ERROR_MSG));return}try{r.tls?this.stream=(0,cy.connect)(s):this.stream=(0,ay.createConnection)(s)}catch(o){i(o);return}this.stream.once("error",o=>{this.firstError=o}),n(this.stream)})})}};En.default=Sn});var lc=h(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});function ly(t,e){return(t.host||"127.0.0.1")===(e.host||"127.0.0.1")&&(t.port||26379)===(e.port||26379)}var wn=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){let e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++)if(ly(e,this.sentinels[r]))return!1;return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}};kn.default=wn});var hc=h(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.FailoverDetector=void 0;var dy=N(),vn=(0,dy.Debug)("FailoverDetector"),dc="+switch-master",An=class{constructor(e,r){this.isDisconnected=!1,this.connector=e,this.sentinels=r}cleanup(){this.isDisconnected=!0;for(let e of this.sentinels)e.client.disconnect()}async subscribe(){vn("Starting FailoverDetector");let e=[];for(let r of this.sentinels){let s=r.client.subscribe(dc).catch(n=>{vn("Failed to subscribe to failover messages on sentinel %s:%s (%s)",r.address.host||"127.0.0.1",r.address.port||26739,n.message)});e.push(s),r.client.on("message",n=>{!this.isDisconnected&&n===dc&&this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,vn("Failover detected, disconnecting"),this.connector.disconnect()}};cr.FailoverDetector=An});var fr=h(lt=>{"use strict";Object.defineProperty(lt,"__esModule",{value:!0});lt.SentinelIterator=void 0;var hy=require("net"),ut=N(),py=require("tls"),pc=lc();lt.SentinelIterator=pc.default;var yy=ar(),gy=pe(),my=hc(),Ue=(0,ut.Debug)("SentinelConnector"),Cn=class extends yy.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new pc.default(this.options.sentinels)}check(e){let r=!e.role||this.options.role===e.role;return r||(Ue("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),r}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){this.connecting=!0,this.retryAttempts=0;let r,s=async()=>{let n=this.sentinelIterator.next();if(n.done){this.sentinelIterator.reset(!1);let a=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,f=typeof a!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${a}ms.`;r&&(f+=` Last error: ${r.message}`),Ue(f);let l=new Error(f);if(typeof a=="number")return e("error",l),await new Promise(u=>setTimeout(u,a)),s();throw l}let i=null,o=null;try{i=await this.resolve(n.value)}catch(a){o=a}if(!this.connecting)throw new Error(ut.CONNECTION_CLOSED_ERROR_MSG);let c=n.value.host+":"+n.value.port;if(i)return Ue("resolved: %s:%s from sentinel %s",i.host,i.port,c),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(i,this.options.tls),this.stream=(0,py.connect)(i),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,hy.createConnection)(i),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",a=>{this.firstError=a}),this.stream;{let a=o?"failed to connect to sentinel "+c+" because "+o.message:"connected to sentinel "+c+" successfully, but got an invalid reply: "+i;return Ue(a),e("sentinelError",new Error(a)),o&&(r=o),s()}};return s()}async updateSentinels(e){if(!this.options.updateSentinels)return;let r=await e.sentinel("sentinels",this.options.name);Array.isArray(r)&&(r.map(ut.packObject).forEach(s=>{if((s.flags?s.flags.split(","):[]).indexOf("disconnected")===-1&&s.ip&&s.port){let i=this.sentinelNatResolve(yc(s));this.sentinelIterator.add(i)&&Ue("adding sentinel %s:%s",i.host,i.port)}}),Ue("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){let r=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(r)?{host:r[0],port:Number(r[1])}:null)}async resolveSlave(e){let r=await e.sentinel("slaves",this.options.name);if(!Array.isArray(r))return null;let s=r.map(ut.packObject).filter(n=>n.flags&&!n.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(xy(s,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;let r=`${e.host}:${e.port}`,s=e;return typeof this.options.natMap=="function"?s=this.options.natMap(r)||e:typeof this.options.natMap=="object"&&(s=this.options.natMap[r]||e),s}connectToSentinel(e,r){return new gy.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...r})}async resolve(e){let r=this.connectToSentinel(e);r.on("error",by);try{return this.options.role==="slave"?await this.resolveSlave(r):await this.resolveMaster(r)}finally{r.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let r=[];for(;r.length<this.options.sentinelMaxConnections;){let{done:s,value:n}=this.sentinelIterator.next();if(s)break;let i=this.connectToSentinel(n,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});i.on("reconnecting",()=>{var o;(o=this.emitter)===null||o===void 0||o.emit("sentinelReconnecting")}),r.push({address:n,client:i})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new my.FailoverDetector(this,r),await this.failoverDetector.subscribe(),(e=this.emitter)===null||e===void 0||e.emit("failoverSubscribed")}};lt.default=Cn;function xy(t,e){if(t.length===0)return null;let r;if(typeof e=="function")r=e(t);else if(e!==null&&typeof e=="object"){let s=Array.isArray(e)?e:[e];s.sort((n,i)=>(n.prio||(n.prio=1),i.prio||(i.prio=1),n.prio<i.prio?-1:n.prio>i.prio?1:0));for(let n=0;n<s.length;n++){for(let i=0;i<t.length;i++){let o=t[i];if(o.ip===s[n].ip&&o.port===s[n].port){r=o;break}}if(r)break}}return r||(r=(0,ut.sample)(t)),yc(r)}function yc(t){return{host:t.ip,port:Number(t.port)}}function by(){}});var gc=h(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.SentinelConnector=Ge.StandaloneConnector=void 0;var Sy=uc();Ge.StandaloneConnector=Sy.default;var Ey=fr();Ge.SentinelConnector=Ey.default});var mc=h(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});var wy=ve(),_n=class extends wy.AbortError{constructor(e){let r=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(r),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};On.default=_n});var xc=h(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.MaxRetriesPerRequestError=void 0;var ky=mc();ur.MaxRetriesPerRequestError=ky.default});var Ac=h((Qw,vc)=>{"use strict";var Pn=require("buffer").Buffer,vy=require("string_decoder").StringDecoder,Rn=new vy,bc=ve(),Ay=bc.ReplyError,Cy=bc.ParserError,Y=Pn.allocUnsafe(32*1024),D=0,lr=null,dt=0,Tn=0;function _y(t){let e=t.buffer.length-1;var r=t.offset,s=0,n=1;for(t.buffer[r]===45&&(n=-1,r++);r<e;){let i=t.buffer[r++];if(i===13)return t.offset=r+1,n*s;s=s*10+(i-48)}}function Oy(t){let e=t.buffer.length-1;var r=t.offset,s=0,n="";for(t.buffer[r]===45&&(n+="-",r++);r<e;){var i=t.buffer[r++];if(i===13)return t.offset=r+1,s!==0&&(n+=s),n;s>429496728?(n+=s*10+(i-48),s=0):i===48&&s===0?n+=0:s=s*10+(i-48)}}function Sc(t){let e=t.offset,r=t.buffer,s=r.length-1;for(var n=e;n<s;)if(r[n++]===13)return t.offset=n+1,t.optionReturnBuffers===!0?t.buffer.slice(e,n-1):t.buffer.toString("utf8",e,n-1)}function Ec(t){let e=t.buffer.length-1;for(var r=t.offset,s=0;r<e;){let n=t.buffer[r++];if(n===13)return t.offset=r+1,s;s=s*10+(n-48)}}function Ry(t){return t.optionStringNumbers===!0?Oy(t):_y(t)}function Ty(t){let e=Ec(t);if(e===void 0)return;if(e<0)return null;let r=t.offset+e;if(r+2>t.buffer.length){t.bigStrSize=r+2,t.totalChunkSize=t.buffer.length,t.bufferCache.push(t.buffer);return}let s=t.offset;return t.offset=r+2,t.optionReturnBuffers===!0?t.buffer.slice(s,r):t.buffer.toString("utf8",s,r)}function Iy(t){var e=Sc(t);if(e!==void 0)return t.optionReturnBuffers===!0&&(e=e.toString()),new Ay(e)}function Ny(t,e){let r=new Cy("Protocol error, got "+JSON.stringify(String.fromCharCode(e))+" as reply type byte",JSON.stringify(t.buffer),t.offset);t.buffer=null,t.returnFatalError(r)}function My(t){let e=Ec(t);if(e===void 0)return;if(e<0)return null;let r=new Array(e);return wc(t,r,0)}function In(t,e,r){t.arrayCache.push(e),t.arrayPos.push(r)}function Nn(t){let e=t.arrayCache.pop();var r=t.arrayPos.pop();if(t.arrayCache.length){let s=Nn(t);if(s===void 0){In(t,e,r);return}e[r++]=s}return wc(t,e,r)}function wc(t,e,r){let s=t.buffer.length;for(;r<e.length;){let n=t.offset;if(t.offset>=s){In(t,e,r);return}let i=kc(t,t.buffer[t.offset++]);if(i===void 0){t.arrayCache.length||t.bufferCache.length||(t.offset=n),In(t,e,r);return}e[r]=i,r++}return e}function kc(t,e){switch(e){case 36:return Ty(t);case 43:return Sc(t);case 42:return My(t);case 58:return Ry(t);case 45:return Iy(t);default:return Ny(t,e)}}function Py(){if(Y.length>50*1024)if(dt===1||Tn>dt*2){let t=Math.floor(Y.length/10),e=t<D?D:t;D=0,Y=Y.slice(e,Y.length)}else Tn++,dt--;else clearInterval(lr),dt=0,Tn=0,lr=null}function qy(t){if(Y.length<t+D){let e=t>78643200?2:3;D>1024*1024*111&&(D=1024*1024*50),Y=Pn.allocUnsafe(t*e+D),D=0,dt++,lr===null&&(lr=setInterval(Py,50))}}function Ly(t){let e=t.bufferCache,r=t.offset;var s=e.length,n=t.bigStrSize-t.totalChunkSize;if(t.offset=n,n<=2){if(s===2)return e[0].toString("utf8",r,e[0].length+n-2);s--,n=e[e.length-2].length+n}for(var i=Rn.write(e[0].slice(r)),o=1;o<s-1;o++)i+=Rn.write(e[o]);return i+=Rn.end(e[o].slice(0,n-2)),i}function Dy(t){let e=t.bufferCache,r=t.offset,s=t.bigStrSize-r-2;var n=e.length,i=t.bigStrSize-t.totalChunkSize;if(t.offset=i,i<=2){if(n===2)return e[0].slice(r,e[0].length+i-2);n--,i=e[e.length-2].length+i}qy(s);let o=D;e[0].copy(Y,o,r,e[0].length),D+=e[0].length-r;for(var c=1;c<n-1;c++)e[c].copy(Y,D),D+=e[c].length;return e[c].copy(Y,D,0,i-2),D+=i-2,Y.slice(o,D)}var Mn=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if(typeof e.returnError!="function"||typeof e.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if(typeof e!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if(typeof e!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(this.buffer===null)this.buffer=e,this.offset=0;else if(this.bigStrSize===0){let s=this.buffer.length,n=s-this.offset,i=Pn.allocUnsafe(n+e.length);if(this.buffer.copy(i,0,this.offset,s),e.copy(i,n,0,e.length),this.buffer=i,this.offset=0,this.arrayCache.length){let o=Nn(this);if(o===void 0)return;this.returnReply(o)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var r=this.optionReturnBuffers?Dy(this):Ly(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=r,r=Nn(this),r===void 0))return;this.returnReply(r)}else{this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let s=this.offset,n=this.buffer[this.offset++],i=kc(this,n);if(i===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=s);return}n===45?this.returnError(i):this.returnReply(i)}this.buffer=null}};vc.exports=Mn});var _c=h((Vw,Cc)=>{"use strict";Cc.exports=Ac()});var Oc=h(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});var Ln=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,r){this.set[qn(e)][r]=!0}del(e,r){delete this.set[qn(e)][r]}channels(e){return Object.keys(this.set[qn(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}};Dn.default=Ln;function qn(t){return t==="unsubscribe"?"subscribe":t==="punsubscribe"?"psubscribe":t==="sunsubscribe"?"ssubscribe":t}});var Nc=h(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});var Rc=ie(),By=N(),jy=_c(),Fy=Oc(),$y=(0,By.Debug)("dataHandler"),Bn=class{constructor(e,r){this.redis=e;let s=new jy({stringNumbers:r.stringNumbers,returnBuffers:!0,returnError:n=>{this.returnError(n)},returnFatalError:n=>{this.returnFatalError(n)},returnReply:n=>{this.returnReply(n)}});e.stream.prependListener("data",n=>{s.execute(n)}),e.stream.resume()}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){let r=this.shiftCommand(e);if(r){if(e.command={name:r.command.name,args:r.command.args},r.command.name=="ssubscribe"&&e.message.includes("MOVED")){this.redis.emit("moved");return}this.redis.handleReconnection(e,r)}}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let r=this.shiftCommand(e);r&&(Rc.default.checkFlag("ENTER_SUBSCRIBER_MODE",r.command.name)?(this.redis.condition.subscriber=new Fy.default,this.redis.condition.subscriber.add(r.command.name,e[1].toString()),Tc(r.command,e[2])||this.redis.commandQueue.unshift(r)):Rc.default.checkFlag("EXIT_SUBSCRIBER_MODE",r.command.name)?Ic(r.command,e[2])||this.redis.commandQueue.unshift(r):r.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;let r=Array.isArray(e)?e[0].toString():null;switch($y('receive reply "%s" in subscriber mode',r),r){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{let s=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",s,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",s,e[2],e[3]);break}case"smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let s=e[1].toString();this.redis.condition.subscriber.add(r,s);let n=this.shiftCommand(e);if(!n)return;Tc(n.command,e[2])||this.redis.commandQueue.unshift(n);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let s=e[1]?e[1].toString():null;s&&this.redis.condition.subscriber.del(r,s);let n=e[2];Number(n)===0&&(this.redis.condition.subscriber=!1);let i=this.shiftCommand(e);if(!i)return;Ic(i.command,n)||this.redis.commandQueue.unshift(i);break}default:{let s=this.shiftCommand(e);if(!s)return;s.command.resolve(e)}}return!0}handleMonitorReply(e){if(this.redis.status!=="monitoring")return!1;let r=e.toString();if(r==="OK")return!1;let s=r.indexOf(" "),n=r.slice(0,s),i=r.indexOf('"'),o=r.slice(i+1,-1).split('" "').map(a=>a.replace(/\\"/g,'"')),c=r.slice(s+2,i-2).split(" ");return this.redis.emit("monitor",n,o,c[1],c[0]),!0}shiftCommand(e){let r=this.redis.commandQueue.shift();if(!r){let s="Command queue state error. If you can reproduce this, please report it.",n=new Error(s+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",n),null}return r}};jn.default=Bn;var ye=new WeakMap;function Tc(t,e){let r=ye.has(t)?ye.get(t):t.args.length;return r-=1,r<=0?(t.resolve(e),ye.delete(t),!0):(ye.set(t,r),!1)}function Ic(t,e){let r=ye.has(t)?ye.get(t):t.args.length;return r===0?Number(e)===0?(ye.delete(t),t.resolve(e),!0):!1:(r-=1,r<=0?(t.resolve(e),!0):(ye.set(t,r),!1))}});var Mc=h(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.readyHandler=H.errorHandler=H.closeHandler=H.connectHandler=void 0;var Uy=ve(),Gy=ie(),Hy=xc(),ee=N(),Qy=Nc(),M=(0,ee.Debug)("connection");function Vy(t){return function(){var e;t.setStatus("connect"),t.resetCommandQueue();let r=!1,{connectionEpoch:s}=t;t.condition.auth&&t.auth(t.condition.auth,function(i){s===t.connectionEpoch&&i&&(i.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):i.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):i.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(r=!0,t.recoverFromFatalError(i,i)))}),t.condition.select&&t.select(t.condition.select).catch(i=>{t.silentEmit("error",i)}),new Qy.default(t,{stringNumbers:t.options.stringNumbers});let n=[];t.options.connectionName&&(M("set the connection name [%s]",t.options.connectionName),n.push(t.client("setname",t.options.connectionName).catch(ee.noop))),t.options.disableClientInfo||(M("set the client info"),n.push((0,ee.getPackageMeta)().then(i=>t.client("SETINFO","LIB-VER",i.version).catch(ee.noop)).catch(ee.noop)),n.push(t.client("SETINFO","LIB-NAME",!((e=t.options)===null||e===void 0)&&e.clientInfoTag?`ioredis(${t.options.clientInfoTag})`:"ioredis").catch(ee.noop))),Promise.all(n).catch(ee.noop).finally(()=>{t.options.enableReadyCheck||H.readyHandler(t)(),t.options.enableReadyCheck&&t._readyCheck(function(i,o){s===t.connectionEpoch&&(i?r||t.recoverFromFatalError(new Error("Ready check failed: "+i.message),i):t.connector.check(o)?H.readyHandler(t)():t.disconnect(!0))})})}}H.connectHandler=Vy;function Fn(t){let e=new Uy.AbortError("Command aborted due to connection close");return e.command={name:t.name,args:t.args},e}function zy(t){var e;let r=0;for(let s=0;s<t.length;){let n=(e=t.peekAt(s))===null||e===void 0?void 0:e.command,i=n.pipelineIndex;if((i===void 0||i===0)&&(r=0),i!==void 0&&i!==r++){t.remove(s,1),n.reject(Fn(n));continue}s++}}function Ky(t){var e;for(let r=0;r<t.length;){let s=(e=t.peekAt(r))===null||e===void 0?void 0:e.command;if(s.name==="multi")break;if(s.name==="exec"){t.remove(r,1),s.reject(Fn(s));break}s.inTransaction?(t.remove(r,1),s.reject(Fn(s))):r++}}function Yy(t){return function(){let r=t.status;if(t.setStatus("close"),t.commandQueue.length&&zy(t.commandQueue),t.offlineQueue.length&&Ky(t.offlineQueue),r==="ready"&&(t.prevCondition||(t.prevCondition=t.condition),t.commandQueue.length&&(t.prevCommandQueue=t.commandQueue)),t.manuallyClosing)return t.manuallyClosing=!1,M("skip reconnecting since the connection is manually closed."),e();if(typeof t.options.retryStrategy!="function")return M("skip reconnecting because `retryStrategy` is not a function"),e();let s=t.options.retryStrategy(++t.retryAttempts);if(typeof s!="number")return M("skip reconnecting because `retryStrategy` doesn't return a number"),e();M("reconnect in %sms",s),t.setStatus("reconnecting",s),t.reconnectTimeout=setTimeout(function(){t.reconnectTimeout=null,t.connect().catch(ee.noop)},s);let{maxRetriesPerRequest:n}=t.options;typeof n=="number"&&(n<0?M("maxRetriesPerRequest is negative, ignoring..."):t.retryAttempts%(n+1)===0&&(M("reach maxRetriesPerRequest limitation, flushing command queue..."),t.flushQueue(new Hy.MaxRetriesPerRequestError(n))))};function e(){t.setStatus("end"),t.flushQueue(new Error(ee.CONNECTION_CLOSED_ERROR_MSG))}}H.closeHandler=Yy;function Wy(t){return function(e){M("error: %s",e),t.silentEmit("error",e)}}H.errorHandler=Wy;function Xy(t){return function(){if(t.setStatus("ready"),t.retryAttempts=0,t.options.monitor){t.call("monitor").then(()=>t.setStatus("monitoring"),s=>t.emit("error",s));let{sendCommand:r}=t;t.sendCommand=function(s){return Gy.default.checkFlag("VALID_IN_MONITOR_MODE",s.name)?r.call(t,s):(s.reject(new Error("Connection is in monitoring mode, can't process commands.")),s.promise)},t.once("close",function(){delete t.sendCommand});return}let e=t.prevCondition?t.prevCondition.select:t.condition.select;if(t.options.readOnly&&(M("set the connection to readonly mode"),t.readonly().catch(ee.noop)),t.prevCondition){let r=t.prevCondition;if(t.prevCondition=null,r.subscriber&&t.options.autoResubscribe){t.condition.select!==e&&(M("connect to db [%d]",e),t.select(e));let s=r.subscriber.channels("subscribe");s.length&&(M("subscribe %d channels",s.length),t.subscribe(s));let n=r.subscriber.channels("psubscribe");n.length&&(M("psubscribe %d channels",n.length),t.psubscribe(n));let i=r.subscriber.channels("ssubscribe");if(i.length){M("ssubscribe %s",i.length);for(let o of i)t.ssubscribe(o)}}}if(t.prevCommandQueue)if(t.options.autoResendUnfulfilledCommands)for(M("resend %d unfulfilled commands",t.prevCommandQueue.length);t.prevCommandQueue.length>0;){let r=t.prevCommandQueue.shift();r.select!==t.condition.select&&r.command.name!=="select"&&t.select(r.select),t.sendCommand(r.command,r.stream)}else t.prevCommandQueue=null;if(t.offlineQueue.length){M("send %d commands in offline queue",t.offlineQueue.length);let r=t.offlineQueue;for(t.resetOfflineQueue();r.length>0;){let s=r.shift();s.select!==t.condition.select&&s.command.name!=="select"&&t.select(s.select),t.sendCommand(s.command,s.stream)}}t.condition.select!==e&&(M("connect to db [%d]",e),t.select(e))}}H.readyHandler=Xy});var Pc=h(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.DEFAULT_REDIS_OPTIONS=void 0;dr.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:0,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(t){return Math.min(t*50,2e3)},keepAlive:0,noDelay:!0,connectionName:null,disableClientInfo:!1,clientInfoTag:void 0,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(t){return Math.min(t*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var pe=h(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});var qc=Me(),Dc=require("events"),$n=ue(),Jy=mn(),ht=ie(),Zy=gc(),eg=fr(),ge=Mc(),tg=Pc(),rg=Zt(),sg=Zs(),_e=N(),ng=tn(),ig=tr(),me=Vt(),Lc=ir(),xe=(0,_e.Debug)("redis"),be=class t extends ig.default{constructor(e,r,s){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,r,s),Dc.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let n=new eg.default(this.options);n.emitter=this,this.connector=n}else this.connector=new Zy.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([n,i])=>{this.defineCommand(n,i)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(me.noop)}static createClient(...e){return new t(...e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}connect(e){let r=new Promise((s,n)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){n(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:i}=this;this.condition={select:i.db,auth:i.username?[i.username,i.password]:i.password,subscriber:!1};let o=this;(0,$n.default)(this.connector.connect(function(c,a){o.silentEmit(c,a)}),function(c,a){if(c){o.flushQueue(c),o.silentEmit("error",c),n(c),o.setStatus("end");return}let f=i.tls?"secureConnect":"connect";if("sentinels"in i&&i.sentinels&&!i.enableTLSForSentinelMode&&(f="connect"),o.stream=a,i.noDelay&&a.setNoDelay(!0),typeof i.keepAlive=="number"&&(a.connecting?a.once(f,()=>{a.setKeepAlive(!0,i.keepAlive)}):a.setKeepAlive(!0,i.keepAlive)),a.connecting){if(a.once(f,ge.connectHandler(o)),i.connectTimeout){let p=!1;a.setTimeout(i.connectTimeout,function(){if(p)return;a.setTimeout(0),a.destroy();let d=new Error("connect ETIMEDOUT");d.errorno="ETIMEDOUT",d.code="ETIMEDOUT",d.syscall="connect",ge.errorHandler(o)(d)}),a.once(f,function(){p=!0,a.setTimeout(0)})}}else if(a.destroyed){let p=o.connector.firstError;p&&process.nextTick(()=>{ge.errorHandler(o)(p)}),process.nextTick(ge.closeHandler(o))}else process.nextTick(ge.connectHandler(o));a.destroyed||(a.once("error",ge.errorHandler(o)),a.once("close",ge.closeHandler(o)));let l=function(){o.removeListener("close",u),s()};var u=function(){o.removeListener("ready",l),n(new Error(_e.CONNECTION_CLOSED_ERROR_MSG))};o.once("ready",l),o.once("close",u)})});return(0,$n.default)(r,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?ge.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new t({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":!((e=this.condition)===null||e===void 0)&&e.subscriber?"subscriber":"normal"}monitor(e){let r=this.duplicate({monitor:!0,lazyConnect:!1});return(0,$n.default)(new Promise(function(s,n){r.once("error",n),r.once("monitoring",function(){s(r)})}),e)}sendCommand(e,r){var s,n;if(this.status==="wait"&&this.connect().catch(me.noop),this.status==="end")return e.reject(new Error(_e.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if(!((s=this.condition)===null||s===void 0)&&s.subscriber&&!ht.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;typeof this.options.commandTimeout=="number"&&e.setTimeout(this.options.commandTimeout);let i=this.status==="ready"||!r&&this.status==="connect"&&(0,qc.exists)(e.name)&&((0,qc.hasFlag)(e.name,"loading")||ht.default.checkFlag("HANDSHAKE_COMMANDS",e.name));if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(i=!1):i=!1,i)xe.enabled&&xe("write command[%s]: %d -> %s(%o)",this._getDescription(),(n=this.condition)===null||n===void 0?void 0:n.select,e.name,e.args),r?"isPipeline"in r&&r.isPipeline?r.write(e.toWritable(r.destination.redis.stream)):r.write(e.toWritable(r)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:r,select:this.condition.select}),ht.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if(e.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;xe.enabled&&xe("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:r,select:this.condition.select})}if(e.name==="select"&&(0,_e.isInt)(e.args[0])){let o=parseInt(e.args[0],10);this.condition.select!==o&&(this.condition.select=o,this.emit("select",o),xe("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length!==0&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}silentEmit(e,r){let s;if(!(e==="error"&&(s=r,this.status==="end"||this.manuallyClosing&&s instanceof Error&&(s.message===_e.CONNECTION_CLOSED_ERROR_MSG||s.syscall==="connect"||s.syscall==="read"))))return this.listeners(e).length>0?this.emit.apply(this,arguments):(s&&s instanceof Error&&console.error("[ioredis] Unhandled error event:",s.stack),!1)}recoverFromFatalError(e,r,s){this.flushQueue(r,s),this.silentEmit("error",r),this.disconnect(!0)}handleReconnection(e,r){var s;let n=!1;switch(this.options.reconnectOnError&&!ht.default.checkFlag("IGNORE_RECONNECT_ON_ERROR",r.command.name)&&(n=this.options.reconnectOnError(e)),n){case 1:case!0:this.status!=="reconnecting"&&this.disconnect(!0),r.command.reject(e);break;case 2:this.status!=="reconnecting"&&this.disconnect(!0),((s=this.condition)===null||s===void 0?void 0:s.select)!==r.select&&r.command.name!=="select"&&this.select(r.select),this.sendCommand(r.command);break;default:r.command.reject(e)}}_getDescription(){let e;return"path"in this.options&&this.options.path?e=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?e=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?e=this.options.host+":"+this.options.port:e="",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new Lc}resetOfflineQueue(){this.offlineQueue=new Lc}parseOptions(...e){let r={},s=!1;for(let n=0;n<e.length;++n){let i=e[n];if(!(i===null||typeof i>"u"))if(typeof i=="object")(0,me.defaults)(r,i);else if(typeof i=="string")(0,me.defaults)(r,(0,_e.parseURL)(i)),i.startsWith("rediss://")&&(s=!0);else if(typeof i=="number")r.port=i;else throw new Error("Invalid argument "+i)}s&&(0,me.defaults)(r,{tls:!0}),(0,me.defaults)(r,t.defaultOptions),typeof r.port=="string"&&(r.port=parseInt(r.port,10)),typeof r.db=="string"&&(r.db=parseInt(r.db,10)),this.options=(0,_e.resolveTLSProfile)(r)}setStatus(e,r){xe.enabled&&xe("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,r))}createScanStream(e,{key:r,options:s={}}){return new rg.default({objectMode:!0,key:r,redis:this,command:e,...s})}flushQueue(e,r){r=(0,me.defaults)({},r,{offlineQueue:!0,commandQueue:!0});let s;if(r.offlineQueue)for(;s=this.offlineQueue.shift();)s.command.reject(e);if(r.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");s=this.commandQueue.shift();)s.command.reject(e)}_readyCheck(e){let r=this;this.info(function(s,n){if(s)return s.message&&s.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${s.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(s);if(typeof n!="string")return e(null,n);let i={},o=n.split(`\r
`);for(let c=0;c<o.length;++c){let[a,...f]=o[c].split(":"),l=f.join(":");l&&(i[a]=l)}if(!i.loading||i.loading==="0")e(null,i);else{let c=(i.loading_eta_seconds||1)*1e3,a=r.options.maxLoadingRetryTime&&r.options.maxLoadingRetryTime<c?r.options.maxLoadingRetryTime:c;xe("Redis server still loading, trying again in "+a+"ms"),setTimeout(function(){r._readyCheck(e)},a)}}).catch(me.noop)}};be.Cluster=Jy.default;be.Command=ht.default;be.defaultOptions=tg.DEFAULT_REDIS_OPTIONS;(0,ng.default)(be,Dc.EventEmitter);(0,sg.addTransactionSupport)(be.prototype);Un.default=be});var Fc=h((k,jc)=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.print=k.ReplyError=k.SentinelIterator=k.SentinelConnector=k.AbstractConnector=k.Pipeline=k.ScanStream=k.Command=k.Cluster=k.Redis=k.default=void 0;k=jc.exports=pe().default;var og=pe();Object.defineProperty(k,"default",{enumerable:!0,get:function(){return og.default}});var ag=pe();Object.defineProperty(k,"Redis",{enumerable:!0,get:function(){return ag.default}});var cg=mn();Object.defineProperty(k,"Cluster",{enumerable:!0,get:function(){return cg.default}});var fg=ie();Object.defineProperty(k,"Command",{enumerable:!0,get:function(){return fg.default}});var ug=Zt();Object.defineProperty(k,"ScanStream",{enumerable:!0,get:function(){return ug.default}});var lg=Ws();Object.defineProperty(k,"Pipeline",{enumerable:!0,get:function(){return lg.default}});var dg=ar();Object.defineProperty(k,"AbstractConnector",{enumerable:!0,get:function(){return dg.default}});var Bc=fr();Object.defineProperty(k,"SentinelConnector",{enumerable:!0,get:function(){return Bc.default}});Object.defineProperty(k,"SentinelIterator",{enumerable:!0,get:function(){return Bc.SentinelIterator}});k.ReplyError=ve().ReplyError;Object.defineProperty(k,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(t){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function hg(t,e){console.log(t?"Error: "+t:"Reply: "+e)}k.print=hg});var Qe=h((Hn,Vc)=>{var yr=require("buffer"),te=yr.Buffer;function Qc(t,e){for(var r in t)e[r]=t[r]}te.from&&te.alloc&&te.allocUnsafe&&te.allocUnsafeSlow?Vc.exports=yr:(Qc(yr,Hn),Hn.Buffer=Oe);function Oe(t,e,r){return te(t,e,r)}Oe.prototype=Object.create(te.prototype);Qc(te,Oe);Oe.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return te(t,e,r)};Oe.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var s=te(t);return e!==void 0?typeof r=="string"?s.fill(e,r):s.fill(e):s.fill(0),s};Oe.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return te(t)};Oe.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return yr.SlowBuffer(t)}});var Qn=h((t2,zc)=>{var gr=Qe().Buffer,Sg=require("stream"),Eg=require("util");function mr(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=gr.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=gr.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}Eg.inherits(mr,Sg);mr.prototype.write=function(e){this.buffer=gr.concat([this.buffer,gr.from(e)]),this.emit("data",e)};mr.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};zc.exports=mr});var Yc=h((r2,Kc)=>{"use strict";function Vn(t){var e=(t/8|0)+(t%8===0?0:1);return e}var wg={ES256:Vn(256),ES384:Vn(384),ES512:Vn(521)};function kg(t){var e=wg[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}Kc.exports=kg});var rf=h((s2,tf)=>{"use strict";var xr=Qe().Buffer,Xc=Yc(),br=128,Jc=0,vg=32,Ag=16,Cg=2,Zc=Ag|vg|Jc<<6,Sr=Cg|Jc<<6;function _g(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ef(t){if(xr.isBuffer(t))return t;if(typeof t=="string")return xr.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Og(t,e){t=ef(t);var r=Xc(e),s=r+1,n=t.length,i=0;if(t[i++]!==Zc)throw new Error('Could not find expected "seq"');var o=t[i++];if(o===(br|1)&&(o=t[i++]),n-i<o)throw new Error('"seq" specified length of "'+o+'", only "'+(n-i)+'" remaining');if(t[i++]!==Sr)throw new Error('Could not find expected "int" for "r"');var c=t[i++];if(n-i-2<c)throw new Error('"r" specified length of "'+c+'", only "'+(n-i-2)+'" available');if(s<c)throw new Error('"r" specified length of "'+c+'", max of "'+s+'" is acceptable');var a=i;if(i+=c,t[i++]!==Sr)throw new Error('Could not find expected "int" for "s"');var f=t[i++];if(n-i!==f)throw new Error('"s" specified length of "'+f+'", expected "'+(n-i)+'"');if(s<f)throw new Error('"s" specified length of "'+f+'", max of "'+s+'" is acceptable');var l=i;if(i+=f,i!==n)throw new Error('Expected to consume entire buffer, but "'+(n-i)+'" bytes remain');var u=r-c,p=r-f,d=xr.allocUnsafe(u+c+p+f);for(i=0;i<u;++i)d[i]=0;t.copy(d,i,a+Math.max(-u,0),a+c),i=r;for(var x=i;i<x+p;++i)d[i]=0;return t.copy(d,i,l+Math.max(-p,0),l+f),d=d.toString("base64"),d=_g(d),d}function Wc(t,e,r){for(var s=0;e+s<r&&t[e+s]===0;)++s;var n=t[e+s]>=br;return n&&--s,s}function Rg(t,e){t=ef(t);var r=Xc(e),s=t.length;if(s!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+s+'"');var n=Wc(t,0,r),i=Wc(t,r,t.length),o=r-n,c=r-i,a=2+o+1+1+c,f=a<br,l=xr.allocUnsafe((f?2:3)+a),u=0;return l[u++]=Zc,f?l[u++]=a:(l[u++]=br|1,l[u++]=a&255),l[u++]=Sr,l[u++]=o,n<0?(l[u++]=0,u+=t.copy(l,u,0,r)):u+=t.copy(l,u,n,r),l[u++]=Sr,l[u++]=c,i<0?(l[u++]=0,t.copy(l,u,r)):t.copy(l,u,r+i),l}tf.exports={derToJose:Og,joseToDer:Rg}});var nf=h((n2,sf)=>{"use strict";var yt=require("buffer").Buffer,zn=require("buffer").SlowBuffer;sf.exports=Er;function Er(t,e){if(!yt.isBuffer(t)||!yt.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,s=0;s<t.length;s++)r|=t[s]^e[s];return r===0}Er.install=function(){yt.prototype.equal=zn.prototype.equal=function(e){return Er(this,e)}};var Tg=yt.prototype.equal,Ig=zn.prototype.equal;Er.restore=function(){yt.prototype.equal=Tg,zn.prototype.equal=Ig}});var Xn=h((i2,pf)=>{var ze=Qe().Buffer,Q=require("crypto"),af=rf(),of=require("util"),Ng=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,gt="secret must be a string or buffer",Ve="key must be a string or a buffer",Mg="key must be a string, a buffer or an object",Yn=typeof Q.createPublicKey=="function";Yn&&(Ve+=" or a KeyObject",gt+="or a KeyObject");function cf(t){if(!ze.isBuffer(t)&&typeof t!="string"&&(!Yn||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw W(Ve)}function ff(t){if(!ze.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw W(Mg)}function Pg(t){if(!ze.isBuffer(t)){if(typeof t=="string")return t;if(!Yn||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw W(gt)}}function Wn(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uf(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function W(t){var e=[].slice.call(arguments,1),r=of.format.bind(of,t).apply(null,e);return new TypeError(r)}function qg(t){return ze.isBuffer(t)||typeof t=="string"}function mt(t){return qg(t)||(t=JSON.stringify(t)),t}function lf(t){return function(r,s){Pg(s),r=mt(r);var n=Q.createHmac("sha"+t,s),i=(n.update(r),n.digest("base64"));return Wn(i)}}var Kn,Lg="timingSafeEqual"in Q?function(e,r){return e.byteLength!==r.byteLength?!1:Q.timingSafeEqual(e,r)}:function(e,r){return Kn||(Kn=nf()),Kn(e,r)};function Dg(t){return function(r,s,n){var i=lf(t)(r,n);return Lg(ze.from(s),ze.from(i))}}function df(t){return function(r,s){ff(s),r=mt(r);var n=Q.createSign("RSA-SHA"+t),i=(n.update(r),n.sign(s,"base64"));return Wn(i)}}function hf(t){return function(r,s,n){cf(n),r=mt(r),s=uf(s);var i=Q.createVerify("RSA-SHA"+t);return i.update(r),i.verify(n,s,"base64")}}function Bg(t){return function(r,s){ff(s),r=mt(r);var n=Q.createSign("RSA-SHA"+t),i=(n.update(r),n.sign({key:s,padding:Q.constants.RSA_PKCS1_PSS_PADDING,saltLength:Q.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Wn(i)}}function jg(t){return function(r,s,n){cf(n),r=mt(r),s=uf(s);var i=Q.createVerify("RSA-SHA"+t);return i.update(r),i.verify({key:n,padding:Q.constants.RSA_PKCS1_PSS_PADDING,saltLength:Q.constants.RSA_PSS_SALTLEN_DIGEST},s,"base64")}}function Fg(t){var e=df(t);return function(){var s=e.apply(null,arguments);return s=af.derToJose(s,"ES"+t),s}}function $g(t){var e=hf(t);return function(s,n,i){n=af.joseToDer(n,"ES"+t).toString("base64");var o=e(s,n,i);return o}}function Ug(){return function(){return""}}function Gg(){return function(e,r){return r===""}}pf.exports=function(e){var r={hs:lf,rs:df,ps:Bg,es:Fg,none:Ug},s={hs:Dg,rs:hf,ps:jg,es:$g,none:Gg},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw W(Ng,e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:r[i](o),verify:s[i](o)}}});var Jn=h((o2,yf)=>{var Hg=require("buffer").Buffer;yf.exports=function(e){return typeof e=="string"?e:typeof e=="number"||Hg.isBuffer(e)?e.toString():JSON.stringify(e)}});var Ef=h((a2,Sf)=>{var Qg=Qe().Buffer,gf=Qn(),Vg=Xn(),zg=require("stream"),mf=Jn(),Zn=require("util");function xf(t,e){return Qg.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Kg(t,e,r){r=r||"utf8";var s=xf(mf(t),"binary"),n=xf(mf(e),r);return Zn.format("%s.%s",s,n)}function bf(t){var e=t.header,r=t.payload,s=t.secret||t.privateKey,n=t.encoding,i=Vg(e.alg),o=Kg(e,r,n),c=i.sign(o,s);return Zn.format("%s.%s",o,c)}function wr(t){var e=t.secret||t.privateKey||t.key,r=new gf(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new gf(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Zn.inherits(wr,zg);wr.prototype.sign=function(){try{var e=bf({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}};wr.sign=bf;Sf.exports=wr});var If=h((c2,Tf)=>{var kf=Qe().Buffer,wf=Qn(),Yg=Xn(),Wg=require("stream"),vf=Jn(),Xg=require("util"),Jg=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Zg(t){return Object.prototype.toString.call(t)==="[object Object]"}function em(t){if(Zg(t))return t;try{return JSON.parse(t)}catch{return}}function Af(t){var e=t.split(".",1)[0];return em(kf.from(e,"base64").toString("binary"))}function tm(t){return t.split(".",2).join(".")}function Cf(t){return t.split(".")[2]}function rm(t,e){e=e||"utf8";var r=t.split(".")[1];return kf.from(r,"base64").toString(e)}function _f(t){return Jg.test(t)&&!!Af(t)}function Of(t,e,r){if(!e){var s=new Error("Missing algorithm parameter for jws.verify");throw s.code="MISSING_ALGORITHM",s}t=vf(t);var n=Cf(t),i=tm(t),o=Yg(e);return o.verify(i,n,r)}function Rf(t,e){if(e=e||{},t=vf(t),!_f(t))return null;var r=Af(t);if(!r)return null;var s=rm(t);return(r.typ==="JWT"||e.json)&&(s=JSON.parse(s,e.encoding)),{header:r,payload:s,signature:Cf(t)}}function Ke(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new wf(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new wf(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}Xg.inherits(Ke,Wg);Ke.prototype.verify=function(){try{var e=Of(this.signature.buffer,this.algorithm,this.key.buffer),r=Rf(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(s){this.readable=!1,this.emit("error",s),this.emit("close")}};Ke.decode=Rf;Ke.isValid=_f;Ke.verify=Of;Tf.exports=Ke});var vr=h(Se=>{var Nf=Ef(),kr=If(),sm=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];Se.ALGORITHMS=sm;Se.sign=Nf.sign;Se.verify=kr.verify;Se.decode=kr.decode;Se.isValid=kr.isValid;Se.createSign=function(e){return new Nf(e)};Se.createVerify=function(e){return new kr(e)}});var ei=h((u2,Mf)=>{var nm=vr();Mf.exports=function(t,e){e=e||{};var r=nm.decode(t,e);if(!r)return null;var s=r.payload;if(typeof s=="string")try{var n=JSON.parse(s);n!==null&&typeof n=="object"&&(s=n)}catch{}return e.complete===!0?{header:r.header,payload:s,signature:r.signature}:s}});var xt=h((l2,Pf)=>{var Ar=function(t,e){Error.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=t,e&&(this.inner=e)};Ar.prototype=Object.create(Error.prototype);Ar.prototype.constructor=Ar;Pf.exports=Ar});var ti=h((d2,Lf)=>{var qf=xt(),Cr=function(t,e){qf.call(this,t),this.name="NotBeforeError",this.date=e};Cr.prototype=Object.create(qf.prototype);Cr.prototype.constructor=Cr;Lf.exports=Cr});var ri=h((h2,Bf)=>{var Df=xt(),_r=function(t,e){Df.call(this,t),this.name="TokenExpiredError",this.expiredAt=e};_r.prototype=Object.create(Df.prototype);_r.prototype.constructor=_r;Bf.exports=_r});var si=h((p2,jf)=>{var im=Ns();jf.exports=function(t,e){var r=e||Math.floor(Date.now()/1e3);if(typeof t=="string"){var s=im(t);return typeof s>"u"?void 0:Math.floor(r+s/1e3)}else return typeof t=="number"?r+t:void 0}});var bt=h((y2,Ff)=>{"use strict";var om="2.0.0",am=Number.MAX_SAFE_INTEGER||9007199254740991,cm=16,fm=250,um=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Ff.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:cm,MAX_SAFE_BUILD_LENGTH:fm,MAX_SAFE_INTEGER:am,RELEASE_TYPES:um,SEMVER_SPEC_VERSION:om,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var St=h((g2,$f)=>{"use strict";var lm=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};$f.exports=lm});var Ye=h((re,Uf)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:ni,MAX_SAFE_BUILD_LENGTH:dm,MAX_LENGTH:hm}=bt(),pm=St();re=Uf.exports={};var ym=re.re=[],gm=re.safeRe=[],y=re.src=[],mm=re.safeSrc=[],g=re.t={},xm=0,ii="[a-zA-Z0-9-]",bm=[["\\s",1],["\\d",hm],[ii,dm]],Sm=t=>{for(let[e,r]of bm)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},E=(t,e,r)=>{let s=Sm(e),n=xm++;pm(t,n,e),g[t]=n,y[n]=e,mm[n]=s,ym[n]=new RegExp(e,r?"g":void 0),gm[n]=new RegExp(s,r?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*");E("NUMERICIDENTIFIERLOOSE","\\d+");E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${ii}*`);E("MAINVERSION",`(${y[g.NUMERICIDENTIFIER]})\\.(${y[g.NUMERICIDENTIFIER]})\\.(${y[g.NUMERICIDENTIFIER]})`);E("MAINVERSIONLOOSE",`(${y[g.NUMERICIDENTIFIERLOOSE]})\\.(${y[g.NUMERICIDENTIFIERLOOSE]})\\.(${y[g.NUMERICIDENTIFIERLOOSE]})`);E("PRERELEASEIDENTIFIER",`(?:${y[g.NONNUMERICIDENTIFIER]}|${y[g.NUMERICIDENTIFIER]})`);E("PRERELEASEIDENTIFIERLOOSE",`(?:${y[g.NONNUMERICIDENTIFIER]}|${y[g.NUMERICIDENTIFIERLOOSE]})`);E("PRERELEASE",`(?:-(${y[g.PRERELEASEIDENTIFIER]}(?:\\.${y[g.PRERELEASEIDENTIFIER]})*))`);E("PRERELEASELOOSE",`(?:-?(${y[g.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${y[g.PRERELEASEIDENTIFIERLOOSE]})*))`);E("BUILDIDENTIFIER",`${ii}+`);E("BUILD",`(?:\\+(${y[g.BUILDIDENTIFIER]}(?:\\.${y[g.BUILDIDENTIFIER]})*))`);E("FULLPLAIN",`v?${y[g.MAINVERSION]}${y[g.PRERELEASE]}?${y[g.BUILD]}?`);E("FULL",`^${y[g.FULLPLAIN]}$`);E("LOOSEPLAIN",`[v=\\s]*${y[g.MAINVERSIONLOOSE]}${y[g.PRERELEASELOOSE]}?${y[g.BUILD]}?`);E("LOOSE",`^${y[g.LOOSEPLAIN]}$`);E("GTLT","((?:<|>)?=?)");E("XRANGEIDENTIFIERLOOSE",`${y[g.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);E("XRANGEIDENTIFIER",`${y[g.NUMERICIDENTIFIER]}|x|X|\\*`);E("XRANGEPLAIN",`[v=\\s]*(${y[g.XRANGEIDENTIFIER]})(?:\\.(${y[g.XRANGEIDENTIFIER]})(?:\\.(${y[g.XRANGEIDENTIFIER]})(?:${y[g.PRERELEASE]})?${y[g.BUILD]}?)?)?`);E("XRANGEPLAINLOOSE",`[v=\\s]*(${y[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[g.XRANGEIDENTIFIERLOOSE]})(?:${y[g.PRERELEASELOOSE]})?${y[g.BUILD]}?)?)?`);E("XRANGE",`^${y[g.GTLT]}\\s*${y[g.XRANGEPLAIN]}$`);E("XRANGELOOSE",`^${y[g.GTLT]}\\s*${y[g.XRANGEPLAINLOOSE]}$`);E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${ni}})(?:\\.(\\d{1,${ni}}))?(?:\\.(\\d{1,${ni}}))?`);E("COERCE",`${y[g.COERCEPLAIN]}(?:$|[^\\d])`);E("COERCEFULL",y[g.COERCEPLAIN]+`(?:${y[g.PRERELEASE]})?(?:${y[g.BUILD]})?(?:$|[^\\d])`);E("COERCERTL",y[g.COERCE],!0);E("COERCERTLFULL",y[g.COERCEFULL],!0);E("LONETILDE","(?:~>?)");E("TILDETRIM",`(\\s*)${y[g.LONETILDE]}\\s+`,!0);re.tildeTrimReplace="$1~";E("TILDE",`^${y[g.LONETILDE]}${y[g.XRANGEPLAIN]}$`);E("TILDELOOSE",`^${y[g.LONETILDE]}${y[g.XRANGEPLAINLOOSE]}$`);E("LONECARET","(?:\\^)");E("CARETTRIM",`(\\s*)${y[g.LONECARET]}\\s+`,!0);re.caretTrimReplace="$1^";E("CARET",`^${y[g.LONECARET]}${y[g.XRANGEPLAIN]}$`);E("CARETLOOSE",`^${y[g.LONECARET]}${y[g.XRANGEPLAINLOOSE]}$`);E("COMPARATORLOOSE",`^${y[g.GTLT]}\\s*(${y[g.LOOSEPLAIN]})$|^$`);E("COMPARATOR",`^${y[g.GTLT]}\\s*(${y[g.FULLPLAIN]})$|^$`);E("COMPARATORTRIM",`(\\s*)${y[g.GTLT]}\\s*(${y[g.LOOSEPLAIN]}|${y[g.XRANGEPLAIN]})`,!0);re.comparatorTrimReplace="$1$2$3";E("HYPHENRANGE",`^\\s*(${y[g.XRANGEPLAIN]})\\s+-\\s+(${y[g.XRANGEPLAIN]})\\s*$`);E("HYPHENRANGELOOSE",`^\\s*(${y[g.XRANGEPLAINLOOSE]})\\s+-\\s+(${y[g.XRANGEPLAINLOOSE]})\\s*$`);E("STAR","(<|>)?=?\\s*\\*");E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Or=h((m2,Gf)=>{"use strict";var Em=Object.freeze({loose:!0}),wm=Object.freeze({}),km=t=>t?typeof t!="object"?Em:t:wm;Gf.exports=km});var oi=h((x2,Vf)=>{"use strict";var Hf=/^[0-9]+$/,Qf=(t,e)=>{if(typeof t=="number"&&typeof e=="number")return t===e?0:t<e?-1:1;let r=Hf.test(t),s=Hf.test(e);return r&&s&&(t=+t,e=+e),t===e?0:r&&!s?-1:s&&!r?1:t<e?-1:1},vm=(t,e)=>Qf(e,t);Vf.exports={compareIdentifiers:Qf,rcompareIdentifiers:vm}});var q=h((b2,Kf)=>{"use strict";var Rr=St(),{MAX_LENGTH:zf,MAX_SAFE_INTEGER:Tr}=bt(),{safeRe:Ir,t:Nr}=Ye(),Am=Or(),{compareIdentifiers:ai}=oi(),ci=class t{constructor(e,r){if(r=Am(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>zf)throw new TypeError(`version is longer than ${zf} characters`);Rr("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let s=e.trim().match(r.loose?Ir[Nr.LOOSE]:Ir[Nr.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>Tr||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Tr||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Tr||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let i=+n;if(i>=0&&i<Tr)return i}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Rr("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let s=this.prerelease[r],n=e.prerelease[r];if(Rr("prerelease compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return ai(s,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let s=this.build[r],n=e.build[r];if(Rr("build compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return ai(s,n)}while(++r)}inc(e,r,s){if(e.startsWith("pre")){if(!r&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n=`-${r}`.match(this.options.loose?Ir[Nr.PRERELEASELOOSE]:Ir[Nr.PRERELEASE]);if(!n||n[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,s),this.inc("pre",r,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,s),this.inc("pre",r,s);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let i=[r,n];s===!1&&(i=[r]),ai(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Kf.exports=ci});var Re=h((S2,Wf)=>{"use strict";var Yf=q(),Cm=(t,e,r=!1)=>{if(t instanceof Yf)return t;try{return new Yf(t,e)}catch(s){if(!r)return null;throw s}};Wf.exports=Cm});var Jf=h((E2,Xf)=>{"use strict";var _m=Re(),Om=(t,e)=>{let r=_m(t,e);return r?r.version:null};Xf.exports=Om});var eu=h((w2,Zf)=>{"use strict";var Rm=Re(),Tm=(t,e)=>{let r=Rm(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};Zf.exports=Tm});var su=h((k2,ru)=>{"use strict";var tu=q(),Im=(t,e,r,s,n)=>{typeof r=="string"&&(n=s,s=r,r=void 0);try{return new tu(t instanceof tu?t.version:t,r).inc(e,s,n).version}catch{return null}};ru.exports=Im});var ou=h((v2,iu)=>{"use strict";var nu=Re(),Nm=(t,e)=>{let r=nu(t,null,!0),s=nu(e,null,!0),n=r.compare(s);if(n===0)return null;let i=n>0,o=i?r:s,c=i?s:r,a=!!o.prerelease.length;if(!!c.prerelease.length&&!a){if(!c.patch&&!c.minor)return"major";if(c.compareMain(o)===0)return c.minor&&!c.patch?"minor":"patch"}let l=a?"pre":"";return r.major!==s.major?l+"major":r.minor!==s.minor?l+"minor":r.patch!==s.patch?l+"patch":"prerelease"};iu.exports=Nm});var cu=h((A2,au)=>{"use strict";var Mm=q(),Pm=(t,e)=>new Mm(t,e).major;au.exports=Pm});var uu=h((C2,fu)=>{"use strict";var qm=q(),Lm=(t,e)=>new qm(t,e).minor;fu.exports=Lm});var du=h((_2,lu)=>{"use strict";var Dm=q(),Bm=(t,e)=>new Dm(t,e).patch;lu.exports=Bm});var pu=h((O2,hu)=>{"use strict";var jm=Re(),Fm=(t,e)=>{let r=jm(t,e);return r&&r.prerelease.length?r.prerelease:null};hu.exports=Fm});var V=h((R2,gu)=>{"use strict";var yu=q(),$m=(t,e,r)=>new yu(t,r).compare(new yu(e,r));gu.exports=$m});var xu=h((T2,mu)=>{"use strict";var Um=V(),Gm=(t,e,r)=>Um(e,t,r);mu.exports=Gm});var Su=h((I2,bu)=>{"use strict";var Hm=V(),Qm=(t,e)=>Hm(t,e,!0);bu.exports=Qm});var Mr=h((N2,wu)=>{"use strict";var Eu=q(),Vm=(t,e,r)=>{let s=new Eu(t,r),n=new Eu(e,r);return s.compare(n)||s.compareBuild(n)};wu.exports=Vm});var vu=h((M2,ku)=>{"use strict";var zm=Mr(),Km=(t,e)=>t.sort((r,s)=>zm(r,s,e));ku.exports=Km});var Cu=h((P2,Au)=>{"use strict";var Ym=Mr(),Wm=(t,e)=>t.sort((r,s)=>Ym(s,r,e));Au.exports=Wm});var Et=h((q2,_u)=>{"use strict";var Xm=V(),Jm=(t,e,r)=>Xm(t,e,r)>0;_u.exports=Jm});var Pr=h((L2,Ou)=>{"use strict";var Zm=V(),ex=(t,e,r)=>Zm(t,e,r)<0;Ou.exports=ex});var fi=h((D2,Ru)=>{"use strict";var tx=V(),rx=(t,e,r)=>tx(t,e,r)===0;Ru.exports=rx});var ui=h((B2,Tu)=>{"use strict";var sx=V(),nx=(t,e,r)=>sx(t,e,r)!==0;Tu.exports=nx});var qr=h((j2,Iu)=>{"use strict";var ix=V(),ox=(t,e,r)=>ix(t,e,r)>=0;Iu.exports=ox});var Lr=h((F2,Nu)=>{"use strict";var ax=V(),cx=(t,e,r)=>ax(t,e,r)<=0;Nu.exports=cx});var li=h(($2,Mu)=>{"use strict";var fx=fi(),ux=ui(),lx=Et(),dx=qr(),hx=Pr(),px=Lr(),yx=(t,e,r,s)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return fx(t,r,s);case"!=":return ux(t,r,s);case">":return lx(t,r,s);case">=":return dx(t,r,s);case"<":return hx(t,r,s);case"<=":return px(t,r,s);default:throw new TypeError(`Invalid operator: ${e}`)}};Mu.exports=yx});var qu=h((U2,Pu)=>{"use strict";var gx=q(),mx=Re(),{safeRe:Dr,t:Br}=Ye(),xx=(t,e)=>{if(t instanceof gx)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Dr[Br.COERCEFULL]:Dr[Br.COERCE]);else{let a=e.includePrerelease?Dr[Br.COERCERTLFULL]:Dr[Br.COERCERTL],f;for(;(f=a.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||f.index+f[0].length!==r.index+r[0].length)&&(r=f),a.lastIndex=f.index+f[1].length+f[2].length;a.lastIndex=-1}if(r===null)return null;let s=r[2],n=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return mx(`${s}.${n}.${i}${o}${c}`,e)};Pu.exports=xx});var Du=h((G2,Lu)=>{"use strict";var di=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};Lu.exports=di});var z=h((H2,$u)=>{"use strict";var bx=/\s+/g,hi=class t{constructor(e,r){if(r=Ex(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof pi)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(bx," "),this.set=this.raw.split("||").map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let s=this.set[0];if(this.set=this.set.filter(n=>!ju(n[0])),this.set.length===0)this.set=[s];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&Ox(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let s=0;s<r.length;s++)s>0&&(this.formatted+=" "),this.formatted+=r[s].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let s=((this.options.includePrerelease&&Cx)|(this.options.loose&&_x))+":"+e,n=Bu.get(s);if(n)return n;let i=this.options.loose,o=i?B[L.HYPHENRANGELOOSE]:B[L.HYPHENRANGE];e=e.replace(o,Bx(this.options.includePrerelease)),A("hyphen replace",e),e=e.replace(B[L.COMPARATORTRIM],kx),A("comparator trim",e),e=e.replace(B[L.TILDETRIM],vx),A("tilde trim",e),e=e.replace(B[L.CARETTRIM],Ax),A("caret trim",e);let c=e.split(" ").map(u=>Rx(u,this.options)).join(" ").split(/\s+/).map(u=>Dx(u,this.options));i&&(c=c.filter(u=>(A("loose invalid filter",u,this.options),!!u.match(B[L.COMPARATORLOOSE])))),A("range list",c);let a=new Map,f=c.map(u=>new pi(u,this.options));for(let u of f){if(ju(u))return[u];a.set(u.value,u)}a.size>1&&a.has("")&&a.delete("");let l=[...a.values()];return Bu.set(s,l),l}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(s=>Fu(s,r)&&e.set.some(n=>Fu(n,r)&&s.every(i=>n.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new wx(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(jx(this.set[r],e,this.options))return!0;return!1}};$u.exports=hi;var Sx=Du(),Bu=new Sx,Ex=Or(),pi=wt(),A=St(),wx=q(),{safeRe:B,t:L,comparatorTrimReplace:kx,tildeTrimReplace:vx,caretTrimReplace:Ax}=Ye(),{FLAG_INCLUDE_PRERELEASE:Cx,FLAG_LOOSE:_x}=bt(),ju=t=>t.value==="<0.0.0-0",Ox=t=>t.value==="",Fu=(t,e)=>{let r=!0,s=t.slice(),n=s.pop();for(;r&&s.length;)r=s.every(i=>n.intersects(i,e)),n=s.pop();return r},Rx=(t,e)=>(t=t.replace(B[L.BUILD],""),A("comp",t,e),t=Nx(t,e),A("caret",t),t=Tx(t,e),A("tildes",t),t=Px(t,e),A("xrange",t),t=Lx(t,e),A("stars",t),t),j=t=>!t||t.toLowerCase()==="x"||t==="*",Tx=(t,e)=>t.trim().split(/\s+/).map(r=>Ix(r,e)).join(" "),Ix=(t,e)=>{let r=e.loose?B[L.TILDELOOSE]:B[L.TILDE];return t.replace(r,(s,n,i,o,c)=>{A("tilde",t,s,n,i,o,c);let a;return j(n)?a="":j(i)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:j(o)?a=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:c?(A("replaceTilde pr",c),a=`>=${n}.${i}.${o}-${c} <${n}.${+i+1}.0-0`):a=`>=${n}.${i}.${o} <${n}.${+i+1}.0-0`,A("tilde return",a),a})},Nx=(t,e)=>t.trim().split(/\s+/).map(r=>Mx(r,e)).join(" "),Mx=(t,e)=>{A("caret",t,e);let r=e.loose?B[L.CARETLOOSE]:B[L.CARET],s=e.includePrerelease?"-0":"";return t.replace(r,(n,i,o,c,a)=>{A("caret",t,n,i,o,c,a);let f;return j(i)?f="":j(o)?f=`>=${i}.0.0${s} <${+i+1}.0.0-0`:j(c)?i==="0"?f=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`:f=`>=${i}.${o}.0${s} <${+i+1}.0.0-0`:a?(A("replaceCaret pr",a),i==="0"?o==="0"?f=`>=${i}.${o}.${c}-${a} <${i}.${o}.${+c+1}-0`:f=`>=${i}.${o}.${c}-${a} <${i}.${+o+1}.0-0`:f=`>=${i}.${o}.${c}-${a} <${+i+1}.0.0-0`):(A("no pr"),i==="0"?o==="0"?f=`>=${i}.${o}.${c}${s} <${i}.${o}.${+c+1}-0`:f=`>=${i}.${o}.${c}${s} <${i}.${+o+1}.0-0`:f=`>=${i}.${o}.${c} <${+i+1}.0.0-0`),A("caret return",f),f})},Px=(t,e)=>(A("replaceXRanges",t,e),t.split(/\s+/).map(r=>qx(r,e)).join(" ")),qx=(t,e)=>{t=t.trim();let r=e.loose?B[L.XRANGELOOSE]:B[L.XRANGE];return t.replace(r,(s,n,i,o,c,a)=>{A("xRange",t,s,n,i,o,c,a);let f=j(i),l=f||j(o),u=l||j(c),p=u;return n==="="&&p&&(n=""),a=e.includePrerelease?"-0":"",f?n===">"||n==="<"?s="<0.0.0-0":s="*":n&&p?(l&&(o=0),c=0,n===">"?(n=">=",l?(i=+i+1,o=0,c=0):(o=+o+1,c=0)):n==="<="&&(n="<",l?i=+i+1:o=+o+1),n==="<"&&(a="-0"),s=`${n+i}.${o}.${c}${a}`):l?s=`>=${i}.0.0${a} <${+i+1}.0.0-0`:u&&(s=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`),A("xRange return",s),s})},Lx=(t,e)=>(A("replaceStars",t,e),t.trim().replace(B[L.STAR],"")),Dx=(t,e)=>(A("replaceGTE0",t,e),t.trim().replace(B[e.includePrerelease?L.GTE0PRE:L.GTE0],"")),Bx=t=>(e,r,s,n,i,o,c,a,f,l,u,p)=>(j(s)?r="":j(n)?r=`>=${s}.0.0${t?"-0":""}`:j(i)?r=`>=${s}.${n}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,j(f)?a="":j(l)?a=`<${+f+1}.0.0-0`:j(u)?a=`<${f}.${+l+1}.0-0`:p?a=`<=${f}.${l}.${u}-${p}`:t?a=`<${f}.${l}.${+u+1}-0`:a=`<=${a}`,`${r} ${a}`.trim()),jx=(t,e,r)=>{for(let s=0;s<t.length;s++)if(!t[s].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let s=0;s<t.length;s++)if(A(t[s].semver),t[s].semver!==pi.ANY&&t[s].semver.prerelease.length>0){let n=t[s].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var wt=h((Q2,zu)=>{"use strict";var kt=Symbol("SemVer ANY"),mi=class t{static get ANY(){return kt}constructor(e,r){if(r=Uu(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),gi("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===kt?this.value="":this.value=this.operator+this.semver.version,gi("comp",this)}parse(e){let r=this.options.loose?Gu[Hu.COMPARATORLOOSE]:Gu[Hu.COMPARATOR],s=e.match(r);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=s[1]!==void 0?s[1]:"",this.operator==="="&&(this.operator=""),s[2]?this.semver=new Qu(s[2],this.options.loose):this.semver=kt}toString(){return this.value}test(e){if(gi("Comparator.test",e,this.options.loose),this.semver===kt||e===kt)return!0;if(typeof e=="string")try{e=new Qu(e,this.options)}catch{return!1}return yi(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Vu(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new Vu(this.value,r).test(e.semver):(r=Uu(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||yi(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||yi(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};zu.exports=mi;var Uu=Or(),{safeRe:Gu,t:Hu}=Ye(),yi=li(),gi=St(),Qu=q(),Vu=z()});var vt=h((V2,Ku)=>{"use strict";var Fx=z(),$x=(t,e,r)=>{try{e=new Fx(e,r)}catch{return!1}return e.test(t)};Ku.exports=$x});var Wu=h((z2,Yu)=>{"use strict";var Ux=z(),Gx=(t,e)=>new Ux(t,e).set.map(r=>r.map(s=>s.value).join(" ").trim().split(" "));Yu.exports=Gx});var Ju=h((K2,Xu)=>{"use strict";var Hx=q(),Qx=z(),Vx=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Qx(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===-1)&&(s=o,n=new Hx(s,r))}),s};Xu.exports=Vx});var el=h((Y2,Zu)=>{"use strict";var zx=q(),Kx=z(),Yx=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Kx(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===1)&&(s=o,n=new zx(s,r))}),s};Zu.exports=Yx});var sl=h((W2,rl)=>{"use strict";var xi=q(),Wx=z(),tl=Et(),Xx=(t,e)=>{t=new Wx(t,e);let r=new xi("0.0.0");if(t.test(r)||(r=new xi("0.0.0-0"),t.test(r)))return r;r=null;for(let s=0;s<t.set.length;++s){let n=t.set[s],i=null;n.forEach(o=>{let c=new xi(o.semver.version);switch(o.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!i||tl(c,i))&&(i=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||tl(r,i))&&(r=i)}return r&&t.test(r)?r:null};rl.exports=Xx});var il=h((X2,nl)=>{"use strict";var Jx=z(),Zx=(t,e)=>{try{return new Jx(t,e).range||"*"}catch{return null}};nl.exports=Zx});var jr=h((J2,fl)=>{"use strict";var eb=q(),cl=wt(),{ANY:tb}=cl,rb=z(),sb=vt(),ol=Et(),al=Pr(),nb=Lr(),ib=qr(),ob=(t,e,r,s)=>{t=new eb(t,s),e=new rb(e,s);let n,i,o,c,a;switch(r){case">":n=ol,i=nb,o=al,c=">",a=">=";break;case"<":n=al,i=ib,o=ol,c="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(sb(t,e,s))return!1;for(let f=0;f<e.set.length;++f){let l=e.set[f],u=null,p=null;if(l.forEach(d=>{d.semver===tb&&(d=new cl(">=0.0.0")),u=u||d,p=p||d,n(d.semver,u.semver,s)?u=d:o(d.semver,p.semver,s)&&(p=d)}),u.operator===c||u.operator===a||(!p.operator||p.operator===c)&&i(t,p.semver))return!1;if(p.operator===a&&o(t,p.semver))return!1}return!0};fl.exports=ob});var ll=h((Z2,ul)=>{"use strict";var ab=jr(),cb=(t,e,r)=>ab(t,e,">",r);ul.exports=cb});var hl=h((ek,dl)=>{"use strict";var fb=jr(),ub=(t,e,r)=>fb(t,e,"<",r);dl.exports=ub});var gl=h((tk,yl)=>{"use strict";var pl=z(),lb=(t,e,r)=>(t=new pl(t,r),e=new pl(e,r),t.intersects(e,r));yl.exports=lb});var xl=h((rk,ml)=>{"use strict";var db=vt(),hb=V();ml.exports=(t,e,r)=>{let s=[],n=null,i=null,o=t.sort((l,u)=>hb(l,u,r));for(let l of o)db(l,e,r)?(i=l,n||(n=l)):(i&&s.push([n,i]),i=null,n=null);n&&s.push([n,null]);let c=[];for(let[l,u]of s)l===u?c.push(l):!u&&l===o[0]?c.push("*"):u?l===o[0]?c.push(`<=${u}`):c.push(`${l} - ${u}`):c.push(`>=${l}`);let a=c.join(" || "),f=typeof e.raw=="string"?e.raw:String(e);return a.length<f.length?a:e}});var vl=h((sk,kl)=>{"use strict";var bl=z(),Si=wt(),{ANY:bi}=Si,At=vt(),Ei=V(),pb=(t,e,r={})=>{if(t===e)return!0;t=new bl(t,r),e=new bl(e,r);let s=!1;e:for(let n of t.set){for(let i of e.set){let o=gb(n,i,r);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},yb=[new Si(">=0.0.0-0")],Sl=[new Si(">=0.0.0")],gb=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===bi){if(e.length===1&&e[0].semver===bi)return!0;r.includePrerelease?t=yb:t=Sl}if(e.length===1&&e[0].semver===bi){if(r.includePrerelease)return!0;e=Sl}let s=new Set,n,i;for(let d of t)d.operator===">"||d.operator===">="?n=El(n,d,r):d.operator==="<"||d.operator==="<="?i=wl(i,d,r):s.add(d.semver);if(s.size>1)return null;let o;if(n&&i){if(o=Ei(n.semver,i.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||i.operator!=="<="))return null}for(let d of s){if(n&&!At(d,String(n),r)||i&&!At(d,String(i),r))return null;for(let x of e)if(!At(d,String(x),r))return!1;return!0}let c,a,f,l,u=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,p=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;u&&u.prerelease.length===1&&i.operator==="<"&&u.prerelease[0]===0&&(u=!1);for(let d of e){if(l=l||d.operator===">"||d.operator===">=",f=f||d.operator==="<"||d.operator==="<=",n){if(p&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===p.major&&d.semver.minor===p.minor&&d.semver.patch===p.patch&&(p=!1),d.operator===">"||d.operator===">="){if(c=El(n,d,r),c===d&&c!==n)return!1}else if(n.operator===">="&&!At(n.semver,String(d),r))return!1}if(i){if(u&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===u.major&&d.semver.minor===u.minor&&d.semver.patch===u.patch&&(u=!1),d.operator==="<"||d.operator==="<="){if(a=wl(i,d,r),a===d&&a!==i)return!1}else if(i.operator==="<="&&!At(i.semver,String(d),r))return!1}if(!d.operator&&(i||n)&&o!==0)return!1}return!(n&&f&&!i&&o!==0||i&&l&&!n&&o!==0||p||u)},El=(t,e,r)=>{if(!t)return e;let s=Ei(t.semver,e.semver,r);return s>0?t:s<0||e.operator===">"&&t.operator===">="?e:t},wl=(t,e,r)=>{if(!t)return e;let s=Ei(t.semver,e.semver,r);return s<0?t:s>0||e.operator==="<"&&t.operator==="<="?e:t};kl.exports=pb});var Fr=h((nk,_l)=>{"use strict";var wi=Ye(),Al=bt(),mb=q(),Cl=oi(),xb=Re(),bb=Jf(),Sb=eu(),Eb=su(),wb=ou(),kb=cu(),vb=uu(),Ab=du(),Cb=pu(),_b=V(),Ob=xu(),Rb=Su(),Tb=Mr(),Ib=vu(),Nb=Cu(),Mb=Et(),Pb=Pr(),qb=fi(),Lb=ui(),Db=qr(),Bb=Lr(),jb=li(),Fb=qu(),$b=wt(),Ub=z(),Gb=vt(),Hb=Wu(),Qb=Ju(),Vb=el(),zb=sl(),Kb=il(),Yb=jr(),Wb=ll(),Xb=hl(),Jb=gl(),Zb=xl(),e1=vl();_l.exports={parse:xb,valid:bb,clean:Sb,inc:Eb,diff:wb,major:kb,minor:vb,patch:Ab,prerelease:Cb,compare:_b,rcompare:Ob,compareLoose:Rb,compareBuild:Tb,sort:Ib,rsort:Nb,gt:Mb,lt:Pb,eq:qb,neq:Lb,gte:Db,lte:Bb,cmp:jb,coerce:Fb,Comparator:$b,Range:Ub,satisfies:Gb,toComparators:Hb,maxSatisfying:Qb,minSatisfying:Vb,minVersion:zb,validRange:Kb,outside:Yb,gtr:Wb,ltr:Xb,intersects:Jb,simplifyRange:Zb,subset:e1,SemVer:mb,re:wi.re,src:wi.src,tokens:wi.t,SEMVER_SPEC_VERSION:Al.SEMVER_SPEC_VERSION,RELEASE_TYPES:Al.RELEASE_TYPES,compareIdentifiers:Cl.compareIdentifiers,rcompareIdentifiers:Cl.rcompareIdentifiers}});var Rl=h((ik,Ol)=>{var t1=Fr();Ol.exports=t1.satisfies(process.version,">=15.7.0")});var Il=h((ok,Tl)=>{var r1=Fr();Tl.exports=r1.satisfies(process.version,">=16.9.0")});var ki=h((ak,Nl)=>{var s1=Rl(),n1=Il(),i1={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},o1={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Nl.exports=function(t,e){if(!t||!e)return;let r=e.asymmetricKeyType;if(!r)return;let s=i1[r];if(!s)throw new Error(`Unknown key type "${r}".`);if(!s.includes(t))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${s.join(", ")}.`);if(s1)switch(r){case"ec":let n=e.asymmetricKeyDetails.namedCurve,i=o1[t];if(n!==i)throw new Error(`"alg" parameter "${t}" requires curve "${i}".`);break;case"rsa-pss":if(n1){let o=parseInt(t.slice(-3),10),{hashAlgorithm:c,mgf1HashAlgorithm:a,saltLength:f}=e.asymmetricKeyDetails;if(c!==`sha${o}`||a!==c)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}.`);if(f!==void 0&&f>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}.`)}break}}});var vi=h((ck,Ml)=>{var a1=Fr();Ml.exports=a1.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Ll=h((fk,ql)=>{var v=xt(),c1=ti(),Pl=ri(),f1=ei(),u1=si(),l1=ki(),d1=vi(),h1=vr(),{KeyObject:p1,createSecretKey:y1,createPublicKey:g1}=require("crypto"),Ai=["RS256","RS384","RS512"],m1=["ES256","ES384","ES512"],Ci=["RS256","RS384","RS512"],x1=["HS256","HS384","HS512"];d1&&(Ai.splice(Ai.length,0,"PS256","PS384","PS512"),Ci.splice(Ci.length,0,"PS256","PS384","PS512"));ql.exports=function(t,e,r,s){typeof r=="function"&&!s&&(s=r,r={}),r||(r={}),r=Object.assign({},r);let n;if(s?n=s:n=function(l,u){if(l)throw l;return u},r.clockTimestamp&&typeof r.clockTimestamp!="number")return n(new v("clockTimestamp must be a number"));if(r.nonce!==void 0&&(typeof r.nonce!="string"||r.nonce.trim()===""))return n(new v("nonce must be a non-empty string"));if(r.allowInvalidAsymmetricKeyTypes!==void 0&&typeof r.allowInvalidAsymmetricKeyTypes!="boolean")return n(new v("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!t)return n(new v("jwt must be provided"));if(typeof t!="string")return n(new v("jwt must be a string"));let o=t.split(".");if(o.length!==3)return n(new v("jwt malformed"));let c;try{c=f1(t,{complete:!0})}catch(l){return n(l)}if(!c)return n(new v("invalid token"));let a=c.header,f;if(typeof e=="function"){if(!s)return n(new v("verify must be called asynchronous if secret or public key is provided as a callback"));f=e}else f=function(l,u){return u(null,e)};return f(a,function(l,u){if(l)return n(new v("error in secret or public key callback: "+l.message));let p=o[2].trim()!=="";if(!p&&u)return n(new v("jwt signature is required"));if(p&&!u)return n(new v("secret or public key must be provided"));if(!p&&!r.algorithms)return n(new v('please specify "none" in "algorithms" to verify unsigned tokens'));if(u!=null&&!(u instanceof p1))try{u=g1(u)}catch{try{u=y1(typeof u=="string"?Buffer.from(u):u)}catch{return n(new v("secretOrPublicKey is not valid key material"))}}if(r.algorithms||(u.type==="secret"?r.algorithms=x1:["rsa","rsa-pss"].includes(u.asymmetricKeyType)?r.algorithms=Ci:u.asymmetricKeyType==="ec"?r.algorithms=m1:r.algorithms=Ai),r.algorithms.indexOf(c.header.alg)===-1)return n(new v("invalid algorithm"));if(a.alg.startsWith("HS")&&u.type!=="secret")return n(new v(`secretOrPublicKey must be a symmetric key when using ${a.alg}`));if(/^(?:RS|PS|ES)/.test(a.alg)&&u.type!=="public")return n(new v(`secretOrPublicKey must be an asymmetric key when using ${a.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{l1(a.alg,u)}catch(b){return n(b)}let d;try{d=h1.verify(t,c.header.alg,u)}catch(b){return n(b)}if(!d)return n(new v("invalid signature"));let x=c.payload;if(typeof x.nbf<"u"&&!r.ignoreNotBefore){if(typeof x.nbf!="number")return n(new v("invalid nbf value"));if(x.nbf>i+(r.clockTolerance||0))return n(new c1("jwt not active",new Date(x.nbf*1e3)))}if(typeof x.exp<"u"&&!r.ignoreExpiration){if(typeof x.exp!="number")return n(new v("invalid exp value"));if(i>=x.exp+(r.clockTolerance||0))return n(new Pl("jwt expired",new Date(x.exp*1e3)))}if(r.audience){let b=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(x.aud)?x.aud:[x.aud]).some(function(we){return b.some(function(Je){return Je instanceof RegExp?Je.test(we):Je===we})}))return n(new v("jwt audience invalid. expected: "+b.join(" or ")))}if(r.issuer&&(typeof r.issuer=="string"&&x.iss!==r.issuer||Array.isArray(r.issuer)&&r.issuer.indexOf(x.iss)===-1))return n(new v("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&x.sub!==r.subject)return n(new v("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&x.jti!==r.jwtid)return n(new v("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&x.nonce!==r.nonce)return n(new v("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if(typeof x.iat!="number")return n(new v("iat required when maxAge is specified"));let b=u1(r.maxAge,x.iat);if(typeof b>"u")return n(new v('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=b+(r.clockTolerance||0))return n(new Pl("maxAge exceeded",new Date(b*1e3)))}if(r.complete===!0){let b=c.signature;return n(null,{header:a,payload:x,signature:b})}return n(null,x)})}});var Ul=h((uk,$l)=>{var Dl=1/0,jl=9007199254740991,b1=17976931348623157e292,Bl=NaN,S1="[object Arguments]",E1="[object Function]",w1="[object GeneratorFunction]",k1="[object String]",v1="[object Symbol]",A1=/^\s+|\s+$/g,C1=/^[-+]0x[0-9a-f]+$/i,_1=/^0b[01]+$/i,O1=/^0o[0-7]+$/i,R1=/^(?:0|[1-9]\d*)$/,T1=parseInt;function I1(t,e){for(var r=-1,s=t?t.length:0,n=Array(s);++r<s;)n[r]=e(t[r],r,t);return n}function N1(t,e,r,s){for(var n=t.length,i=r+(s?1:-1);s?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function M1(t,e,r){if(e!==e)return N1(t,P1,r);for(var s=r-1,n=t.length;++s<n;)if(t[s]===e)return s;return-1}function P1(t){return t!==t}function q1(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}function L1(t,e){return I1(e,function(r){return t[r]})}function D1(t,e){return function(r){return t(e(r))}}var $r=Object.prototype,Oi=$r.hasOwnProperty,Ur=$r.toString,B1=$r.propertyIsEnumerable,j1=D1(Object.keys,Object),F1=Math.max;function $1(t,e){var r=Fl(t)||V1(t)?q1(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||Oi.call(t,i))&&!(n&&(i=="length"||G1(i,s)))&&r.push(i);return r}function U1(t){if(!H1(t))return j1(t);var e=[];for(var r in Object(t))Oi.call(t,r)&&r!="constructor"&&e.push(r);return e}function G1(t,e){return e=e??jl,!!e&&(typeof t=="number"||R1.test(t))&&t>-1&&t%1==0&&t<e}function H1(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||$r;return t===r}function Q1(t,e,r,s){t=Ri(t)?t:rS(t),r=r&&!s?Z1(r):0;var n=t.length;return r<0&&(r=F1(n+r,0)),W1(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&M1(t,e,r)>-1}function V1(t){return z1(t)&&Oi.call(t,"callee")&&(!B1.call(t,"callee")||Ur.call(t)==S1)}var Fl=Array.isArray;function Ri(t){return t!=null&&Y1(t.length)&&!K1(t)}function z1(t){return Ti(t)&&Ri(t)}function K1(t){var e=_i(t)?Ur.call(t):"";return e==E1||e==w1}function Y1(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=jl}function _i(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Ti(t){return!!t&&typeof t=="object"}function W1(t){return typeof t=="string"||!Fl(t)&&Ti(t)&&Ur.call(t)==k1}function X1(t){return typeof t=="symbol"||Ti(t)&&Ur.call(t)==v1}function J1(t){if(!t)return t===0?t:0;if(t=eS(t),t===Dl||t===-Dl){var e=t<0?-1:1;return e*b1}return t===t?t:0}function Z1(t){var e=J1(t),r=e%1;return e===e?r?e-r:e:0}function eS(t){if(typeof t=="number")return t;if(X1(t))return Bl;if(_i(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=_i(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(A1,"");var r=_1.test(t);return r||O1.test(t)?T1(t.slice(2),r?2:8):C1.test(t)?Bl:+t}function tS(t){return Ri(t)?$1(t):U1(t)}function rS(t){return t?L1(t,tS(t)):[]}$l.exports=Q1});var Hl=h((lk,Gl)=>{var sS="[object Boolean]",nS=Object.prototype,iS=nS.toString;function oS(t){return t===!0||t===!1||aS(t)&&iS.call(t)==sS}function aS(t){return!!t&&typeof t=="object"}Gl.exports=oS});var Yl=h((dk,Kl)=>{var Ql=1/0,cS=17976931348623157e292,Vl=NaN,fS="[object Symbol]",uS=/^\s+|\s+$/g,lS=/^[-+]0x[0-9a-f]+$/i,dS=/^0b[01]+$/i,hS=/^0o[0-7]+$/i,pS=parseInt,yS=Object.prototype,gS=yS.toString;function mS(t){return typeof t=="number"&&t==ES(t)}function zl(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function xS(t){return!!t&&typeof t=="object"}function bS(t){return typeof t=="symbol"||xS(t)&&gS.call(t)==fS}function SS(t){if(!t)return t===0?t:0;if(t=wS(t),t===Ql||t===-Ql){var e=t<0?-1:1;return e*cS}return t===t?t:0}function ES(t){var e=SS(t),r=e%1;return e===e?r?e-r:e:0}function wS(t){if(typeof t=="number")return t;if(bS(t))return Vl;if(zl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=zl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(uS,"");var r=dS.test(t);return r||hS.test(t)?pS(t.slice(2),r?2:8):lS.test(t)?Vl:+t}Kl.exports=mS});var Xl=h((hk,Wl)=>{var kS="[object Number]",vS=Object.prototype,AS=vS.toString;function CS(t){return!!t&&typeof t=="object"}function _S(t){return typeof t=="number"||CS(t)&&AS.call(t)==kS}Wl.exports=_S});var t0=h((pk,e0)=>{var OS="[object Object]";function RS(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function TS(t,e){return function(r){return t(e(r))}}var IS=Function.prototype,Jl=Object.prototype,Zl=IS.toString,NS=Jl.hasOwnProperty,MS=Zl.call(Object),PS=Jl.toString,qS=TS(Object.getPrototypeOf,Object);function LS(t){return!!t&&typeof t=="object"}function DS(t){if(!LS(t)||PS.call(t)!=OS||RS(t))return!1;var e=qS(t);if(e===null)return!0;var r=NS.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Zl.call(r)==MS}e0.exports=DS});var s0=h((yk,r0)=>{var BS="[object String]",jS=Object.prototype,FS=jS.toString,$S=Array.isArray;function US(t){return!!t&&typeof t=="object"}function GS(t){return typeof t=="string"||!$S(t)&&US(t)&&FS.call(t)==BS}r0.exports=GS});var c0=h((gk,a0)=>{var HS="Expected a function",n0=1/0,QS=17976931348623157e292,i0=NaN,VS="[object Symbol]",zS=/^\s+|\s+$/g,KS=/^[-+]0x[0-9a-f]+$/i,YS=/^0b[01]+$/i,WS=/^0o[0-7]+$/i,XS=parseInt,JS=Object.prototype,ZS=JS.toString;function eE(t,e){var r;if(typeof e!="function")throw new TypeError(HS);return t=iE(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}function tE(t){return eE(2,t)}function o0(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function rE(t){return!!t&&typeof t=="object"}function sE(t){return typeof t=="symbol"||rE(t)&&ZS.call(t)==VS}function nE(t){if(!t)return t===0?t:0;if(t=oE(t),t===n0||t===-n0){var e=t<0?-1:1;return e*QS}return t===t?t:0}function iE(t){var e=nE(t),r=e%1;return e===e?r?e-r:e:0}function oE(t){if(typeof t=="number")return t;if(sE(t))return i0;if(o0(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=o0(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(zS,"");var r=YS.test(t);return r||WS.test(t)?XS(t.slice(2),r?2:8):KS.test(t)?i0:+t}a0.exports=tE});var m0=h((mk,g0)=>{var f0=si(),aE=vi(),cE=ki(),u0=vr(),fE=Ul(),Gr=Hl(),l0=Yl(),Ii=Xl(),h0=t0(),Ee=s0(),uE=c0(),{KeyObject:lE,createSecretKey:dE,createPrivateKey:hE}=require("crypto"),p0=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];aE&&p0.splice(3,0,"PS256","PS384","PS512");var pE={expiresIn:{isValid:function(t){return l0(t)||Ee(t)&&t},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(t){return l0(t)||Ee(t)&&t},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(t){return Ee(t)||Array.isArray(t)},message:'"audience" must be a string or array'},algorithm:{isValid:fE.bind(null,p0),message:'"algorithm" must be a valid string enum value'},header:{isValid:h0,message:'"header" must be an object'},encoding:{isValid:Ee,message:'"encoding" must be a string'},issuer:{isValid:Ee,message:'"issuer" must be a string'},subject:{isValid:Ee,message:'"subject" must be a string'},jwtid:{isValid:Ee,message:'"jwtid" must be a string'},noTimestamp:{isValid:Gr,message:'"noTimestamp" must be a boolean'},keyid:{isValid:Ee,message:'"keyid" must be a string'},mutatePayload:{isValid:Gr,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Gr,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Gr,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},yE={iat:{isValid:Ii,message:'"iat" should be a number of seconds'},exp:{isValid:Ii,message:'"exp" should be a number of seconds'},nbf:{isValid:Ii,message:'"nbf" should be a number of seconds'}};function y0(t,e,r,s){if(!h0(r))throw new Error('Expected "'+s+'" to be a plain object.');Object.keys(r).forEach(function(n){let i=t[n];if(!i){if(!e)throw new Error('"'+n+'" is not allowed in "'+s+'"');return}if(!i.isValid(r[n]))throw new Error(i.message)})}function gE(t){return y0(pE,!1,t,"options")}function mE(t){return y0(yE,!0,t,"payload")}var d0={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},xE=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];g0.exports=function(t,e,r,s){typeof r=="function"?(s=r,r={}):r=r||{};let n=typeof t=="object"&&!Buffer.isBuffer(t),i=Object.assign({alg:r.algorithm||"HS256",typ:n?"JWT":void 0,kid:r.keyid},r.header);function o(f){if(s)return s(f);throw f}if(!e&&r.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof lE))try{e=hE(e)}catch{try{e=dE(typeof e=="string"?Buffer.from(e):e)}catch{return o(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof t>"u")return o(new Error("payload is required"));if(n){try{mE(t)}catch(f){return o(f)}r.mutatePayload||(t=Object.assign({},t))}else{let f=xE.filter(function(l){return typeof r[l]<"u"});if(f.length>0)return o(new Error("invalid "+f.join(",")+" option for "+typeof t+" payload"))}if(typeof t.exp<"u"&&typeof r.expiresIn<"u")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof t.nbf<"u"&&typeof r.notBefore<"u")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{gE(r)}catch(f){return o(f)}if(!r.allowInvalidAsymmetricKeyTypes)try{cE(i.alg,e)}catch(f){return o(f)}let c=t.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete t.iat:n&&(t.iat=c),typeof r.notBefore<"u"){try{t.nbf=f0(r.notBefore,c)}catch(f){return o(f)}if(typeof t.nbf>"u")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof r.expiresIn<"u"&&typeof t=="object"){try{t.exp=f0(r.expiresIn,c)}catch(f){return o(f)}if(typeof t.exp>"u")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(d0).forEach(function(f){let l=d0[f];if(typeof r[f]<"u"){if(typeof t[l]<"u")return o(new Error('Bad "options.'+f+'" option. The payload already has an "'+l+'" property.'));t[l]=r[f]}});let a=r.encoding||"utf8";if(typeof s=="function")s=s&&uE(s),u0.createSign({header:i,privateKey:e,payload:t,encoding:a}).once("error",s).once("done",function(f){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&f.length<256)return s(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));s(null,f)});else{let f=u0.sign({header:i,payload:t,secret:e,encoding:a});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&f.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return f}}});var b0=h((xk,x0)=>{x0.exports={decode:ei(),verify:Ll(),sign:m0(),JsonWebTokenError:xt(),NotBeforeError:ti(),TokenExpiredError:ri()}});var DE={};q0(DE,{disable2FA:()=>ME,enable2FA:()=>A0,enable2fa:()=>PE,getUserFromEvent:()=>LE,login:()=>AE,logout:()=>RE,me:()=>_E,refresh:()=>OE,register:()=>CE,resendVerification:()=>IE,setup2FA:()=>NE,verify2FA:()=>C0,verify2fa:()=>qE,verifyEmail:()=>TE});module.exports=ji(DE);var Qi=ke(Hi(),1),zr;function se(){return zr||(zr=new Qi.PrismaClient),zr}var W0=process.env.FRONTEND_URL||"http://localhost:5173",X0=process.env.NODE_ENV||"development",Vi=X0==="production",J0=()=>{let t=[W0];return Vi&&t.push("https://dkmxy676d3vgc.cloudfront.net"),Vi||t.push("http://localhost:3000","http://localhost:5173"),t},Kr=t=>{let e=J0(),r=t?.headers?.origin||t?.headers?.Origin||"";return{"Access-Control-Allow-Origin":e.includes(r)?r:e[0],"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,PATCH,OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization,X-CSRF-Token","Access-Control-Max-Age":"86400"}};function Z0(t,e=200,r={}){let s=Kr(r.event);return delete r.event,{statusCode:e,headers:{"content-type":"application/json",...s,"x-content-type-options":"nosniff","referrer-policy":"strict-origin-when-cross-origin","permissions-policy":"camera=(), microphone=(), geolocation=()","strict-transport-security":"max-age=63072000; includeSubDomains; preload",...r},body:JSON.stringify(t)}}function S(t,e=400,r={}){return Z0({error:t},e,r)}var Xi=ke(require("crypto"),1),Yr=null;function ed(t){try{return crypto.getRandomValues(new Uint8Array(t))}catch{}try{return Xi.default.randomBytes(t)}catch{}if(!Yr)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return Yr(t)}function td(t){Yr=t}function Xr(t,e){if(t=t||Jr,typeof t!="number")throw Error("Illegal arguments: "+typeof t+", "+typeof e);t<4?t=4:t>31&&(t=31);var r=[];return r.push("$2b$"),t<10&&r.push("0"),r.push(t.toString()),r.push("$"),r.push(Rt(ed(Ze),Ze)),r.join("")}function Ji(t,e,r){if(typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),typeof t>"u")t=Jr;else if(typeof t!="number")throw Error("illegal arguments: "+typeof t);function s(n){K(function(){try{n(null,Xr(t))}catch(i){n(i)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(n,i){s(function(o,c){if(o){i(o);return}n(c)})})}function Zi(t,e){if(typeof e>"u"&&(e=Jr),typeof e=="number"&&(e=Xr(e)),typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return Wr(t,e)}function eo(t,e,r,s){function n(i){typeof t=="string"&&typeof e=="number"?Ji(e,function(o,c){Wr(t,c,i,s)}):typeof t=="string"&&typeof e=="string"?Wr(t,e,i,s):K(i.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(i,o){n(function(c,a){if(c){o(c);return}i(a)})})}function to(t,e){for(var r=t.length^e.length,s=0;s<t.length;++s)r|=t.charCodeAt(s)^e.charCodeAt(s);return r===0}function rd(t,e){if(typeof t!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof t+", "+typeof e);return e.length!==60?!1:to(Zi(t,e.substring(0,e.length-31)),e)}function sd(t,e,r,s){function n(i){if(typeof t!="string"||typeof e!="string"){K(i.bind(this,Error("Illegal arguments: "+typeof t+", "+typeof e)));return}if(e.length!==60){K(i.bind(this,null,!1));return}eo(t,e.substring(0,29),function(o,c){o?i(o):i(null,to(c,e))},s)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(i,o){n(function(c,a){if(c){o(c);return}i(a)})})}function nd(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return parseInt(t.split("$")[2],10)}function id(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);if(t.length!==60)throw Error("Illegal hash length: "+t.length+" != 60");return t.substring(0,29)}function od(t){if(typeof t!="string")throw Error("Illegal arguments: "+typeof t);return ro(t)>72}var K=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;function ro(t){for(var e=0,r=0,s=0;s<t.length;++s)r=t.charCodeAt(s),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(s+1)&64512)===56320?(++s,e+=4):e+=3;return e}function ad(t){for(var e=0,r,s,n=new Array(ro(t)),i=0,o=t.length;i<o;++i)r=t.charCodeAt(i),r<128?n[e++]=r:r<2048?(n[e++]=r>>6|192,n[e++]=r&63|128):(r&64512)===55296&&((s=t.charCodeAt(i+1))&64512)===56320?(r=65536+((r&1023)<<10)+(s&1023),++i,n[e++]=r>>18|240,n[e++]=r>>12&63|128,n[e++]=r>>6&63|128,n[e++]=r&63|128):(n[e++]=r>>12|224,n[e++]=r>>6&63|128,n[e++]=r&63|128);return n}var Ie="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),ce=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function Rt(t,e){var r=0,s=[],n,i;if(e<=0||e>t.length)throw Error("Illegal len: "+e);for(;r<e;){if(n=t[r++]&255,s.push(Ie[n>>2&63]),n=(n&3)<<4,r>=e){s.push(Ie[n&63]);break}if(i=t[r++]&255,n|=i>>4&15,s.push(Ie[n&63]),n=(i&15)<<2,r>=e){s.push(Ie[n&63]);break}i=t[r++]&255,n|=i>>6&3,s.push(Ie[n&63]),s.push(Ie[i&63])}return s.join("")}function so(t,e){var r=0,s=t.length,n=0,i=[],o,c,a,f,l,u;if(e<=0)throw Error("Illegal len: "+e);for(;r<s-1&&n<e&&(u=t.charCodeAt(r++),o=u<ce.length?ce[u]:-1,u=t.charCodeAt(r++),c=u<ce.length?ce[u]:-1,!(o==-1||c==-1||(l=o<<2>>>0,l|=(c&48)>>4,i.push(String.fromCharCode(l)),++n>=e||r>=s)||(u=t.charCodeAt(r++),a=u<ce.length?ce[u]:-1,a==-1)||(l=(c&15)<<4>>>0,l|=(a&60)>>2,i.push(String.fromCharCode(l)),++n>=e||r>=s)));)u=t.charCodeAt(r++),f=u<ce.length?ce[u]:-1,l=(a&3)<<6>>>0,l|=f,i.push(String.fromCharCode(l)),++n;var p=[];for(r=0;r<n;r++)p.push(i[r].charCodeAt(0));return p}var Ze=16,Jr=10,cd=16,fd=100,zi=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Ki=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],no=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function et(t,e,r,s){var n,i=t[e],o=t[e+1];return i^=r[0],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[1],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[2],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[3],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[4],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[5],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[6],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[7],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[8],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[9],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[10],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[11],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[12],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[13],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[14],n=s[i>>>24],n+=s[256|i>>16&255],n^=s[512|i>>8&255],n+=s[768|i&255],o^=n^r[15],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],i^=n^r[16],t[e]=o^r[cd+1],t[e+1]=i,t}function Ne(t,e){for(var r=0,s=0;r<4;++r)s=s<<8|t[e]&255,e=(e+1)%t.length;return{key:s,offp:e}}function Yi(t,e,r){for(var s=0,n=[0,0],i=e.length,o=r.length,c,a=0;a<i;a++)c=Ne(t,s),s=c.offp,e[a]=e[a]^c.key;for(a=0;a<i;a+=2)n=et(n,0,e,r),e[a]=n[0],e[a+1]=n[1];for(a=0;a<o;a+=2)n=et(n,0,e,r),r[a]=n[0],r[a+1]=n[1]}function ud(t,e,r,s){for(var n=0,i=[0,0],o=r.length,c=s.length,a,f=0;f<o;f++)a=Ne(e,n),n=a.offp,r[f]=r[f]^a.key;for(n=0,f=0;f<o;f+=2)a=Ne(t,n),n=a.offp,i[0]^=a.key,a=Ne(t,n),n=a.offp,i[1]^=a.key,i=et(i,0,r,s),r[f]=i[0],r[f+1]=i[1];for(f=0;f<c;f+=2)a=Ne(t,n),n=a.offp,i[0]^=a.key,a=Ne(t,n),n=a.offp,i[1]^=a.key,i=et(i,0,r,s),s[f]=i[0],s[f+1]=i[1]}function Wi(t,e,r,s,n){var i=no.slice(),o=i.length,c;if(r<4||r>31)if(c=Error("Illegal number of rounds (4-31): "+r),s){K(s.bind(this,c));return}else throw c;if(e.length!==Ze)if(c=Error("Illegal salt length: "+e.length+" != "+Ze),s){K(s.bind(this,c));return}else throw c;r=1<<r>>>0;var a,f,l=0,u;typeof Int32Array=="function"?(a=new Int32Array(zi),f=new Int32Array(Ki)):(a=zi.slice(),f=Ki.slice()),ud(e,t,a,f);function p(){if(n&&n(l/r),l<r)for(var x=Date.now();l<r&&(l=l+1,Yi(t,a,f),Yi(e,a,f),!(Date.now()-x>fd)););else{for(l=0;l<64;l++)for(u=0;u<o>>1;u++)et(i,u<<1,a,f);var b=[];for(l=0;l<o;l++)b.push((i[l]>>24&255)>>>0),b.push((i[l]>>16&255)>>>0),b.push((i[l]>>8&255)>>>0),b.push((i[l]&255)>>>0);if(s){s(null,b);return}else return b}s&&K(p)}if(typeof s<"u")p();else for(var d;;)if(typeof(d=p())<"u")return d||[]}function Wr(t,e,r,s){var n;if(typeof t!="string"||typeof e!="string")if(n=Error("Invalid string / salt: Not a string"),r){K(r.bind(this,n));return}else throw n;var i,o;if(e.charAt(0)!=="$"||e.charAt(1)!=="2")if(n=Error("Invalid salt version: "+e.substring(0,2)),r){K(r.bind(this,n));return}else throw n;if(e.charAt(2)==="$")i="\0",o=3;else{if(i=e.charAt(2),i!=="a"&&i!=="b"&&i!=="y"||e.charAt(3)!=="$")if(n=Error("Invalid salt revision: "+e.substring(2,4)),r){K(r.bind(this,n));return}else throw n;o=4}if(e.charAt(o+2)>"$")if(n=Error("Missing salt rounds"),r){K(r.bind(this,n));return}else throw n;var c=parseInt(e.substring(o,o+1),10)*10,a=parseInt(e.substring(o+1,o+2),10),f=c+a,l=e.substring(o+3,o+25);t+=i>="a"?"\0":"";var u=ad(t),p=so(l,Ze);function d(x){var b=[];return b.push("$2"),i>="a"&&b.push(i),b.push("$"),f<10&&b.push("0"),b.push(f.toString()),b.push("$"),b.push(Rt(p,p.length)),b.push(Rt(x,no.length*4-1)),b.join("")}if(typeof r>"u")return d(Wi(u,p,f));Wi(u,p,f,function(x,b){x?r(x,null):r(null,d(b))},s)}function ld(t,e){return Rt(t,e)}function dd(t,e){return so(t,e)}var Zr={setRandomFallback:td,genSaltSync:Xr,genSalt:Ji,hashSync:Zi,hash:eo,compareSync:rd,compare:sd,getRounds:nd,getSalt:id,truncates:od,encodeBase64:ld,decodeBase64:dd};var Xe=ke(jo(),1);var Fo=ke(require("crypto"),1),JE=process.env.CSRF_ENABLED==="true",$o=()=>Fo.default.randomBytes(32).toString("hex");var Uo=t=>{let r=(process.env.NODE_ENV||"development")==="production",s=process.env.COOKIE_DOMAIN||void 0,n=`XSRF-TOKEN=${t}; Path=/; SameSite=Lax; Max-Age=900`;return r&&(n+="; Secure"),s&&(n+=`; Domain=${s}`),n};var Go=()=>{let e=(process.env.NODE_ENV||"development")==="production",r=process.env.COOKIE_DOMAIN||void 0,s="XSRF-TOKEN=; Path=/; SameSite=Lax; Max-Age=0";return e&&(s+="; Secure"),r&&(s+=`; Domain=${r}`),s};var Gc=ke(Fc(),1);var pt={auth:{maxRequests:10,windowMs:9e5,message:"Too many authentication attempts. Please try again later."},emailVerification:{maxRequests:5,windowMs:36e5,message:"Too many verification email requests. Please try again later."},reports:{maxRequests:parseInt(process.env.REPORTS_MAX_PER_HOUR||"5",10),windowMs:36e5,message:"Too many reports submitted. Please try again later."},write:{maxRequests:100,windowMs:36e5,message:"Too many write requests. Please try again later."},read:{maxRequests:1e3,windowMs:36e5,message:"Too many read requests. Please try again later."}};function $c(t,e){return t==="/auth/resend-verification"?pt.emailVerification:t==="/reports"&&e==="POST"?pt.reports:t.startsWith("/auth/")?pt.auth:["POST","PUT","DELETE","PATCH"].includes(e.toUpperCase())?pt.write:pt.read}function Uc(t){return!(t==="/health"||t==="/meta")}var He=null,hr=null,pr=new Map;function pg(){if(He)return He;let t=process.env.REDIS_URL;if(!t)return console.warn("[RateLimit] REDIS_URL not configured. Using in-memory fallback (single instance only, not distributed)."),null;try{return He=new Gc.default(t,{maxRetriesPerRequest:3,retryStrategy:e=>e>3?(console.error("[RateLimit] Redis connection failed after 3 retries"),null):Math.min(e*100,3e3),reconnectOnError:e=>!!e.message.includes("READONLY")}),He.on("error",e=>{console.error("[RateLimit] Redis error:",e),hr=e}),He.on("connect",()=>{console.log("[RateLimit] Redis connected successfully"),hr=null}),He}catch(e){return console.error("[RateLimit] Failed to initialize Redis client:",e),hr=e,null}}function yg(t){if(t.requestContext?.http?.sourceIp)return t.requestContext.http.sourceIp;let e=t.headers?.[" x-forwarded-for"]||t.headers?.["X-Forwarded-For"];return e?e.split(",")[0].trim():"unknown"}function gg(t){return t.userId||null}function mg(t,e,r){let s=r?`user:${r}`:`ip:${e}`;return`rl:${t}:${s}`}async function xg(t,e,r){let s=pg();if(!s||hr)return Gn(t,e,r);try{let n=Math.ceil(r/1e3),i=Date.now(),o=s.pipeline();o.incr(t),o.pttl(t);let c=await o.exec();if(!c||c.some(([d])=>d))return console.error("[RateLimit] Redis pipeline error, falling back to in-memory"),Gn(t,e,r);let a=c[0][1],f=c[1][1];(a===1||f===-1)&&await s.pexpire(t,r);let l=f>0?i+f:i+r,u=a<=e,p=Math.max(0,e-a);return{allowed:u,remaining:p,resetTime:l}}catch(n){return console.error("[RateLimit] Redis check error, falling back to in-memory:",n),Gn(t,e,r)}}async function Gn(t,e,r){let s=Date.now(),n=pr.get(t);if(!n||s>n.resetTime)return n={count:1,resetTime:s+r},pr.set(t,n),Math.random()<.01&&bg(),{allowed:!0,remaining:e-1,resetTime:n.resetTime};n.count++;let i=n.count<=e,o=Math.max(0,e-n.count);return{allowed:i,remaining:o,resetTime:n.resetTime}}function bg(){let t=Date.now();for(let[e,r]of pr.entries())t>r.resetTime&&pr.delete(e)}async function Hc(t,e=null){if(!(process.env.RATE_LIMITING_ENABLED!=="false"))return{allowed:!0};let s=t.requestContext?.http?.method||t.httpMethod||"GET",n=t.requestContext?.http?.path||t.path||"/";if(!Uc(n))return{allowed:!0};let i=e||n,o=yg(t),c=gg(t),a=$c(i,s),{maxRequests:f,windowMs:l,message:u}=a,p=mg(i,o,c),{allowed:d,remaining:x,resetTime:b}=await xg(p,f,l);if(!d){let I=Math.ceil((b-Date.now())/1e3);return{allowed:!1,response:{statusCode:429,headers:{"Content-Type":"application/json","Retry-After":I.toString(),"X-RateLimit-Limit":f.toString(),"X-RateLimit-Remaining":"0","X-RateLimit-Reset":Math.ceil(b/1e3).toString()},body:JSON.stringify({error:u,retryAfter:I})}}}return t.rateLimitHeaders={"X-RateLimit-Limit":f.toString(),"X-RateLimit-Remaining":x.toString(),"X-RateLimit-Reset":Math.ceil(b/1e3).toString()},{allowed:!0}}var Hr=ke(b0(),1),S0=ke(require("crypto"),1),Ni=process.env.JWT_SECRET||"dev-secret-key-change-in-production",bE="30m",SE="7d",We=process.env.COOKIE_DOMAIN||void 0,EE=process.env.NODE_ENV||"development",Ct=EE==="production",Mi=t=>Hr.default.sign({userId:t,type:"access"},Ni,{expiresIn:bE}),E0=t=>{let e=S0.default.randomBytes(16).toString("hex");return Hr.default.sign({userId:t,type:"refresh",jti:e},Ni,{expiresIn:SE})},Pi=t=>{try{return Hr.default.verify(t,Ni)}catch{return null}},qi=(t,e="access")=>{let r=e==="access"?"access_token":"refresh_token",s=wE(t.headers?.cookie||t.headers?.Cookie||"");if(s[r])return s[r];if(e==="access"){let n=t.headers?.authorization||t.headers?.Authorization;if(n&&n.startsWith("Bearer "))return n.substring(7)}return null},wE=t=>{let e={};return t&&t.split(";").forEach(r=>{let[s,...n]=r.split("=");s&&n.length>0&&(e[s.trim()]=n.join("=").trim())}),e},Li=t=>{let s=`access_token=${t}; HttpOnly; Path=/; SameSite=${Ct?"Strict":"Lax"}; Max-Age=1800`;return Ct&&(s+="; Secure"),We&&(s+=`; Domain=${We}`),s},w0=t=>{let s=`refresh_token=${t}; HttpOnly; Path=/; SameSite=${Ct?"Strict":"Lax"}; Max-Age=604800`;return Ct&&(s+="; Secure"),We&&(s+=`; Domain=${We}`),s},k0=()=>{let t="Path=/; SameSite=Lax; Max-Age=0",e=Ct?"; Secure":"",r=We?`; Domain=${We}`:"";return[`access_token=; ${t}${e}${r}`,`refresh_token=; ${t}${e}${r}`]},Te=t=>{let e=qi(t,"access");if(!e)return null;let r=Pi(e);return!r||r.type!=="access"?null:r.userId||null};function kE(t={}){return{...Kr(),...t}}function v0(){return Math.floor(Date.now()/1e3)}function vE(t){if(!t||typeof t!="string")return"";let[e,r]=t.split("@");return r?`${e.slice(0,2)}***@${r}`:t}function X(t,e,r=[]){return{statusCode:t,headers:kE({"Content-Type":"application/json"}),cookies:r,body:JSON.stringify(e)}}async function AE(t){let e=v0();try{if(!(await Hc(t,"login",10,60)).allowed)return console.warn("[LOGIN] Rate limit exceeded"),S(429,"Too many login attempts");let s=t?.body||"";console.log(`[LOGIN] Raw body length: ${s.length}`);let n={};if(s)try{n=JSON.parse(s)}catch(b){return console.error("[LOGIN] JSON parse error:",b),S(400,"Invalid JSON body")}let{email:i,password:o,twoFactorCode:c}=n||{};if(!i||!o)return console.warn("[LOGIN] Missing email/password"),S(400,"email and password are required");console.log(`[LOGIN] Attempt for email=${vE(i)}`);let f=await se().user.findUnique({where:{email:i.toLowerCase()}});if(!f)return console.warn("[LOGIN] User not found"),S(401,"Invalid credentials");if(!f.passwordHash)return console.error("[LOGIN] User missing password hash"),S(500,"Server error");if(!await Zr.compare(o,f.passwordHash))return console.warn("[LOGIN] Invalid password"),S(401,"Invalid credentials");if(f.twoFactorEnabled){if(!c)return console.warn("[LOGIN] 2FA required but code missing"),S(401,"Two-factor code required");if(!Xe.authenticator.verify({token:c,secret:f.twoFactorSecret}))return console.warn("[LOGIN] 2FA code invalid"),S(401,"Invalid two-factor code")}let u=Mi(f.id),p=E0(f.id),d=$o(),x=[Li(u),w0(p),Uo(d)];return console.log(`[LOGIN] Success userId=${f.id} latency=${v0()-e}s`),X(200,{user:{id:f.id,email:f.email,createdAt:f.createdAt,twoFactorEnabled:f.twoFactorEnabled||!1},csrfToken:d},x)}catch(r){return console.error("[LOGIN] Unhandled error:",r),S(500,"Server error")}}async function CE(t){try{let e=t?.body||"";console.log(`[REGISTER] Raw body length: ${e.length}`);let r={};if(e)try{r=JSON.parse(e)}catch(l){return console.error("[REGISTER] JSON parse error:",l),S(400,"Invalid JSON body")}let{email:s,password:n}=r;if(!s||!n)return S(400,"email and password are required");let i=process.env.ALLOWED_USER_EMAILS||"";if(i.trim().length>0&&!i.split(",").map(u=>u.trim().toLowerCase()).filter(Boolean).includes(s.toLowerCase()))return console.warn("[REGISTER] Email not allowlisted"),S(403,"Registration not permitted");let o=se();if(await o.user.findUnique({where:{email:s.toLowerCase()}}))return S(409,"Email already registered");let a=await Zr.hash(n,12),f=await o.user.create({data:{email:s.toLowerCase(),passwordHash:a}});return console.log(`[REGISTER] Created userId=${f.id}`),X(201,{user:{id:f.id,email:f.email,createdAt:f.createdAt}})}catch(e){return console.error("[REGISTER] Unhandled error:",e),S(500,"Server error")}}async function _E(t){try{let e=Te(t);if(!e)return S(401,"Unauthorized");let s=await se().user.findUnique({where:{id:e}});return s?X(200,{user:{id:s.id,email:s.email,createdAt:s.createdAt,twoFactorEnabled:s.twoFactorEnabled||!1}}):S(404,"Not found")}catch(e){return console.error("[ME] Unhandled error:",e),S(500,"Server error")}}async function OE(t){try{let e=qi(t,"refresh");if(!e)return S(401,"Missing refresh token");let r=Pi(e,"refresh");if(!r)return S(401,"Invalid refresh token");let n=await se().user.findUnique({where:{id:r.sub}});if(!n)return S(401,"Invalid user");let i=Mi(n.id),o=Li(i);return X(200,{ok:!0},[o])}catch(e){return console.error("[REFRESH] Unhandled error:",e),S(500,"Server error")}}async function RE(t){try{let e=[...k0(),Go()];return X(200,{ok:!0},e)}catch(e){return console.error("[LOGOUT] Unhandled error:",e),S(500,"Server error")}}async function TE(t){try{let e=t?.body||"",r={};if(e)try{r=JSON.parse(e)}catch{return S(400,"Invalid JSON body")}let{token:s}=r;return s?(console.log("[VERIFY_EMAIL] Not yet implemented"),X(200,{verified:!0})):S(400,"token is required")}catch(e){return console.error("[VERIFY_EMAIL] Unhandled error:",e),S(500,"Server error")}}async function IE(t){try{let e=t?.body||"",r={};if(e)try{r=JSON.parse(e)}catch{return S(400,"Invalid JSON body")}let{email:s}=r;return s?(console.log("[RESEND_VERIFICATION] Not yet implemented"),X(200,{sent:!0})):S(400,"email is required")}catch(e){return console.error("[RESEND_VERIFICATION] Unhandled error:",e),S(500,"Server error")}}async function NE(t){try{let e=Te(t);if(!e)return S(401,"Unauthorized");let r=se(),s=await r.user.findUnique({where:{id:e}});if(!s)return S(404,"Not found");if(s.twoFactorEnabled)return S(400,"Already enabled");let n=Xe.authenticator.generateSecret();await r.user.update({where:{id:s.id},data:{twoFactorSecret:n}});let i=Xe.authenticator.keyuri(s.email,"ProjectValine",n);return X(200,{secret:n,otpauth:i})}catch(e){return console.error("[SETUP2FA] Unhandled error:",e),S(500,"Server error")}}async function A0(t){try{let e=Te(t);if(!e)return S(401,"Unauthorized");let r=t?.body||"",s={};if(r)try{s=JSON.parse(r)}catch{return S(400,"Invalid JSON body")}let{code:n}=s;if(!n)return S(400,"code is required");let i=se(),o=await i.user.findUnique({where:{id:e}});return!o||!o.twoFactorSecret?S(400,"2FA not initialized"):Xe.authenticator.verify({token:n,secret:o.twoFactorSecret})?(await i.user.update({where:{id:o.id},data:{twoFactorEnabled:!0}}),X(200,{twoFactorEnabled:!0})):S(401,"Invalid code")}catch(e){return console.error("[ENABLE2FA] Unhandled error:",e),S(500,"Server error")}}async function C0(t){try{let e=Te(t);if(!e)return S(401,"Unauthorized");let r=t?.body||"",s={};if(r)try{s=JSON.parse(r)}catch{return S(400,"Invalid JSON body")}let{code:n}=s;if(!n)return S(400,"code is required");let o=await se().user.findUnique({where:{id:e}});return!o||!o.twoFactorSecret?S(400,"2FA not initialized"):Xe.authenticator.verify({token:n,secret:o.twoFactorSecret})?X(200,{verified:!0}):S(401,"Invalid code")}catch(e){return console.error("[VERIFY2FA] Unhandled error:",e),S(500,"Server error")}}async function ME(t){try{let e=Te(t);if(!e)return S(401,"Unauthorized");let r=se(),s=await r.user.findUnique({where:{id:e}});return s?s.twoFactorEnabled?(await r.user.update({where:{id:s.id},data:{twoFactorEnabled:!1,twoFactorSecret:null}}),X(200,{twoFactorEnabled:!1})):S(400,"2FA not enabled"):S(404,"Not found")}catch(e){return console.error("[DISABLE2FA] Unhandled error:",e),S(500,"Server error")}}async function PE(t){return A0(t)}async function qE(t){return C0(t)}function LE(t){try{return Te(t)||null}catch{return null}}0&&(module.exports={disable2FA,enable2FA,enable2fa,getUserFromEvent,login,logout,me,refresh,register,resendVerification,setup2FA,verify2FA,verify2fa,verifyEmail});
/*! Bundled license information:

@otplib/plugin-crypto/index.js:
  (**
   * @otplib/plugin-crypto
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/plugin-thirty-two/index.js:
  (**
   * @otplib/plugin-thirty-two
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/core/index.js:
  (**
   * @otplib/core
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/preset-default/index.js:
  (**
   * @otplib/preset-default
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

otplib/index.js:
  (**
   * otplib
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
