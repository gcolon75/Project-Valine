var Ml=Object.create;var mt=Object.defineProperty;var ql=Object.getOwnPropertyDescriptor;var Dl=Object.getOwnPropertyNames;var Bl=Object.getPrototypeOf,jl=Object.prototype.hasOwnProperty;var Fl=(t,e)=>()=>(t&&(e=t(t=0)),e);var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),$l=(t,e)=>{for(var r in e)mt(t,r,{get:e[r],enumerable:!0})},Fn=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Dl(e))!jl.call(t,n)&&n!==r&&mt(t,n,{get:()=>e[n],enumerable:!(s=ql(e,n))||s.enumerable});return t};var Er=(t,e,r)=>(r=t!=null?Ml(Bl(t)):{},Fn(e||!t||!t.__esModule?mt(r,"default",{value:t,enumerable:!0}):r,t)),$n=t=>Fn(mt({},"__esModule",{value:!0}),t);var tf={};function Jl(t){return typeof t=="function"?t:e=>e.$extends(t)}function Zl(t){return t}var wr,Ul,Gl,Ql,zl,Vl,Hl,Un,Kl,Yl,Wl,Xl,Gn,ef,Qn=Fl(()=>{"use strict";wr=Object.defineProperty,Ul=Object.getOwnPropertyDescriptor,Gl=Object.getOwnPropertyNames,Ql=Object.prototype.hasOwnProperty,zl=(t,e)=>{for(var r in e)wr(t,r,{get:e[r],enumerable:!0})},Vl=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Gl(e))!Ql.call(t,n)&&n!==r&&wr(t,n,{get:()=>e[n],enumerable:!(s=Ul(e,n))||s.enumerable});return t},Hl=t=>Vl(wr({},"__esModule",{value:!0}),t),Un={};zl(Un,{Prisma:()=>Gn,PrismaClient:()=>Xl,default:()=>ef});module.exports=Hl(Un);Kl={enginesVersion:"2ba551f319ab1df4bc874a89965d8b3641056773"},Yl="6.19.0",Wl=Yl,Xl=class{constructor(){throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.')}};Gn={defineExtension:Jl,getExtensionContext:Zl,prismaVersion:{client:Wl,engine:Kl.enginesVersion}},ef={Prisma:Gn}});var Vn=p((g1,zn)=>{zn.exports={...(Qn(),$n(tf))}});var Ce=p((Ar,Wn)=>{var gt=require("buffer"),W=gt.Buffer;function Yn(t,e){for(var r in t)e[r]=t[r]}W.from&&W.alloc&&W.allocUnsafe&&W.allocUnsafeSlow?Wn.exports=gt:(Yn(gt,Ar),Ar.Buffer=Ee);function Ee(t,e,r){return W(t,e,r)}Ee.prototype=Object.create(W.prototype);Yn(W,Ee);Ee.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return W(t,e,r)};Ee.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var s=W(t);return e!==void 0?typeof r=="string"?s.fill(e,r):s.fill(e):s.fill(0),s};Ee.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return W(t)};Ee.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return gt.SlowBuffer(t)}});var vr=p((E1,Xn)=>{var St=Ce().Buffer,af=require("stream"),cf=require("util");function bt(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=St.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=St.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}cf.inherits(bt,af);bt.prototype.write=function(e){this.buffer=St.concat([this.buffer,St.from(e)]),this.emit("data",e)};bt.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};Xn.exports=bt});var Zn=p((w1,Jn)=>{"use strict";function xr(t){var e=(t/8|0)+(t%8===0?0:1);return e}var uf={ES256:xr(256),ES384:xr(384),ES512:xr(521)};function lf(t){var e=uf[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}Jn.exports=lf});var oi=p((k1,ii)=>{"use strict";var Et=Ce().Buffer,ti=Zn(),wt=128,ri=0,ff=32,hf=16,pf=2,si=hf|ff|ri<<6,kt=pf|ri<<6;function df(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ni(t){if(Et.isBuffer(t))return t;if(typeof t=="string")return Et.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function yf(t,e){t=ni(t);var r=ti(e),s=r+1,n=t.length,i=0;if(t[i++]!==si)throw new Error('Could not find expected "seq"');var o=t[i++];if(o===(wt|1)&&(o=t[i++]),n-i<o)throw new Error('"seq" specified length of "'+o+'", only "'+(n-i)+'" remaining');if(t[i++]!==kt)throw new Error('Could not find expected "int" for "r"');var c=t[i++];if(n-i-2<c)throw new Error('"r" specified length of "'+c+'", only "'+(n-i-2)+'" available');if(s<c)throw new Error('"r" specified length of "'+c+'", max of "'+s+'" is acceptable');var a=i;if(i+=c,t[i++]!==kt)throw new Error('Could not find expected "int" for "s"');var u=t[i++];if(n-i!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(n-i)+'"');if(s<u)throw new Error('"s" specified length of "'+u+'", max of "'+s+'" is acceptable');var f=i;if(i+=u,i!==n)throw new Error('Expected to consume entire buffer, but "'+(n-i)+'" bytes remain');var l=r-c,d=r-u,h=Et.allocUnsafe(l+c+d+u);for(i=0;i<l;++i)h[i]=0;t.copy(h,i,a+Math.max(-l,0),a+c),i=r;for(var g=i;i<g+d;++i)h[i]=0;return t.copy(h,i,f+Math.max(-d,0),f+u),h=h.toString("base64"),h=df(h),h}function ei(t,e,r){for(var s=0;e+s<r&&t[e+s]===0;)++s;var n=t[e+s]>=wt;return n&&--s,s}function mf(t,e){t=ni(t);var r=ti(e),s=t.length;if(s!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+s+'"');var n=ei(t,0,r),i=ei(t,r,t.length),o=r-n,c=r-i,a=2+o+1+1+c,u=a<wt,f=Et.allocUnsafe((u?2:3)+a),l=0;return f[l++]=si,u?f[l++]=a:(f[l++]=wt|1,f[l++]=a&255),f[l++]=kt,f[l++]=o,n<0?(f[l++]=0,l+=t.copy(f,l,0,r)):l+=t.copy(f,l,n,r),f[l++]=kt,f[l++]=c,i<0?(f[l++]=0,t.copy(f,l,r)):t.copy(f,l,r+i),f}ii.exports={derToJose:yf,joseToDer:mf}});var ci=p((A1,ai)=>{"use strict";var ze=require("buffer").Buffer,_r=require("buffer").SlowBuffer;ai.exports=At;function At(t,e){if(!ze.isBuffer(t)||!ze.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,s=0;s<t.length;s++)r|=t[s]^e[s];return r===0}At.install=function(){ze.prototype.equal=_r.prototype.equal=function(e){return At(this,e)}};var gf=ze.prototype.equal,Sf=_r.prototype.equal;At.restore=function(){ze.prototype.equal=gf,_r.prototype.equal=Sf}});var Or=p((v1,gi)=>{var Te=Ce().Buffer,U=require("crypto"),li=oi(),ui=require("util"),bf=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Ve="secret must be a string or buffer",Re="key must be a string or a buffer",Ef="key must be a string, a buffer or an object",Rr=typeof U.createPublicKey=="function";Rr&&(Re+=" or a KeyObject",Ve+="or a KeyObject");function fi(t){if(!Te.isBuffer(t)&&typeof t!="string"&&(!Rr||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw K(Re)}function hi(t){if(!Te.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw K(Ef)}function wf(t){if(!Te.isBuffer(t)){if(typeof t=="string")return t;if(!Rr||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw K(Ve)}}function Tr(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function pi(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function K(t){var e=[].slice.call(arguments,1),r=ui.format.bind(ui,t).apply(null,e);return new TypeError(r)}function kf(t){return Te.isBuffer(t)||typeof t=="string"}function He(t){return kf(t)||(t=JSON.stringify(t)),t}function di(t){return function(r,s){wf(s),r=He(r);var n=U.createHmac("sha"+t,s),i=(n.update(r),n.digest("base64"));return Tr(i)}}var Cr,Af="timingSafeEqual"in U?function(e,r){return e.byteLength!==r.byteLength?!1:U.timingSafeEqual(e,r)}:function(e,r){return Cr||(Cr=ci()),Cr(e,r)};function vf(t){return function(r,s,n){var i=di(t)(r,n);return Af(Te.from(s),Te.from(i))}}function yi(t){return function(r,s){hi(s),r=He(r);var n=U.createSign("RSA-SHA"+t),i=(n.update(r),n.sign(s,"base64"));return Tr(i)}}function mi(t){return function(r,s,n){fi(n),r=He(r),s=pi(s);var i=U.createVerify("RSA-SHA"+t);return i.update(r),i.verify(n,s,"base64")}}function xf(t){return function(r,s){hi(s),r=He(r);var n=U.createSign("RSA-SHA"+t),i=(n.update(r),n.sign({key:s,padding:U.constants.RSA_PKCS1_PSS_PADDING,saltLength:U.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Tr(i)}}function _f(t){return function(r,s,n){fi(n),r=He(r),s=pi(s);var i=U.createVerify("RSA-SHA"+t);return i.update(r),i.verify({key:n,padding:U.constants.RSA_PKCS1_PSS_PADDING,saltLength:U.constants.RSA_PSS_SALTLEN_DIGEST},s,"base64")}}function Cf(t){var e=yi(t);return function(){var s=e.apply(null,arguments);return s=li.derToJose(s,"ES"+t),s}}function Rf(t){var e=mi(t);return function(s,n,i){n=li.joseToDer(n,"ES"+t).toString("base64");var o=e(s,n,i);return o}}function Tf(){return function(){return""}}function Of(){return function(e,r){return r===""}}gi.exports=function(e){var r={hs:di,rs:yi,ps:xf,es:Cf,none:Tf},s={hs:vf,rs:mi,ps:_f,es:Rf,none:Of},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw K(bf,e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:r[i](o),verify:s[i](o)}}});var Ir=p((x1,Si)=>{var If=require("buffer").Buffer;Si.exports=function(e){return typeof e=="string"?e:typeof e=="number"||If.isBuffer(e)?e.toString():JSON.stringify(e)}});var vi=p((_1,Ai)=>{var Nf=Ce().Buffer,bi=vr(),Pf=Or(),Lf=require("stream"),Ei=Ir(),Nr=require("util");function wi(t,e){return Nf.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Mf(t,e,r){r=r||"utf8";var s=wi(Ei(t),"binary"),n=wi(Ei(e),r);return Nr.format("%s.%s",s,n)}function ki(t){var e=t.header,r=t.payload,s=t.secret||t.privateKey,n=t.encoding,i=Pf(e.alg),o=Mf(e,r,n),c=i.sign(o,s);return Nr.format("%s.%s",o,c)}function vt(t){var e=t.secret||t.privateKey||t.key,r=new bi(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new bi(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Nr.inherits(vt,Lf);vt.prototype.sign=function(){try{var e=ki({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}};vt.sign=ki;Ai.exports=vt});var Li=p((C1,Pi)=>{var _i=Ce().Buffer,xi=vr(),qf=Or(),Df=require("stream"),Ci=Ir(),Bf=require("util"),jf=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Ff(t){return Object.prototype.toString.call(t)==="[object Object]"}function $f(t){if(Ff(t))return t;try{return JSON.parse(t)}catch{return}}function Ri(t){var e=t.split(".",1)[0];return $f(_i.from(e,"base64").toString("binary"))}function Uf(t){return t.split(".",2).join(".")}function Ti(t){return t.split(".")[2]}function Gf(t,e){e=e||"utf8";var r=t.split(".")[1];return _i.from(r,"base64").toString(e)}function Oi(t){return jf.test(t)&&!!Ri(t)}function Ii(t,e,r){if(!e){var s=new Error("Missing algorithm parameter for jws.verify");throw s.code="MISSING_ALGORITHM",s}t=Ci(t);var n=Ti(t),i=Uf(t),o=qf(e);return o.verify(i,n,r)}function Ni(t,e){if(e=e||{},t=Ci(t),!Oi(t))return null;var r=Ri(t);if(!r)return null;var s=Gf(t);return(r.typ==="JWT"||e.json)&&(s=JSON.parse(s,e.encoding)),{header:r,payload:s,signature:Ti(t)}}function Oe(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new xi(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new xi(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}Bf.inherits(Oe,Df);Oe.prototype.verify=function(){try{var e=Ii(this.signature.buffer,this.algorithm,this.key.buffer),r=Ni(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(s){this.readable=!1,this.emit("error",s),this.emit("close")}};Oe.decode=Ni;Oe.isValid=Oi;Oe.verify=Ii;Pi.exports=Oe});var _t=p(ie=>{var Mi=vi(),xt=Li(),Qf=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];ie.ALGORITHMS=Qf;ie.sign=Mi.sign;ie.verify=xt.verify;ie.decode=xt.decode;ie.isValid=xt.isValid;ie.createSign=function(e){return new Mi(e)};ie.createVerify=function(e){return new xt(e)}});var Pr=p((T1,qi)=>{var zf=_t();qi.exports=function(t,e){e=e||{};var r=zf.decode(t,e);if(!r)return null;var s=r.payload;if(typeof s=="string")try{var n=JSON.parse(s);n!==null&&typeof n=="object"&&(s=n)}catch{}return e.complete===!0?{header:r.header,payload:s,signature:r.signature}:s}});var Ke=p((O1,Di)=>{var Ct=function(t,e){Error.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=t,e&&(this.inner=e)};Ct.prototype=Object.create(Error.prototype);Ct.prototype.constructor=Ct;Di.exports=Ct});var Lr=p((I1,ji)=>{var Bi=Ke(),Rt=function(t,e){Bi.call(this,t),this.name="NotBeforeError",this.date=e};Rt.prototype=Object.create(Bi.prototype);Rt.prototype.constructor=Rt;ji.exports=Rt});var Mr=p((N1,$i)=>{var Fi=Ke(),Tt=function(t,e){Fi.call(this,t),this.name="TokenExpiredError",this.expiredAt=e};Tt.prototype=Object.create(Fi.prototype);Tt.prototype.constructor=Tt;$i.exports=Tt});var qr=p((P1,Ui)=>{var Ie=1e3,Ne=Ie*60,Pe=Ne*60,we=Pe*24,Vf=we*7,Hf=we*365.25;Ui.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Kf(t);if(r==="number"&&isFinite(t))return e.long?Wf(t):Yf(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Kf(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*Hf;case"weeks":case"week":case"w":return r*Vf;case"days":case"day":case"d":return r*we;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Pe;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ne;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ie;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Yf(t){var e=Math.abs(t);return e>=we?Math.round(t/we)+"d":e>=Pe?Math.round(t/Pe)+"h":e>=Ne?Math.round(t/Ne)+"m":e>=Ie?Math.round(t/Ie)+"s":t+"ms"}function Wf(t){var e=Math.abs(t);return e>=we?Ot(t,e,we,"day"):e>=Pe?Ot(t,e,Pe,"hour"):e>=Ne?Ot(t,e,Ne,"minute"):e>=Ie?Ot(t,e,Ie,"second"):t+" ms"}function Ot(t,e,r,s){var n=e>=r*1.5;return Math.round(t/r)+" "+s+(n?"s":"")}});var Dr=p((L1,Gi)=>{var Xf=qr();Gi.exports=function(t,e){var r=e||Math.floor(Date.now()/1e3);if(typeof t=="string"){var s=Xf(t);return typeof s>"u"?void 0:Math.floor(r+s/1e3)}else return typeof t=="number"?r+t:void 0}});var Ye=p((M1,Qi)=>{"use strict";var Jf="2.0.0",Zf=Number.MAX_SAFE_INTEGER||9007199254740991,eh=16,th=250,rh=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Qi.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:eh,MAX_SAFE_BUILD_LENGTH:th,MAX_SAFE_INTEGER:Zf,RELEASE_TYPES:rh,SEMVER_SPEC_VERSION:Jf,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var We=p((q1,zi)=>{"use strict";var sh=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};zi.exports=sh});var Le=p((X,Vi)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Br,MAX_SAFE_BUILD_LENGTH:nh,MAX_LENGTH:ih}=Ye(),oh=We();X=Vi.exports={};var ah=X.re=[],ch=X.safeRe=[],y=X.src=[],uh=X.safeSrc=[],m=X.t={},lh=0,jr="[a-zA-Z0-9-]",fh=[["\\s",1],["\\d",ih],[jr,nh]],hh=t=>{for(let[e,r]of fh)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},S=(t,e,r)=>{let s=hh(e),n=lh++;oh(t,n,e),m[t]=n,y[n]=e,uh[n]=s,ah[n]=new RegExp(e,r?"g":void 0),ch[n]=new RegExp(s,r?"g":void 0)};S("NUMERICIDENTIFIER","0|[1-9]\\d*");S("NUMERICIDENTIFIERLOOSE","\\d+");S("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${jr}*`);S("MAINVERSION",`(${y[m.NUMERICIDENTIFIER]})\\.(${y[m.NUMERICIDENTIFIER]})\\.(${y[m.NUMERICIDENTIFIER]})`);S("MAINVERSIONLOOSE",`(${y[m.NUMERICIDENTIFIERLOOSE]})\\.(${y[m.NUMERICIDENTIFIERLOOSE]})\\.(${y[m.NUMERICIDENTIFIERLOOSE]})`);S("PRERELEASEIDENTIFIER",`(?:${y[m.NONNUMERICIDENTIFIER]}|${y[m.NUMERICIDENTIFIER]})`);S("PRERELEASEIDENTIFIERLOOSE",`(?:${y[m.NONNUMERICIDENTIFIER]}|${y[m.NUMERICIDENTIFIERLOOSE]})`);S("PRERELEASE",`(?:-(${y[m.PRERELEASEIDENTIFIER]}(?:\\.${y[m.PRERELEASEIDENTIFIER]})*))`);S("PRERELEASELOOSE",`(?:-?(${y[m.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${y[m.PRERELEASEIDENTIFIERLOOSE]})*))`);S("BUILDIDENTIFIER",`${jr}+`);S("BUILD",`(?:\\+(${y[m.BUILDIDENTIFIER]}(?:\\.${y[m.BUILDIDENTIFIER]})*))`);S("FULLPLAIN",`v?${y[m.MAINVERSION]}${y[m.PRERELEASE]}?${y[m.BUILD]}?`);S("FULL",`^${y[m.FULLPLAIN]}$`);S("LOOSEPLAIN",`[v=\\s]*${y[m.MAINVERSIONLOOSE]}${y[m.PRERELEASELOOSE]}?${y[m.BUILD]}?`);S("LOOSE",`^${y[m.LOOSEPLAIN]}$`);S("GTLT","((?:<|>)?=?)");S("XRANGEIDENTIFIERLOOSE",`${y[m.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);S("XRANGEIDENTIFIER",`${y[m.NUMERICIDENTIFIER]}|x|X|\\*`);S("XRANGEPLAIN",`[v=\\s]*(${y[m.XRANGEIDENTIFIER]})(?:\\.(${y[m.XRANGEIDENTIFIER]})(?:\\.(${y[m.XRANGEIDENTIFIER]})(?:${y[m.PRERELEASE]})?${y[m.BUILD]}?)?)?`);S("XRANGEPLAINLOOSE",`[v=\\s]*(${y[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[m.XRANGEIDENTIFIERLOOSE]})(?:${y[m.PRERELEASELOOSE]})?${y[m.BUILD]}?)?)?`);S("XRANGE",`^${y[m.GTLT]}\\s*${y[m.XRANGEPLAIN]}$`);S("XRANGELOOSE",`^${y[m.GTLT]}\\s*${y[m.XRANGEPLAINLOOSE]}$`);S("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Br}})(?:\\.(\\d{1,${Br}}))?(?:\\.(\\d{1,${Br}}))?`);S("COERCE",`${y[m.COERCEPLAIN]}(?:$|[^\\d])`);S("COERCEFULL",y[m.COERCEPLAIN]+`(?:${y[m.PRERELEASE]})?(?:${y[m.BUILD]})?(?:$|[^\\d])`);S("COERCERTL",y[m.COERCE],!0);S("COERCERTLFULL",y[m.COERCEFULL],!0);S("LONETILDE","(?:~>?)");S("TILDETRIM",`(\\s*)${y[m.LONETILDE]}\\s+`,!0);X.tildeTrimReplace="$1~";S("TILDE",`^${y[m.LONETILDE]}${y[m.XRANGEPLAIN]}$`);S("TILDELOOSE",`^${y[m.LONETILDE]}${y[m.XRANGEPLAINLOOSE]}$`);S("LONECARET","(?:\\^)");S("CARETTRIM",`(\\s*)${y[m.LONECARET]}\\s+`,!0);X.caretTrimReplace="$1^";S("CARET",`^${y[m.LONECARET]}${y[m.XRANGEPLAIN]}$`);S("CARETLOOSE",`^${y[m.LONECARET]}${y[m.XRANGEPLAINLOOSE]}$`);S("COMPARATORLOOSE",`^${y[m.GTLT]}\\s*(${y[m.LOOSEPLAIN]})$|^$`);S("COMPARATOR",`^${y[m.GTLT]}\\s*(${y[m.FULLPLAIN]})$|^$`);S("COMPARATORTRIM",`(\\s*)${y[m.GTLT]}\\s*(${y[m.LOOSEPLAIN]}|${y[m.XRANGEPLAIN]})`,!0);X.comparatorTrimReplace="$1$2$3";S("HYPHENRANGE",`^\\s*(${y[m.XRANGEPLAIN]})\\s+-\\s+(${y[m.XRANGEPLAIN]})\\s*$`);S("HYPHENRANGELOOSE",`^\\s*(${y[m.XRANGEPLAINLOOSE]})\\s+-\\s+(${y[m.XRANGEPLAINLOOSE]})\\s*$`);S("STAR","(<|>)?=?\\s*\\*");S("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");S("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var It=p((D1,Hi)=>{"use strict";var ph=Object.freeze({loose:!0}),dh=Object.freeze({}),yh=t=>t?typeof t!="object"?ph:t:dh;Hi.exports=yh});var Fr=p((B1,Wi)=>{"use strict";var Ki=/^[0-9]+$/,Yi=(t,e)=>{if(typeof t=="number"&&typeof e=="number")return t===e?0:t<e?-1:1;let r=Ki.test(t),s=Ki.test(e);return r&&s&&(t=+t,e=+e),t===e?0:r&&!s?-1:s&&!r?1:t<e?-1:1},mh=(t,e)=>Yi(e,t);Wi.exports={compareIdentifiers:Yi,rcompareIdentifiers:mh}});var N=p((j1,Ji)=>{"use strict";var Nt=We(),{MAX_LENGTH:Xi,MAX_SAFE_INTEGER:Pt}=Ye(),{safeRe:Lt,t:Mt}=Le(),gh=It(),{compareIdentifiers:$r}=Fr(),Ur=class t{constructor(e,r){if(r=gh(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Xi)throw new TypeError(`version is longer than ${Xi} characters`);Nt("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let s=e.trim().match(r.loose?Lt[Mt.LOOSE]:Lt[Mt.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>Pt||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Pt||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Pt||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let i=+n;if(i>=0&&i<Pt)return i}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Nt("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let s=this.prerelease[r],n=e.prerelease[r];if(Nt("prerelease compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return $r(s,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let s=this.build[r],n=e.build[r];if(Nt("build compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return $r(s,n)}while(++r)}inc(e,r,s){if(e.startsWith("pre")){if(!r&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n=`-${r}`.match(this.options.loose?Lt[Mt.PRERELEASELOOSE]:Lt[Mt.PRERELEASE]);if(!n||n[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,s),this.inc("pre",r,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,s),this.inc("pre",r,s);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let i=[r,n];s===!1&&(i=[r]),$r(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Ji.exports=Ur});var ke=p((F1,eo)=>{"use strict";var Zi=N(),Sh=(t,e,r=!1)=>{if(t instanceof Zi)return t;try{return new Zi(t,e)}catch(s){if(!r)return null;throw s}};eo.exports=Sh});var ro=p(($1,to)=>{"use strict";var bh=ke(),Eh=(t,e)=>{let r=bh(t,e);return r?r.version:null};to.exports=Eh});var no=p((U1,so)=>{"use strict";var wh=ke(),kh=(t,e)=>{let r=wh(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};so.exports=kh});var ao=p((G1,oo)=>{"use strict";var io=N(),Ah=(t,e,r,s,n)=>{typeof r=="string"&&(n=s,s=r,r=void 0);try{return new io(t instanceof io?t.version:t,r).inc(e,s,n).version}catch{return null}};oo.exports=Ah});var lo=p((Q1,uo)=>{"use strict";var co=ke(),vh=(t,e)=>{let r=co(t,null,!0),s=co(e,null,!0),n=r.compare(s);if(n===0)return null;let i=n>0,o=i?r:s,c=i?s:r,a=!!o.prerelease.length;if(!!c.prerelease.length&&!a){if(!c.patch&&!c.minor)return"major";if(c.compareMain(o)===0)return c.minor&&!c.patch?"minor":"patch"}let f=a?"pre":"";return r.major!==s.major?f+"major":r.minor!==s.minor?f+"minor":r.patch!==s.patch?f+"patch":"prerelease"};uo.exports=vh});var ho=p((z1,fo)=>{"use strict";var xh=N(),_h=(t,e)=>new xh(t,e).major;fo.exports=_h});var yo=p((V1,po)=>{"use strict";var Ch=N(),Rh=(t,e)=>new Ch(t,e).minor;po.exports=Rh});var go=p((H1,mo)=>{"use strict";var Th=N(),Oh=(t,e)=>new Th(t,e).patch;mo.exports=Oh});var bo=p((K1,So)=>{"use strict";var Ih=ke(),Nh=(t,e)=>{let r=Ih(t,e);return r&&r.prerelease.length?r.prerelease:null};So.exports=Nh});var G=p((Y1,wo)=>{"use strict";var Eo=N(),Ph=(t,e,r)=>new Eo(t,r).compare(new Eo(e,r));wo.exports=Ph});var Ao=p((W1,ko)=>{"use strict";var Lh=G(),Mh=(t,e,r)=>Lh(e,t,r);ko.exports=Mh});var xo=p((X1,vo)=>{"use strict";var qh=G(),Dh=(t,e)=>qh(t,e,!0);vo.exports=Dh});var qt=p((J1,Co)=>{"use strict";var _o=N(),Bh=(t,e,r)=>{let s=new _o(t,r),n=new _o(e,r);return s.compare(n)||s.compareBuild(n)};Co.exports=Bh});var To=p((Z1,Ro)=>{"use strict";var jh=qt(),Fh=(t,e)=>t.sort((r,s)=>jh(r,s,e));Ro.exports=Fh});var Io=p((eE,Oo)=>{"use strict";var $h=qt(),Uh=(t,e)=>t.sort((r,s)=>$h(s,r,e));Oo.exports=Uh});var Xe=p((tE,No)=>{"use strict";var Gh=G(),Qh=(t,e,r)=>Gh(t,e,r)>0;No.exports=Qh});var Dt=p((rE,Po)=>{"use strict";var zh=G(),Vh=(t,e,r)=>zh(t,e,r)<0;Po.exports=Vh});var Gr=p((sE,Lo)=>{"use strict";var Hh=G(),Kh=(t,e,r)=>Hh(t,e,r)===0;Lo.exports=Kh});var Qr=p((nE,Mo)=>{"use strict";var Yh=G(),Wh=(t,e,r)=>Yh(t,e,r)!==0;Mo.exports=Wh});var Bt=p((iE,qo)=>{"use strict";var Xh=G(),Jh=(t,e,r)=>Xh(t,e,r)>=0;qo.exports=Jh});var jt=p((oE,Do)=>{"use strict";var Zh=G(),ep=(t,e,r)=>Zh(t,e,r)<=0;Do.exports=ep});var zr=p((aE,Bo)=>{"use strict";var tp=Gr(),rp=Qr(),sp=Xe(),np=Bt(),ip=Dt(),op=jt(),ap=(t,e,r,s)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return tp(t,r,s);case"!=":return rp(t,r,s);case">":return sp(t,r,s);case">=":return np(t,r,s);case"<":return ip(t,r,s);case"<=":return op(t,r,s);default:throw new TypeError(`Invalid operator: ${e}`)}};Bo.exports=ap});var Fo=p((cE,jo)=>{"use strict";var cp=N(),up=ke(),{safeRe:Ft,t:$t}=Le(),lp=(t,e)=>{if(t instanceof cp)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Ft[$t.COERCEFULL]:Ft[$t.COERCE]);else{let a=e.includePrerelease?Ft[$t.COERCERTLFULL]:Ft[$t.COERCERTL],u;for(;(u=a.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||u.index+u[0].length!==r.index+r[0].length)&&(r=u),a.lastIndex=u.index+u[1].length+u[2].length;a.lastIndex=-1}if(r===null)return null;let s=r[2],n=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return up(`${s}.${n}.${i}${o}${c}`,e)};jo.exports=lp});var Uo=p((uE,$o)=>{"use strict";var Vr=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};$o.exports=Vr});var Q=p((lE,Vo)=>{"use strict";var fp=/\s+/g,Hr=class t{constructor(e,r){if(r=pp(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Kr)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(fp," "),this.set=this.raw.split("||").map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let s=this.set[0];if(this.set=this.set.filter(n=>!Qo(n[0])),this.set.length===0)this.set=[s];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&Ep(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let s=0;s<r.length;s++)s>0&&(this.formatted+=" "),this.formatted+=r[s].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let s=((this.options.includePrerelease&&Sp)|(this.options.loose&&bp))+":"+e,n=Go.get(s);if(n)return n;let i=this.options.loose,o=i?M[P.HYPHENRANGELOOSE]:M[P.HYPHENRANGE];e=e.replace(o,Op(this.options.includePrerelease)),A("hyphen replace",e),e=e.replace(M[P.COMPARATORTRIM],yp),A("comparator trim",e),e=e.replace(M[P.TILDETRIM],mp),A("tilde trim",e),e=e.replace(M[P.CARETTRIM],gp),A("caret trim",e);let c=e.split(" ").map(l=>wp(l,this.options)).join(" ").split(/\s+/).map(l=>Tp(l,this.options));i&&(c=c.filter(l=>(A("loose invalid filter",l,this.options),!!l.match(M[P.COMPARATORLOOSE])))),A("range list",c);let a=new Map,u=c.map(l=>new Kr(l,this.options));for(let l of u){if(Qo(l))return[l];a.set(l.value,l)}a.size>1&&a.has("")&&a.delete("");let f=[...a.values()];return Go.set(s,f),f}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(s=>zo(s,r)&&e.set.some(n=>zo(n,r)&&s.every(i=>n.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new dp(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Ip(this.set[r],e,this.options))return!0;return!1}};Vo.exports=Hr;var hp=Uo(),Go=new hp,pp=It(),Kr=Je(),A=We(),dp=N(),{safeRe:M,t:P,comparatorTrimReplace:yp,tildeTrimReplace:mp,caretTrimReplace:gp}=Le(),{FLAG_INCLUDE_PRERELEASE:Sp,FLAG_LOOSE:bp}=Ye(),Qo=t=>t.value==="<0.0.0-0",Ep=t=>t.value==="",zo=(t,e)=>{let r=!0,s=t.slice(),n=s.pop();for(;r&&s.length;)r=s.every(i=>n.intersects(i,e)),n=s.pop();return r},wp=(t,e)=>(t=t.replace(M[P.BUILD],""),A("comp",t,e),t=vp(t,e),A("caret",t),t=kp(t,e),A("tildes",t),t=_p(t,e),A("xrange",t),t=Rp(t,e),A("stars",t),t),q=t=>!t||t.toLowerCase()==="x"||t==="*",kp=(t,e)=>t.trim().split(/\s+/).map(r=>Ap(r,e)).join(" "),Ap=(t,e)=>{let r=e.loose?M[P.TILDELOOSE]:M[P.TILDE];return t.replace(r,(s,n,i,o,c)=>{A("tilde",t,s,n,i,o,c);let a;return q(n)?a="":q(i)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:q(o)?a=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:c?(A("replaceTilde pr",c),a=`>=${n}.${i}.${o}-${c} <${n}.${+i+1}.0-0`):a=`>=${n}.${i}.${o} <${n}.${+i+1}.0-0`,A("tilde return",a),a})},vp=(t,e)=>t.trim().split(/\s+/).map(r=>xp(r,e)).join(" "),xp=(t,e)=>{A("caret",t,e);let r=e.loose?M[P.CARETLOOSE]:M[P.CARET],s=e.includePrerelease?"-0":"";return t.replace(r,(n,i,o,c,a)=>{A("caret",t,n,i,o,c,a);let u;return q(i)?u="":q(o)?u=`>=${i}.0.0${s} <${+i+1}.0.0-0`:q(c)?i==="0"?u=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.0${s} <${+i+1}.0.0-0`:a?(A("replaceCaret pr",a),i==="0"?o==="0"?u=`>=${i}.${o}.${c}-${a} <${i}.${o}.${+c+1}-0`:u=`>=${i}.${o}.${c}-${a} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${c}-${a} <${+i+1}.0.0-0`):(A("no pr"),i==="0"?o==="0"?u=`>=${i}.${o}.${c}${s} <${i}.${o}.${+c+1}-0`:u=`>=${i}.${o}.${c}${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${c} <${+i+1}.0.0-0`),A("caret return",u),u})},_p=(t,e)=>(A("replaceXRanges",t,e),t.split(/\s+/).map(r=>Cp(r,e)).join(" ")),Cp=(t,e)=>{t=t.trim();let r=e.loose?M[P.XRANGELOOSE]:M[P.XRANGE];return t.replace(r,(s,n,i,o,c,a)=>{A("xRange",t,s,n,i,o,c,a);let u=q(i),f=u||q(o),l=f||q(c),d=l;return n==="="&&d&&(n=""),a=e.includePrerelease?"-0":"",u?n===">"||n==="<"?s="<0.0.0-0":s="*":n&&d?(f&&(o=0),c=0,n===">"?(n=">=",f?(i=+i+1,o=0,c=0):(o=+o+1,c=0)):n==="<="&&(n="<",f?i=+i+1:o=+o+1),n==="<"&&(a="-0"),s=`${n+i}.${o}.${c}${a}`):f?s=`>=${i}.0.0${a} <${+i+1}.0.0-0`:l&&(s=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`),A("xRange return",s),s})},Rp=(t,e)=>(A("replaceStars",t,e),t.trim().replace(M[P.STAR],"")),Tp=(t,e)=>(A("replaceGTE0",t,e),t.trim().replace(M[e.includePrerelease?P.GTE0PRE:P.GTE0],"")),Op=t=>(e,r,s,n,i,o,c,a,u,f,l,d)=>(q(s)?r="":q(n)?r=`>=${s}.0.0${t?"-0":""}`:q(i)?r=`>=${s}.${n}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,q(u)?a="":q(f)?a=`<${+u+1}.0.0-0`:q(l)?a=`<${u}.${+f+1}.0-0`:d?a=`<=${u}.${f}.${l}-${d}`:t?a=`<${u}.${f}.${+l+1}-0`:a=`<=${a}`,`${r} ${a}`.trim()),Ip=(t,e,r)=>{for(let s=0;s<t.length;s++)if(!t[s].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let s=0;s<t.length;s++)if(A(t[s].semver),t[s].semver!==Kr.ANY&&t[s].semver.prerelease.length>0){let n=t[s].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var Je=p((fE,Jo)=>{"use strict";var Ze=Symbol("SemVer ANY"),Xr=class t{static get ANY(){return Ze}constructor(e,r){if(r=Ho(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Wr("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Ze?this.value="":this.value=this.operator+this.semver.version,Wr("comp",this)}parse(e){let r=this.options.loose?Ko[Yo.COMPARATORLOOSE]:Ko[Yo.COMPARATOR],s=e.match(r);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=s[1]!==void 0?s[1]:"",this.operator==="="&&(this.operator=""),s[2]?this.semver=new Wo(s[2],this.options.loose):this.semver=Ze}toString(){return this.value}test(e){if(Wr("Comparator.test",e,this.options.loose),this.semver===Ze||e===Ze)return!0;if(typeof e=="string")try{e=new Wo(e,this.options)}catch{return!1}return Yr(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Xo(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new Xo(this.value,r).test(e.semver):(r=Ho(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Yr(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Yr(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Jo.exports=Xr;var Ho=It(),{safeRe:Ko,t:Yo}=Le(),Yr=zr(),Wr=We(),Wo=N(),Xo=Q()});var et=p((hE,Zo)=>{"use strict";var Np=Q(),Pp=(t,e,r)=>{try{e=new Np(e,r)}catch{return!1}return e.test(t)};Zo.exports=Pp});var ta=p((pE,ea)=>{"use strict";var Lp=Q(),Mp=(t,e)=>new Lp(t,e).set.map(r=>r.map(s=>s.value).join(" ").trim().split(" "));ea.exports=Mp});var sa=p((dE,ra)=>{"use strict";var qp=N(),Dp=Q(),Bp=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Dp(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===-1)&&(s=o,n=new qp(s,r))}),s};ra.exports=Bp});var ia=p((yE,na)=>{"use strict";var jp=N(),Fp=Q(),$p=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Fp(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===1)&&(s=o,n=new jp(s,r))}),s};na.exports=$p});var ca=p((mE,aa)=>{"use strict";var Jr=N(),Up=Q(),oa=Xe(),Gp=(t,e)=>{t=new Up(t,e);let r=new Jr("0.0.0");if(t.test(r)||(r=new Jr("0.0.0-0"),t.test(r)))return r;r=null;for(let s=0;s<t.set.length;++s){let n=t.set[s],i=null;n.forEach(o=>{let c=new Jr(o.semver.version);switch(o.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!i||oa(c,i))&&(i=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||oa(r,i))&&(r=i)}return r&&t.test(r)?r:null};aa.exports=Gp});var la=p((gE,ua)=>{"use strict";var Qp=Q(),zp=(t,e)=>{try{return new Qp(t,e).range||"*"}catch{return null}};ua.exports=zp});var Ut=p((SE,da)=>{"use strict";var Vp=N(),pa=Je(),{ANY:Hp}=pa,Kp=Q(),Yp=et(),fa=Xe(),ha=Dt(),Wp=jt(),Xp=Bt(),Jp=(t,e,r,s)=>{t=new Vp(t,s),e=new Kp(e,s);let n,i,o,c,a;switch(r){case">":n=fa,i=Wp,o=ha,c=">",a=">=";break;case"<":n=ha,i=Xp,o=fa,c="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Yp(t,e,s))return!1;for(let u=0;u<e.set.length;++u){let f=e.set[u],l=null,d=null;if(f.forEach(h=>{h.semver===Hp&&(h=new pa(">=0.0.0")),l=l||h,d=d||h,n(h.semver,l.semver,s)?l=h:o(h.semver,d.semver,s)&&(d=h)}),l.operator===c||l.operator===a||(!d.operator||d.operator===c)&&i(t,d.semver))return!1;if(d.operator===a&&o(t,d.semver))return!1}return!0};da.exports=Jp});var ma=p((bE,ya)=>{"use strict";var Zp=Ut(),ed=(t,e,r)=>Zp(t,e,">",r);ya.exports=ed});var Sa=p((EE,ga)=>{"use strict";var td=Ut(),rd=(t,e,r)=>td(t,e,"<",r);ga.exports=rd});var wa=p((wE,Ea)=>{"use strict";var ba=Q(),sd=(t,e,r)=>(t=new ba(t,r),e=new ba(e,r),t.intersects(e,r));Ea.exports=sd});var Aa=p((kE,ka)=>{"use strict";var nd=et(),id=G();ka.exports=(t,e,r)=>{let s=[],n=null,i=null,o=t.sort((f,l)=>id(f,l,r));for(let f of o)nd(f,e,r)?(i=f,n||(n=f)):(i&&s.push([n,i]),i=null,n=null);n&&s.push([n,null]);let c=[];for(let[f,l]of s)f===l?c.push(f):!l&&f===o[0]?c.push("*"):l?f===o[0]?c.push(`<=${l}`):c.push(`${f} - ${l}`):c.push(`>=${f}`);let a=c.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return a.length<u.length?a:e}});var Ta=p((AE,Ra)=>{"use strict";var va=Q(),es=Je(),{ANY:Zr}=es,tt=et(),ts=G(),od=(t,e,r={})=>{if(t===e)return!0;t=new va(t,r),e=new va(e,r);let s=!1;e:for(let n of t.set){for(let i of e.set){let o=cd(n,i,r);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},ad=[new es(">=0.0.0-0")],xa=[new es(">=0.0.0")],cd=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===Zr){if(e.length===1&&e[0].semver===Zr)return!0;r.includePrerelease?t=ad:t=xa}if(e.length===1&&e[0].semver===Zr){if(r.includePrerelease)return!0;e=xa}let s=new Set,n,i;for(let h of t)h.operator===">"||h.operator===">="?n=_a(n,h,r):h.operator==="<"||h.operator==="<="?i=Ca(i,h,r):s.add(h.semver);if(s.size>1)return null;let o;if(n&&i){if(o=ts(n.semver,i.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||i.operator!=="<="))return null}for(let h of s){if(n&&!tt(h,String(n),r)||i&&!tt(h,String(i),r))return null;for(let g of e)if(!tt(h,String(g),r))return!1;return!0}let c,a,u,f,l=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,d=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;l&&l.prerelease.length===1&&i.operator==="<"&&l.prerelease[0]===0&&(l=!1);for(let h of e){if(f=f||h.operator===">"||h.operator===">=",u=u||h.operator==="<"||h.operator==="<=",n){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(c=_a(n,h,r),c===h&&c!==n)return!1}else if(n.operator===">="&&!tt(n.semver,String(h),r))return!1}if(i){if(l&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===l.major&&h.semver.minor===l.minor&&h.semver.patch===l.patch&&(l=!1),h.operator==="<"||h.operator==="<="){if(a=Ca(i,h,r),a===h&&a!==i)return!1}else if(i.operator==="<="&&!tt(i.semver,String(h),r))return!1}if(!h.operator&&(i||n)&&o!==0)return!1}return!(n&&u&&!i&&o!==0||i&&f&&!n&&o!==0||d||l)},_a=(t,e,r)=>{if(!t)return e;let s=ts(t.semver,e.semver,r);return s>0?t:s<0||e.operator===">"&&t.operator===">="?e:t},Ca=(t,e,r)=>{if(!t)return e;let s=ts(t.semver,e.semver,r);return s<0?t:s>0||e.operator==="<"&&t.operator==="<="?e:t};Ra.exports=od});var Gt=p((vE,Na)=>{"use strict";var rs=Le(),Oa=Ye(),ud=N(),Ia=Fr(),ld=ke(),fd=ro(),hd=no(),pd=ao(),dd=lo(),yd=ho(),md=yo(),gd=go(),Sd=bo(),bd=G(),Ed=Ao(),wd=xo(),kd=qt(),Ad=To(),vd=Io(),xd=Xe(),_d=Dt(),Cd=Gr(),Rd=Qr(),Td=Bt(),Od=jt(),Id=zr(),Nd=Fo(),Pd=Je(),Ld=Q(),Md=et(),qd=ta(),Dd=sa(),Bd=ia(),jd=ca(),Fd=la(),$d=Ut(),Ud=ma(),Gd=Sa(),Qd=wa(),zd=Aa(),Vd=Ta();Na.exports={parse:ld,valid:fd,clean:hd,inc:pd,diff:dd,major:yd,minor:md,patch:gd,prerelease:Sd,compare:bd,rcompare:Ed,compareLoose:wd,compareBuild:kd,sort:Ad,rsort:vd,gt:xd,lt:_d,eq:Cd,neq:Rd,gte:Td,lte:Od,cmp:Id,coerce:Nd,Comparator:Pd,Range:Ld,satisfies:Md,toComparators:qd,maxSatisfying:Dd,minSatisfying:Bd,minVersion:jd,validRange:Fd,outside:$d,gtr:Ud,ltr:Gd,intersects:Qd,simplifyRange:zd,subset:Vd,SemVer:ud,re:rs.re,src:rs.src,tokens:rs.t,SEMVER_SPEC_VERSION:Oa.SEMVER_SPEC_VERSION,RELEASE_TYPES:Oa.RELEASE_TYPES,compareIdentifiers:Ia.compareIdentifiers,rcompareIdentifiers:Ia.rcompareIdentifiers}});var La=p((xE,Pa)=>{var Hd=Gt();Pa.exports=Hd.satisfies(process.version,">=15.7.0")});var qa=p((_E,Ma)=>{var Kd=Gt();Ma.exports=Kd.satisfies(process.version,">=16.9.0")});var ss=p((CE,Da)=>{var Yd=La(),Wd=qa(),Xd={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},Jd={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Da.exports=function(t,e){if(!t||!e)return;let r=e.asymmetricKeyType;if(!r)return;let s=Xd[r];if(!s)throw new Error(`Unknown key type "${r}".`);if(!s.includes(t))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${s.join(", ")}.`);if(Yd)switch(r){case"ec":let n=e.asymmetricKeyDetails.namedCurve,i=Jd[t];if(n!==i)throw new Error(`"alg" parameter "${t}" requires curve "${i}".`);break;case"rsa-pss":if(Wd){let o=parseInt(t.slice(-3),10),{hashAlgorithm:c,mgf1HashAlgorithm:a,saltLength:u}=e.asymmetricKeyDetails;if(c!==`sha${o}`||a!==c)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}.`);if(u!==void 0&&u>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}.`)}break}}});var ns=p((RE,Ba)=>{var Zd=Gt();Ba.exports=Zd.satisfies(process.version,"^6.12.0 || >=8.0.0")});var $a=p((TE,Fa)=>{var w=Ke(),ey=Lr(),ja=Mr(),ty=Pr(),ry=Dr(),sy=ss(),ny=ns(),iy=_t(),{KeyObject:oy,createSecretKey:ay,createPublicKey:cy}=require("crypto"),is=["RS256","RS384","RS512"],uy=["ES256","ES384","ES512"],os=["RS256","RS384","RS512"],ly=["HS256","HS384","HS512"];ny&&(is.splice(is.length,0,"PS256","PS384","PS512"),os.splice(os.length,0,"PS256","PS384","PS512"));Fa.exports=function(t,e,r,s){typeof r=="function"&&!s&&(s=r,r={}),r||(r={}),r=Object.assign({},r);let n;if(s?n=s:n=function(f,l){if(f)throw f;return l},r.clockTimestamp&&typeof r.clockTimestamp!="number")return n(new w("clockTimestamp must be a number"));if(r.nonce!==void 0&&(typeof r.nonce!="string"||r.nonce.trim()===""))return n(new w("nonce must be a non-empty string"));if(r.allowInvalidAsymmetricKeyTypes!==void 0&&typeof r.allowInvalidAsymmetricKeyTypes!="boolean")return n(new w("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!t)return n(new w("jwt must be provided"));if(typeof t!="string")return n(new w("jwt must be a string"));let o=t.split(".");if(o.length!==3)return n(new w("jwt malformed"));let c;try{c=ty(t,{complete:!0})}catch(f){return n(f)}if(!c)return n(new w("invalid token"));let a=c.header,u;if(typeof e=="function"){if(!s)return n(new w("verify must be called asynchronous if secret or public key is provided as a callback"));u=e}else u=function(f,l){return l(null,e)};return u(a,function(f,l){if(f)return n(new w("error in secret or public key callback: "+f.message));let d=o[2].trim()!=="";if(!d&&l)return n(new w("jwt signature is required"));if(d&&!l)return n(new w("secret or public key must be provided"));if(!d&&!r.algorithms)return n(new w('please specify "none" in "algorithms" to verify unsigned tokens'));if(l!=null&&!(l instanceof oy))try{l=cy(l)}catch{try{l=ay(typeof l=="string"?Buffer.from(l):l)}catch{return n(new w("secretOrPublicKey is not valid key material"))}}if(r.algorithms||(l.type==="secret"?r.algorithms=ly:["rsa","rsa-pss"].includes(l.asymmetricKeyType)?r.algorithms=os:l.asymmetricKeyType==="ec"?r.algorithms=uy:r.algorithms=is),r.algorithms.indexOf(c.header.alg)===-1)return n(new w("invalid algorithm"));if(a.alg.startsWith("HS")&&l.type!=="secret")return n(new w(`secretOrPublicKey must be a symmetric key when using ${a.alg}`));if(/^(?:RS|PS|ES)/.test(a.alg)&&l.type!=="public")return n(new w(`secretOrPublicKey must be an asymmetric key when using ${a.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{sy(a.alg,l)}catch(E){return n(E)}let h;try{h=iy.verify(t,c.header.alg,l)}catch(E){return n(E)}if(!h)return n(new w("invalid signature"));let g=c.payload;if(typeof g.nbf<"u"&&!r.ignoreNotBefore){if(typeof g.nbf!="number")return n(new w("invalid nbf value"));if(g.nbf>i+(r.clockTolerance||0))return n(new ey("jwt not active",new Date(g.nbf*1e3)))}if(typeof g.exp<"u"&&!r.ignoreExpiration){if(typeof g.exp!="number")return n(new w("invalid exp value"));if(i>=g.exp+(r.clockTolerance||0))return n(new ja("jwt expired",new Date(g.exp*1e3)))}if(r.audience){let E=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(g.aud)?g.aud:[g.aud]).some(function(Se){return E.some(function(Qe){return Qe instanceof RegExp?Qe.test(Se):Qe===Se})}))return n(new w("jwt audience invalid. expected: "+E.join(" or ")))}if(r.issuer&&(typeof r.issuer=="string"&&g.iss!==r.issuer||Array.isArray(r.issuer)&&r.issuer.indexOf(g.iss)===-1))return n(new w("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&g.sub!==r.subject)return n(new w("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&g.jti!==r.jwtid)return n(new w("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&g.nonce!==r.nonce)return n(new w("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if(typeof g.iat!="number")return n(new w("iat required when maxAge is specified"));let E=ry(r.maxAge,g.iat);if(typeof E>"u")return n(new w('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=E+(r.clockTolerance||0))return n(new ja("maxAge exceeded",new Date(E*1e3)))}if(r.complete===!0){let E=c.signature;return n(null,{header:a,payload:g,signature:E})}return n(null,g)})}});var Ha=p((OE,Va)=>{var Ua=1/0,Qa=9007199254740991,fy=17976931348623157e292,Ga=NaN,hy="[object Arguments]",py="[object Function]",dy="[object GeneratorFunction]",yy="[object String]",my="[object Symbol]",gy=/^\s+|\s+$/g,Sy=/^[-+]0x[0-9a-f]+$/i,by=/^0b[01]+$/i,Ey=/^0o[0-7]+$/i,wy=/^(?:0|[1-9]\d*)$/,ky=parseInt;function Ay(t,e){for(var r=-1,s=t?t.length:0,n=Array(s);++r<s;)n[r]=e(t[r],r,t);return n}function vy(t,e,r,s){for(var n=t.length,i=r+(s?1:-1);s?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function xy(t,e,r){if(e!==e)return vy(t,_y,r);for(var s=r-1,n=t.length;++s<n;)if(t[s]===e)return s;return-1}function _y(t){return t!==t}function Cy(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}function Ry(t,e){return Ay(e,function(r){return t[r]})}function Ty(t,e){return function(r){return t(e(r))}}var Qt=Object.prototype,cs=Qt.hasOwnProperty,zt=Qt.toString,Oy=Qt.propertyIsEnumerable,Iy=Ty(Object.keys,Object),Ny=Math.max;function Py(t,e){var r=za(t)||By(t)?Cy(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||cs.call(t,i))&&!(n&&(i=="length"||My(i,s)))&&r.push(i);return r}function Ly(t){if(!qy(t))return Iy(t);var e=[];for(var r in Object(t))cs.call(t,r)&&r!="constructor"&&e.push(r);return e}function My(t,e){return e=e??Qa,!!e&&(typeof t=="number"||wy.test(t))&&t>-1&&t%1==0&&t<e}function qy(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Qt;return t===r}function Dy(t,e,r,s){t=us(t)?t:Ky(t),r=r&&!s?zy(r):0;var n=t.length;return r<0&&(r=Ny(n+r,0)),Uy(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&xy(t,e,r)>-1}function By(t){return jy(t)&&cs.call(t,"callee")&&(!Oy.call(t,"callee")||zt.call(t)==hy)}var za=Array.isArray;function us(t){return t!=null&&$y(t.length)&&!Fy(t)}function jy(t){return ls(t)&&us(t)}function Fy(t){var e=as(t)?zt.call(t):"";return e==py||e==dy}function $y(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Qa}function as(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function ls(t){return!!t&&typeof t=="object"}function Uy(t){return typeof t=="string"||!za(t)&&ls(t)&&zt.call(t)==yy}function Gy(t){return typeof t=="symbol"||ls(t)&&zt.call(t)==my}function Qy(t){if(!t)return t===0?t:0;if(t=Vy(t),t===Ua||t===-Ua){var e=t<0?-1:1;return e*fy}return t===t?t:0}function zy(t){var e=Qy(t),r=e%1;return e===e?r?e-r:e:0}function Vy(t){if(typeof t=="number")return t;if(Gy(t))return Ga;if(as(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=as(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(gy,"");var r=by.test(t);return r||Ey.test(t)?ky(t.slice(2),r?2:8):Sy.test(t)?Ga:+t}function Hy(t){return us(t)?Py(t):Ly(t)}function Ky(t){return t?Ry(t,Hy(t)):[]}Va.exports=Dy});var Ya=p((IE,Ka)=>{var Yy="[object Boolean]",Wy=Object.prototype,Xy=Wy.toString;function Jy(t){return t===!0||t===!1||Zy(t)&&Xy.call(t)==Yy}function Zy(t){return!!t&&typeof t=="object"}Ka.exports=Jy});var ec=p((NE,Za)=>{var Wa=1/0,em=17976931348623157e292,Xa=NaN,tm="[object Symbol]",rm=/^\s+|\s+$/g,sm=/^[-+]0x[0-9a-f]+$/i,nm=/^0b[01]+$/i,im=/^0o[0-7]+$/i,om=parseInt,am=Object.prototype,cm=am.toString;function um(t){return typeof t=="number"&&t==pm(t)}function Ja(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function lm(t){return!!t&&typeof t=="object"}function fm(t){return typeof t=="symbol"||lm(t)&&cm.call(t)==tm}function hm(t){if(!t)return t===0?t:0;if(t=dm(t),t===Wa||t===-Wa){var e=t<0?-1:1;return e*em}return t===t?t:0}function pm(t){var e=hm(t),r=e%1;return e===e?r?e-r:e:0}function dm(t){if(typeof t=="number")return t;if(fm(t))return Xa;if(Ja(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ja(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(rm,"");var r=nm.test(t);return r||im.test(t)?om(t.slice(2),r?2:8):sm.test(t)?Xa:+t}Za.exports=um});var rc=p((PE,tc)=>{var ym="[object Number]",mm=Object.prototype,gm=mm.toString;function Sm(t){return!!t&&typeof t=="object"}function bm(t){return typeof t=="number"||Sm(t)&&gm.call(t)==ym}tc.exports=bm});var oc=p((LE,ic)=>{var Em="[object Object]";function wm(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function km(t,e){return function(r){return t(e(r))}}var Am=Function.prototype,sc=Object.prototype,nc=Am.toString,vm=sc.hasOwnProperty,xm=nc.call(Object),_m=sc.toString,Cm=km(Object.getPrototypeOf,Object);function Rm(t){return!!t&&typeof t=="object"}function Tm(t){if(!Rm(t)||_m.call(t)!=Em||wm(t))return!1;var e=Cm(t);if(e===null)return!0;var r=vm.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&nc.call(r)==xm}ic.exports=Tm});var cc=p((ME,ac)=>{var Om="[object String]",Im=Object.prototype,Nm=Im.toString,Pm=Array.isArray;function Lm(t){return!!t&&typeof t=="object"}function Mm(t){return typeof t=="string"||!Pm(t)&&Lm(t)&&Nm.call(t)==Om}ac.exports=Mm});var pc=p((qE,hc)=>{var qm="Expected a function",uc=1/0,Dm=17976931348623157e292,lc=NaN,Bm="[object Symbol]",jm=/^\s+|\s+$/g,Fm=/^[-+]0x[0-9a-f]+$/i,$m=/^0b[01]+$/i,Um=/^0o[0-7]+$/i,Gm=parseInt,Qm=Object.prototype,zm=Qm.toString;function Vm(t,e){var r;if(typeof e!="function")throw new TypeError(qm);return t=Xm(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}function Hm(t){return Vm(2,t)}function fc(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Km(t){return!!t&&typeof t=="object"}function Ym(t){return typeof t=="symbol"||Km(t)&&zm.call(t)==Bm}function Wm(t){if(!t)return t===0?t:0;if(t=Jm(t),t===uc||t===-uc){var e=t<0?-1:1;return e*Dm}return t===t?t:0}function Xm(t){var e=Wm(t),r=e%1;return e===e?r?e-r:e:0}function Jm(t){if(typeof t=="number")return t;if(Ym(t))return lc;if(fc(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=fc(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(jm,"");var r=$m.test(t);return r||Um.test(t)?Gm(t.slice(2),r?2:8):Fm.test(t)?lc:+t}hc.exports=Hm});var kc=p((DE,wc)=>{var dc=Dr(),Zm=ns(),eg=ss(),yc=_t(),tg=Ha(),Vt=Ya(),mc=ec(),fs=rc(),Sc=oc(),oe=cc(),rg=pc(),{KeyObject:sg,createSecretKey:ng,createPrivateKey:ig}=require("crypto"),bc=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Zm&&bc.splice(3,0,"PS256","PS384","PS512");var og={expiresIn:{isValid:function(t){return mc(t)||oe(t)&&t},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(t){return mc(t)||oe(t)&&t},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(t){return oe(t)||Array.isArray(t)},message:'"audience" must be a string or array'},algorithm:{isValid:tg.bind(null,bc),message:'"algorithm" must be a valid string enum value'},header:{isValid:Sc,message:'"header" must be an object'},encoding:{isValid:oe,message:'"encoding" must be a string'},issuer:{isValid:oe,message:'"issuer" must be a string'},subject:{isValid:oe,message:'"subject" must be a string'},jwtid:{isValid:oe,message:'"jwtid" must be a string'},noTimestamp:{isValid:Vt,message:'"noTimestamp" must be a boolean'},keyid:{isValid:oe,message:'"keyid" must be a string'},mutatePayload:{isValid:Vt,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Vt,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Vt,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},ag={iat:{isValid:fs,message:'"iat" should be a number of seconds'},exp:{isValid:fs,message:'"exp" should be a number of seconds'},nbf:{isValid:fs,message:'"nbf" should be a number of seconds'}};function Ec(t,e,r,s){if(!Sc(r))throw new Error('Expected "'+s+'" to be a plain object.');Object.keys(r).forEach(function(n){let i=t[n];if(!i){if(!e)throw new Error('"'+n+'" is not allowed in "'+s+'"');return}if(!i.isValid(r[n]))throw new Error(i.message)})}function cg(t){return Ec(og,!1,t,"options")}function ug(t){return Ec(ag,!0,t,"payload")}var gc={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},lg=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];wc.exports=function(t,e,r,s){typeof r=="function"?(s=r,r={}):r=r||{};let n=typeof t=="object"&&!Buffer.isBuffer(t),i=Object.assign({alg:r.algorithm||"HS256",typ:n?"JWT":void 0,kid:r.keyid},r.header);function o(u){if(s)return s(u);throw u}if(!e&&r.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof sg))try{e=ig(e)}catch{try{e=ng(typeof e=="string"?Buffer.from(e):e)}catch{return o(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof t>"u")return o(new Error("payload is required"));if(n){try{ug(t)}catch(u){return o(u)}r.mutatePayload||(t=Object.assign({},t))}else{let u=lg.filter(function(f){return typeof r[f]<"u"});if(u.length>0)return o(new Error("invalid "+u.join(",")+" option for "+typeof t+" payload"))}if(typeof t.exp<"u"&&typeof r.expiresIn<"u")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof t.nbf<"u"&&typeof r.notBefore<"u")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{cg(r)}catch(u){return o(u)}if(!r.allowInvalidAsymmetricKeyTypes)try{eg(i.alg,e)}catch(u){return o(u)}let c=t.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete t.iat:n&&(t.iat=c),typeof r.notBefore<"u"){try{t.nbf=dc(r.notBefore,c)}catch(u){return o(u)}if(typeof t.nbf>"u")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof r.expiresIn<"u"&&typeof t=="object"){try{t.exp=dc(r.expiresIn,c)}catch(u){return o(u)}if(typeof t.exp>"u")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(gc).forEach(function(u){let f=gc[u];if(typeof r[u]<"u"){if(typeof t[f]<"u")return o(new Error('Bad "options.'+u+'" option. The payload already has an "'+f+'" property.'));t[f]=r[u]}});let a=r.encoding||"utf8";if(typeof s=="function")s=s&&rg(s),yc.createSign({header:i,privateKey:e,payload:t,encoding:a}).once("error",s).once("done",function(u){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)return s(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));s(null,u)});else{let u=yc.sign({header:i,payload:t,secret:e,encoding:a});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return u}}});var vc=p((BE,Ac)=>{Ac.exports={decode:Pr(),verify:$a(),sign:kc(),JsonWebTokenError:Ke(),NotBeforeError:Lr(),TokenExpiredError:Mr()}});var Cc=p((WE,gg)=>{gg.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hpexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdelex:{arity:-5,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var Me=p(F=>{"use strict";var Sg=F&&F.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(F,"__esModule",{value:!0});F.getKeyIndexes=F.hasFlag=F.exists=F.list=void 0;var Kt=Sg(Cc());F.list=Object.keys(Kt.default);var ps={};F.list.forEach(t=>{ps[t]=Kt.default[t].flags.reduce(function(e,r){return e[r]=!0,e},{})});function bg(t){return!!Kt.default[t]}F.exists=bg;function Eg(t,e){if(!ps[t])throw new Error("Unknown command "+t);return!!ps[t][e]}F.hasFlag=Eg;function wg(t,e,r){let s=Kt.default[t];if(!s)throw new Error("Unknown command "+t);if(!Array.isArray(e))throw new Error("Expect args to be an array");let n=[],i=!!(r&&r.parseExternalKey),o=(a,u)=>{let f=[],l=Number(a[u]);for(let d=0;d<l;d++)f.push(d+u+1);return f},c=(a,u,f)=>{for(let l=u;l<a.length-1;l+=1)if(String(a[l]).toLowerCase()===f.toLowerCase())return l+1;return null};switch(t){case"zunionstore":case"zinterstore":case"zdiffstore":n.push(0,...o(e,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":n.push(...o(e,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{n.push(...o(e,0));break}case"georadius":{n.push(0);let a=c(e,5,"STORE");a&&n.push(a);let u=c(e,5,"STOREDIST");u&&n.push(u);break}case"georadiusbymember":{n.push(0);let a=c(e,4,"STORE");a&&n.push(a);let u=c(e,4,"STOREDIST");u&&n.push(u);break}case"sort":case"sort_ro":n.push(0);for(let a=1;a<e.length-1;a++){let u=e[a];if(typeof u!="string")continue;let f=u.toUpperCase();f==="GET"?(a+=1,u=e[a],u!=="#"&&(i?n.push([a,Rc(u)]):n.push(a))):f==="BY"?(a+=1,i?n.push([a,Rc(e[a])]):n.push(a)):f==="STORE"&&(a+=1,n.push(a))}break;case"migrate":if(e[2]==="")for(let a=5;a<e.length-1;a++){let u=e[a];if(typeof u=="string"&&u.toUpperCase()==="KEYS"){for(let f=a+1;f<e.length;f++)n.push(f);break}}else n.push(2);break;case"xreadgroup":case"xread":for(let a=t==="xread"?0:3;a<e.length-1;a++)if(String(e[a]).toUpperCase()==="STREAMS"){for(let u=a+1;u<=a+(e.length-1-a)/2;u++)n.push(u);break}break;default:if(s.step>0){let a=s.keyStart-1,u=s.keyStop>0?s.keyStop:e.length+s.keyStop+1;for(let f=a;f<u;f+=s.step)n.push(f)}break}return n}F.getKeyIndexes=wg;function Rc(t){typeof t!="string"&&(t=String(t));let e=t.indexOf("->");return e===-1?t.length:e}});var Tc=p(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.tryCatch=ae.errorObj=void 0;ae.errorObj={e:{}};var ds;function kg(t,e){try{let r=ds;return ds=null,r.apply(this,arguments)}catch(r){return ae.errorObj.e=r,ae.errorObj}}function Ag(t){return ds=t,kg}ae.tryCatch=Ag});var ce=p(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});var qe=Tc();function Oc(t){setTimeout(function(){throw t},0)}function vg(t,e,r){return typeof e=="function"&&t.then(s=>{let n;r!==void 0&&Object(r).spread&&Array.isArray(s)?n=qe.tryCatch(e).apply(void 0,[null].concat(s)):n=s===void 0?qe.tryCatch(e)(null):qe.tryCatch(e)(null,s),n===qe.errorObj&&Oc(n.e)},s=>{if(!s){let i=new Error(s+"");Object.assign(i,{cause:s}),s=i}let n=qe.tryCatch(e)(s);n===qe.errorObj&&Oc(n.e)}),t}ys.default=vg});var Pc=p((ew,Nc)=>{"use strict";var Ic=require("assert"),rt=require("util");function De(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(De,Error);Object.defineProperty(De.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function ms(t,e,r){Ic(e),Ic.strictEqual(typeof r,"number"),Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let s=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=s,this.offset=r,this.buffer=e}rt.inherits(ms,De);Object.defineProperty(ms.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function gs(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let e=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=e}rt.inherits(gs,De);Object.defineProperty(gs.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function Yt(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(Yt,De);Object.defineProperty(Yt.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function Ss(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}rt.inherits(Ss,Yt);Object.defineProperty(Ss.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});Nc.exports={RedisError:De,ParserError:ms,ReplyError:gs,AbortError:Yt,InterruptError:Ss}});var qc=p((tw,Mc)=>{"use strict";var Lc=require("assert"),Be=class extends Error{get name(){return this.constructor.name}},bs=class extends Be{constructor(e,r,s){Lc(r),Lc.strictEqual(typeof s,"number");let n=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=n,this.offset=s,this.buffer=r}get name(){return this.constructor.name}},Es=class extends Be{constructor(e){let r=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=r}get name(){return this.constructor.name}},Wt=class extends Be{get name(){return this.constructor.name}},ws=class extends Wt{get name(){return this.constructor.name}};Mc.exports={RedisError:Be,ParserError:bs,ReplyError:Es,AbortError:Wt,InterruptError:ws}});var Ae=p((rw,Dc)=>{"use strict";var xg=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?Pc():qc();Dc.exports=xg});var st=p((sw,ks)=>{var Bc=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],_g=function(e){for(var r,s=0,n=0,i=[],o=e.length;s<o;s++)r=e.charCodeAt(s),r<128?i[n++]=r:r<2048?(i[n++]=r>>6|192,i[n++]=r&63|128):(r&64512)===55296&&s+1<e.length&&(e.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++s)&1023),i[n++]=r>>18|240,i[n++]=r>>12&63|128,i[n++]=r>>6&63|128,i[n++]=r&63|128):(i[n++]=r>>12|224,i[n++]=r>>6&63|128,i[n++]=r&63|128);return i},jc=ks.exports=function(e){for(var r,s=0,n=-1,i=0,o=0,c=typeof e=="string"?_g(e):e,a=c.length;s<a;){if(r=c[s++],n===-1)r===123&&(n=s);else if(r!==125)o=Bc[(r^o>>8)&255]^o<<8;else if(s-1!==n)return o&16383;i=Bc[(r^i>>8)&255]^i<<8}return i&16383};ks.exports.generateMulti=function(e){for(var r=1,s=e.length,n=jc(e[0]);r<s;)if(jc(e[r++])!==n)return-1;return n}});var Hc=p((nw,Vc)=>{var $c=9007199254740991,Cg="[object Arguments]",Rg="[object Function]",Tg="[object GeneratorFunction]",Og=/^(?:0|[1-9]\d*)$/;function Uc(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Ig(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}var nt=Object.prototype,it=nt.hasOwnProperty,Gc=nt.toString,Ng=nt.propertyIsEnumerable,Fc=Math.max;function Pg(t,e){var r=Gg(t)||Ug(t)?Ig(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||it.call(t,i))&&!(n&&(i=="length"||zc(i,s)))&&r.push(i);return r}function Lg(t,e,r,s){return t===void 0||As(t,nt[r])&&!it.call(s,r)?e:t}function Mg(t,e,r){var s=t[e];(!(it.call(t,e)&&As(s,r))||r===void 0&&!(e in t))&&(t[e]=r)}function qg(t){if(!xs(t))return $g(t);var e=Fg(t),r=[];for(var s in t)s=="constructor"&&(e||!it.call(t,s))||r.push(s);return r}function Qc(t,e){return e=Fc(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,n=Fc(r.length-e,0),i=Array(n);++s<n;)i[s]=r[e+s];s=-1;for(var o=Array(e+1);++s<e;)o[s]=r[s];return o[e]=i,Uc(t,this,o)}}function Dg(t,e,r,s){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n],c=s?s(r[o],t[o],o,r,t):void 0;Mg(r,o,c===void 0?t[o]:c)}return r}function Bg(t){return Qc(function(e,r){var s=-1,n=r.length,i=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(i=t.length>3&&typeof i=="function"?(n--,i):void 0,o&&jg(r[0],r[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++s<n;){var c=r[s];c&&t(e,c,s,i)}return e})}function zc(t,e){return e=e??$c,!!e&&(typeof t=="number"||Og.test(t))&&t>-1&&t%1==0&&t<e}function jg(t,e,r){if(!xs(r))return!1;var s=typeof e;return(s=="number"?vs(r)&&zc(e,r.length):s=="string"&&e in r)?As(r[e],t):!1}function Fg(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||nt;return t===r}function $g(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}function As(t,e){return t===e||t!==t&&e!==e}function Ug(t){return Qg(t)&&it.call(t,"callee")&&(!Ng.call(t,"callee")||Gc.call(t)==Cg)}var Gg=Array.isArray;function vs(t){return t!=null&&Vg(t.length)&&!zg(t)}function Qg(t){return Hg(t)&&vs(t)}function zg(t){var e=xs(t)?Gc.call(t):"";return e==Rg||e==Tg}function Vg(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=$c}function xs(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Hg(t){return!!t&&typeof t=="object"}var Kg=Bg(function(t,e,r,s){Dg(e,Wg(e),t,s)}),Yg=Qc(function(t){return t.push(void 0,Lg),Uc(Kg,void 0,t)});function Wg(t){return vs(t)?Pg(t,!0):qg(t)}Vc.exports=Yg});var Wc=p((iw,Yc)=>{var Xg=9007199254740991,Jg="[object Arguments]",Zg="[object Function]",e0="[object GeneratorFunction]",_s=Object.prototype,t0=_s.hasOwnProperty,Kc=_s.toString,r0=_s.propertyIsEnumerable;function s0(t){return i0(t)&&t0.call(t,"callee")&&(!r0.call(t,"callee")||Kc.call(t)==Jg)}function n0(t){return t!=null&&a0(t.length)&&!o0(t)}function i0(t){return u0(t)&&n0(t)}function o0(t){var e=c0(t)?Kc.call(t):"";return e==Zg||e==e0}function a0(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Xg}function c0(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function u0(t){return!!t&&typeof t=="object"}Yc.exports=s0});var Xt=p(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.isArguments=ue.defaults=ue.noop=void 0;var l0=Hc();ue.defaults=l0;var f0=Wc();ue.isArguments=f0;function h0(){}ue.noop=h0});var Cs=p((aw,Xc)=>{function p0(t){r.debug=r,r.default=r,r.coerce=a,r.disable=o,r.enable=n,r.enabled=c,r.humanize=qr(),r.destroy=u,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let l=0;for(let d=0;d<f.length;d++)l=(l<<5)-l+f.charCodeAt(d),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=e;function r(f){let l,d=null,h,g;function E(...T){if(!E.enabled)return;let ne=E,Se=Number(new Date),Qe=Se-(l||Se);ne.diff=Qe,ne.prev=l,ne.curr=Se,l=Se,T[0]=r.coerce(T[0]),typeof T[0]!="string"&&T.unshift("%O");let yt=0;T[0]=T[0].replace(/%([a-zA-Z%])/g,(br,Pl)=>{if(br==="%%")return"%";yt++;let jn=r.formatters[Pl];if(typeof jn=="function"){let Ll=T[yt];br=jn.call(ne,Ll),T.splice(yt,1),yt--}return br}),r.formatArgs.call(ne,T),(ne.log||r.log).apply(ne,T)}return E.namespace=f,E.useColors=r.useColors(),E.color=r.selectColor(f),E.extend=s,E.destroy=r.destroy,Object.defineProperty(E,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(h!==r.namespaces&&(h=r.namespaces,g=r.enabled(f)),g),set:T=>{d=T}}),typeof r.init=="function"&&r.init(E),E}function s(f,l){let d=r(this.namespace+(typeof l>"u"?":":l)+f);return d.log=this.log,d}function n(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let l=(typeof f=="string"?f:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let d of l)d[0]==="-"?r.skips.push(d.slice(1)):r.names.push(d)}function i(f,l){let d=0,h=0,g=-1,E=0;for(;d<f.length;)if(h<l.length&&(l[h]===f[d]||l[h]==="*"))l[h]==="*"?(g=h,E=d,h++):(d++,h++);else if(g!==-1)h=g+1,E++,d=E;else return!1;for(;h<l.length&&l[h]==="*";)h++;return h===l.length}function o(){let f=[...r.names,...r.skips.map(l=>"-"+l)].join(",");return r.enable(""),f}function c(f){for(let l of r.skips)if(i(f,l))return!1;for(let l of r.names)if(i(f,l))return!0;return!1}function a(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Xc.exports=p0});var Jc=p((B,Jt)=>{B.formatArgs=y0;B.save=m0;B.load=g0;B.useColors=d0;B.storage=S0();B.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();B.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function d0(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function y0(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Jt.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(s=r))}),t.splice(s,0,e)}B.log=console.debug||console.log||(()=>{});function m0(t){try{t?B.storage.setItem("debug",t):B.storage.removeItem("debug")}catch{}}function g0(){let t;try{t=B.storage.getItem("debug")||B.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function S0(){try{return localStorage}catch{}}Jt.exports=Cs()(B);var{formatters:b0}=Jt.exports;b0.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var eu=p((cw,Zc)=>{"use strict";Zc.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",s=e.indexOf(r+t),n=e.indexOf("--");return s!==-1&&(n===-1||s<n)}});var su=p((uw,ru)=>{"use strict";var E0=require("os"),tu=require("tty"),z=eu(),{env:C}=process,Zt;z("no-color")||z("no-colors")||z("color=false")||z("color=never")?Zt=0:(z("color")||z("colors")||z("color=true")||z("color=always"))&&(Zt=1);function w0(){if("FORCE_COLOR"in C)return C.FORCE_COLOR==="true"?1:C.FORCE_COLOR==="false"?0:C.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(C.FORCE_COLOR,10),3)}function k0(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function A0(t,{streamIsTTY:e,sniffFlags:r=!0}={}){let s=w0();s!==void 0&&(Zt=s);let n=r?Zt:s;if(n===0)return 0;if(r){if(z("color=16m")||z("color=full")||z("color=truecolor"))return 3;if(z("color=256"))return 2}if(t&&!e&&n===void 0)return 0;let i=n||0;if(C.TERM==="dumb")return i;if(process.platform==="win32"){let o=E0.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in C)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(o=>o in C)||C.CI_NAME==="codeship"?1:i;if("TEAMCITY_VERSION"in C)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(C.TEAMCITY_VERSION)?1:0;if(C.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in C){let o=Number.parseInt((C.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(C.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(C.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(C.TERM)||"COLORTERM"in C?1:i}function Rs(t,e={}){let r=A0(t,{streamIsTTY:t&&t.isTTY,...e});return k0(r)}ru.exports={supportsColor:Rs,stdout:Rs({isTTY:tu.isatty(1)}),stderr:Rs({isTTY:tu.isatty(2)})}});var iu=p((R,tr)=>{var v0=require("tty"),er=require("util");R.init=I0;R.log=R0;R.formatArgs=_0;R.save=T0;R.load=O0;R.useColors=x0;R.destroy=er.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");R.colors=[6,2,3,4,5,1];try{let t=su();t&&(t.stderr||t).level>=2&&(R.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}R.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[e];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),t[r]=s,t},{});function x0(){return"colors"in R.inspectOpts?!!R.inspectOpts.colors:v0.isatty(process.stderr.fd)}function _0(t){let{namespace:e,useColors:r}=this;if(r){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${e} \x1B[0m`;t[0]=i+t[0].split(`
`).join(`
`+i),t.push(n+"m+"+tr.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=C0()+e+" "+t[0]}function C0(){return R.inspectOpts.hideDate?"":new Date().toISOString()+" "}function R0(...t){return process.stderr.write(er.formatWithOptions(R.inspectOpts,...t)+`
`)}function T0(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function O0(){return process.env.DEBUG}function I0(t){t.inspectOpts={};let e=Object.keys(R.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=R.inspectOpts[e[r]]}tr.exports=Cs()(R);var{formatters:nu}=tr.exports;nu.o=function(t){return this.inspectOpts.colors=this.useColors,er.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};nu.O=function(t){return this.inspectOpts.colors=this.useColors,er.inspect(t,this.inspectOpts)}});var ou=p((lw,Ts)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Ts.exports=Jc():Ts.exports=iu()});var uu=p(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.genRedactedString=te.getStringValue=te.MAX_ARGUMENT_LENGTH=void 0;var N0=ou(),Os=200;te.MAX_ARGUMENT_LENGTH=Os;var P0="ioredis";function au(t){if(t!==null)switch(typeof t){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(t))return t.toString("hex");if(Array.isArray(t))return t.join(",");try{return JSON.stringify(t)}catch{return}case"string":return t}}te.getStringValue=au;function cu(t,e){let{length:r}=t;return r<=e?t:t.slice(0,e)+' ... <REDACTED full-length="'+r+'">'}te.genRedactedString=cu;function L0(t){let e=(0,N0.default)(`${P0}:${t}`);function r(...s){if(e.enabled){for(let n=1;n<s.length;n++){let i=au(s[n]);typeof i=="string"&&i.length>Os&&(s[n]=cu(i,Os))}return e.apply(null,s)}}return Object.defineProperties(r,{namespace:{get(){return e.namespace}},enabled:{get(){return e.enabled}},destroy:{get(){return e.destroy}},log:{get(){return e.log},set(s){e.log=s}}}),r}te.default=L0});var fu=p(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});var lu=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,M0={RedisCloudFixed:{ca:lu},RedisCloudFlexible:{ca:lu}};Is.default=M0});var O=p(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.noop=b.defaults=b.Debug=b.getPackageMeta=b.zipMap=b.CONNECTION_CLOSED_ERROR_MSG=b.shuffle=b.sample=b.resolveTLSProfile=b.parseURL=b.optimizeErrorStack=b.toArg=b.convertMapToArray=b.convertObjectToArray=b.timeout=b.packObject=b.isInt=b.wrapMultiResult=b.convertBufferToString=void 0;var q0=require("fs"),D0=require("path"),hu=require("url"),Ns=Xt();Object.defineProperty(b,"defaults",{enumerable:!0,get:function(){return Ns.defaults}});Object.defineProperty(b,"noop",{enumerable:!0,get:function(){return Ns.noop}});var B0=uu();b.Debug=B0.default;var j0=fu();function pu(t,e){if(t instanceof Buffer)return t.toString(e);if(Array.isArray(t)){let r=t.length,s=Array(r);for(let n=0;n<r;++n)s[n]=t[n]instanceof Buffer&&e==="utf8"?t[n].toString():pu(t[n],e);return s}return t}b.convertBufferToString=pu;function F0(t){if(!t)return null;let e=[],r=t.length;for(let s=0;s<r;++s){let n=t[s];n instanceof Error?e.push([n]):e.push([null,n])}return e}b.wrapMultiResult=F0;function du(t){let e=parseFloat(t);return!isNaN(t)&&(e|0)===e}b.isInt=du;function $0(t){let e={},r=t.length;for(let s=1;s<r;s+=2)e[t[s-1]]=t[s];return e}b.packObject=$0;function U0(t,e){let r=null,s=function(){r&&(clearTimeout(r),r=null,t.apply(this,arguments))};return r=setTimeout(s,e,new Error("timeout")),s}b.timeout=U0;function G0(t){let e=[],r=Object.keys(t);for(let s=0,n=r.length;s<n;s++)e.push(r[s],t[r[s]]);return e}b.convertObjectToArray=G0;function Q0(t){let e=[],r=0;return t.forEach(function(s,n){e[r]=n,e[r+1]=s,r+=2}),e}b.convertMapToArray=Q0;function z0(t){return t===null||typeof t>"u"?"":String(t)}b.toArg=z0;function V0(t,e,r){let s=e.split(`
`),n="",i;for(i=1;i<s.length&&s[i].indexOf(r)!==-1;++i);for(let o=i;o<s.length;++o)n+=`
`+s[o];if(t.stack){let o=t.stack.indexOf(`
`);t.stack=t.stack.slice(0,o)+n}return t}b.optimizeErrorStack=V0;function H0(t){if(du(t))return{port:t};let e=(0,hu.parse)(t,!0,!0);!e.slashes&&t[0]!=="/"&&(t="//"+t,e=(0,hu.parse)(t,!0,!0));let r=e.query||{},s={};if(e.auth){let n=e.auth.indexOf(":");s.username=n===-1?e.auth:e.auth.slice(0,n),s.password=n===-1?"":e.auth.slice(n+1)}if(e.pathname&&(e.protocol==="redis:"||e.protocol==="rediss:"?e.pathname.length>1&&(s.db=e.pathname.slice(1)):s.path=e.pathname),e.host&&(s.host=e.hostname),e.port&&(s.port=e.port),typeof r.family=="string"){let n=Number.parseInt(r.family,10);Number.isNaN(n)||(s.family=n)}return(0,Ns.defaults)(s,r),s}b.parseURL=H0;function K0(t){let e=t?.tls;typeof e=="string"&&(e={profile:e});let r=j0.default[e?.profile];return r&&(e=Object.assign({},r,e),delete e.profile,t=Object.assign({},t,{tls:e})),t}b.resolveTLSProfile=K0;function Y0(t,e=0){let r=t.length;return e>=r?null:t[e+Math.floor(Math.random()*(r-e))]}b.sample=Y0;function W0(t){let e=t.length;for(;e>0;){let r=Math.floor(Math.random()*e);e--,[t[e],t[r]]=[t[r],t[e]]}return t}b.shuffle=W0;b.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function X0(t,e){let r=new Map;return t.forEach((s,n)=>{r.set(s,e[n])}),r}b.zipMap=X0;var je=null;async function J0(){if(je)return je;try{let t=(0,D0.resolve)(__dirname,"..","..","package.json"),e=await q0.promises.readFile(t,"utf8");return je={version:JSON.parse(e).version},je}catch{return je={version:"error-fetching-version"},je}}b.getPackageMeta=J0});var re=p(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});var yu=Me(),Z0=st(),eS=ce(),ve=O(),J=class t{constructor(e,r=[],s={},n){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=s.replyEncoding,this.errorStack=s.errorStack,this.args=r.flat(),this.callback=n,this.initPromise(),s.keyPrefix){let i=s.keyPrefix instanceof Buffer,o=i?s.keyPrefix:null;this._iterateKeys(c=>c instanceof Buffer?(o===null&&(o=Buffer.from(s.keyPrefix)),Buffer.concat([o,c])):i?Buffer.concat([s.keyPrefix,Buffer.from(String(c))]):s.keyPrefix+c)}s.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,r){return!!this.getFlagMap()[e][r]}static setArgumentTransformer(e,r){this._transformer.argument[e]=r}static setReplyTransformer(e,r){this._transformer.reply[e]=r}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(t.FLAGS).reduce((e,r)=>(e[r]={},t.FLAGS[r].forEach(s=>{e[r][s]=!0}),e),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){let e=this.getKeys()[0];this.slot=e==null?null:Z0(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let r,s="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let n=new Ps;n.push(s);for(let i=0;i<this.args.length;++i){let o=this.args[i];o instanceof Buffer?o.length===0?n.push(`$0\r
\r
`):(n.push("$"+o.length+`\r
`),n.push(o),n.push(`\r
`)):n.push("$"+Buffer.byteLength(o)+`\r
`+o+`\r
`)}r=n.toBuffer()}else{r=s;for(let n=0;n<this.args.length;++n){let i=this.args[n];r+="$"+Buffer.byteLength(i)+`\r
`+i+`\r
`}}return r}stringifyArguments(){for(let e=0;e<this.args.length;++e){let r=this.args[e];typeof r=="string"||(r instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,ve.toArg)(r))}}transformReply(e){this.replyEncoding&&(e=(0,ve.convertBufferToString)(e,this.replyEncoding));let r=t._transformer.reply[this.name];return r&&(e=r(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},e))}initPromise(){let e=new Promise((r,s)=>{if(!this.transformed){this.transformed=!0;let n=t._transformer.argument[this.name];n&&(this.args=n(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(r),this.errorStack?this.reject=n=>{s((0,ve.optimizeErrorStack)(n,this.errorStack.stack,__dirname))}:this.reject=s});this.promise=(0,eS.default)(e,this.callback)}_iterateKeys(e=r=>r){if(typeof this.keys>"u"&&(this.keys=[],(0,yu.exists)(this.name))){let r=(0,yu.getKeyIndexes)(this.name,this.args);for(let s of r)this.args[s]=e(this.args[s]),this.keys.push(this.args[s])}return this.keys}_convertValue(e){return r=>{try{let s=this._commandTimeoutTimer;s&&(clearTimeout(s),delete this._commandTimeoutTimer),e(this.transformReply(r)),this.isResolved=!0}catch(s){this.reject(s)}return this.promise}}};Ls.default=J;J.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"],HANDSHAKE_COMMANDS:["auth","select","client","readonly","info"],IGNORE_RECONNECT_ON_ERROR:["client"]};J._transformer={argument:{},reply:{}};var mu=function(t){if(t.length===1){if(t[0]instanceof Map)return(0,ve.convertMapToArray)(t[0]);if(typeof t[0]=="object"&&t[0]!==null)return(0,ve.convertObjectToArray)(t[0])}return t},gu=function(t){if(t.length===2){if(t[1]instanceof Map)return[t[0]].concat((0,ve.convertMapToArray)(t[1]));if(typeof t[1]=="object"&&t[1]!==null)return[t[0]].concat((0,ve.convertObjectToArray)(t[1]))}return t};J.setArgumentTransformer("mset",mu);J.setArgumentTransformer("msetnx",mu);J.setArgumentTransformer("hset",gu);J.setArgumentTransformer("hmset",gu);J.setReplyTransformer("hgetall",function(t){if(Array.isArray(t)){let e={};for(let r=0;r<t.length;r+=2){let s=t[r],n=t[r+1];s in e?Object.defineProperty(e,s,{value:n,configurable:!0,enumerable:!0,writable:!0}):e[s]=n}return e}return t});var Ps=class{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){let e=Buffer.allocUnsafe(this.length),r=0;for(let s of this.items){let n=Buffer.byteLength(s);Buffer.isBuffer(s)?s.copy(e,r):e.write(s,r,n),r+=n}return e}}});var Su=p(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});var tS=Ae(),rr=class extends tS.RedisError{constructor(e,r){super(e),this.lastNodeError=r,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};Ms.default=rr;rr.defaultMessage="Failed to refresh slots cache."});var sr=p(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});var rS=require("stream"),qs=class extends rS.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.noValues&&e.push("NOVALUES"),this.opt.redis[this.opt.command](e,(r,s)=>{if(r){this.emit("error",r);return}this._redisCursor=s[0]instanceof Buffer?s[0].toString():s[0],this._redisCursor==="0"&&(this._redisDrained=!0),this.push(s[1])})}close(){this._redisDrained=!0}};Ds.default=qs});var vu=p(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.executeWithAutoPipelining=_.getFirstValueInFlattenedArray=_.shouldUseAutoPipelining=_.notAllowedAutoPipelineCommands=_.kCallbacks=_.kExec=void 0;var Eu=Xt(),sS=st(),bu=ce();_.kExec=Symbol("exec");_.kCallbacks=Symbol("callbacks");_.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select","client"];function wu(t,e){if(t._runningAutoPipelines.has(e)||!t._autoPipelines.has(e))return;t._runningAutoPipelines.add(e);let r=t._autoPipelines.get(e);t._autoPipelines.delete(e);let s=r[_.kCallbacks];r[_.kCallbacks]=null,r.exec(function(n,i){if(t._runningAutoPipelines.delete(e),n)for(let o=0;o<s.length;o++)process.nextTick(s[o],n);else for(let o=0;o<s.length;o++)process.nextTick(s[o],...i[o]);t._autoPipelines.has(e)&&wu(t,e)})}function nS(t,e,r){return e&&t.options.enableAutoPipelining&&!t.isPipeline&&!_.notAllowedAutoPipelineCommands.includes(r)&&!t.options.autoPipeliningIgnoredCommands.includes(r)}_.shouldUseAutoPipelining=nS;function ku(t){for(let e=0;e<t.length;e++){let r=t[e];if(typeof r=="string")return r;if(Array.isArray(r)||(0,Eu.isArguments)(r)){if(r.length===0)continue;return r[0]}let s=[r].flat();if(s.length>0)return s[0]}}_.getFirstValueInFlattenedArray=ku;function Au(t,e,r,s,n){if(t.isCluster&&!t.slots.length)return t.status==="wait"&&t.connect().catch(Eu.noop),(0,bu.default)(new Promise(function(u,f){t.delayUntilReady(l=>{if(l){f(l);return}Au(t,e,r,s,null).then(u,f)})}),n);let i=t.options.keyPrefix||"",o=t.isCluster?t.slots[sS(`${i}${ku(s)}`)].join(","):"main";if(!t._autoPipelines.has(o)){let u=t.pipeline();u[_.kExec]=!1,u[_.kCallbacks]=[],t._autoPipelines.set(o,u)}let c=t._autoPipelines.get(o);c[_.kExec]||(c[_.kExec]=!0,setImmediate(wu,t,o));let a=new Promise(function(u,f){c[_.kCallbacks].push(function(l,d){if(l){f(l);return}u(d)}),e==="call"&&s.unshift(r),c[e](...s)});return(0,bu.default)(a,n)}_.executeWithAutoPipelining=Au});var xu=p(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});var iS=require("crypto"),oS=re(),aS=ce(),Bs=class{constructor(e,r=null,s="",n=!1){this.lua=e,this.numberOfKeys=r,this.keyPrefix=s,this.readOnly=n,this.sha=(0,iS.createHash)("sha1").update(e).digest("hex");let i=this.sha,o=new WeakSet;this.Command=class extends oS.default{toWritable(a){let u=this.reject;return this.reject=f=>{f.message.indexOf("NOSCRIPT")!==-1&&o.delete(a),u.call(this,f)},o.has(a)?this.name==="eval"&&(this.name="evalsha",this.args[0]=i):(o.add(a),this.name="eval",this.args[0]=e),super.toWritable(a)}}}execute(e,r,s,n){typeof this.numberOfKeys=="number"&&r.unshift(this.numberOfKeys),this.keyPrefix&&(s.keyPrefix=this.keyPrefix),this.readOnly&&(s.readOnly=!0);let i=new this.Command("evalsha",[this.sha,...r],s);return i.promise=i.promise.catch(o=>{if(o.message.indexOf("NOSCRIPT")===-1)throw o;let c=new this.Command("evalsha",[this.sha,...r],s);return(e.isPipeline?e.redis:e).sendCommand(c)}),(0,aS.default)(i.promise,n),e.sendCommand(i)}};js.default=Bs});var ir=p($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});var cS=Me(),nr=vu(),uS=re(),lS=xu(),se=class{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return Fs.slice(0)}createBuiltinCommand(e){return{string:le(null,e,"utf8"),buffer:le(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=le(e,e,"utf8"),this[e+"Buffer"]=le(e+"Buffer",e,null)}defineCommand(e,r){let s=new lS.default(r.lua,r.numberOfKeys,this.options.keyPrefix,r.readOnly);this.scriptsSet[e]=s,this[e]=_u(e,e,s,"utf8"),this[e+"Buffer"]=_u(e+"Buffer",e,s,null)}sendCommand(e,r,s){throw new Error('"sendCommand" is not implemented')}},Fs=cS.list.filter(t=>t!=="monitor");Fs.push("sentinel");Fs.forEach(function(t){se.prototype[t]=le(t,t,"utf8"),se.prototype[t+"Buffer"]=le(t+"Buffer",t,null)});se.prototype.call=le("call","utf8");se.prototype.callBuffer=le("callBuffer",null);se.prototype.send_command=se.prototype.call;function le(t,e,r){return typeof r>"u"&&(r=e,e=null),function(...s){let n=e||s.shift(),i=s[s.length-1];typeof i=="function"?s.pop():i=void 0;let o={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,nr.shouldUseAutoPipelining)(this,t,n)?(0,nr.executeWithAutoPipelining)(this,t,n,s,i):this.sendCommand(new uS.default(n,s,o,i))}}function _u(t,e,r,s){return function(...n){let i=typeof n[n.length-1]=="function"?n.pop():void 0,o={replyEncoding:s};return this.options.showFriendlyErrorStack&&(o.errorStack=new Error),(0,nr.shouldUseAutoPipelining)(this,t,e)?(0,nr.executeWithAutoPipelining)(this,t,e,n,i):r.execute(this,n,o,i)}}$s.default=se});var Qs=p(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});var Us=st(),Cu=Me(),Ru=ce(),fS=require("util"),hS=re(),pS=O(),dS=ir();function yS(t,e){let r=Us(e[0]),s=t._groupsBySlot[r];for(let n=1;n<e.length;n++)if(t._groupsBySlot[Us(e[n])]!==s)return-1;return r}var fe=class extends dS.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(s=>{let n=e.scriptsSet[s];this._shaToScript[n.sha]=n,this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),e.addedBuiltinSet.forEach(s=>{this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),this.promise=new Promise((s,n)=>{this.resolve=s,this.reject=n});let r=this;Object.defineProperty(this,"length",{get:function(){return r._queue.length}})}fillResult(e,r){if(this._queue[r].name==="exec"&&Array.isArray(e[1])){let n=e[1].length;for(let i=0;i<n;i++){if(e[1][i]instanceof Error)continue;let o=this._queue[r-(n-i)];try{e[1][i]=o.transformReply(e[1][i])}catch(c){e[1][i]=c}}}if(this._result[r]=e,--this.replyPending)return;if(this.isCluster){let n=!0,i;for(let o=0;o<this._result.length;++o){let c=this._result[o][0],a=this._queue[o];if(c){if(a.name==="exec"&&c.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!i)i={name:c.name,message:c.message};else if(i.name!==c.name||i.message!==c.message){n=!1;break}}else if(!a.inTransaction&&!((0,Cu.exists)(a.name)&&(0,Cu.hasFlag)(a.name,"readonly"))){n=!1;break}}if(i&&n){let o=this,c=i.message.split(" "),a=this._queue,u=!1;this._queue=[];for(let h=0;h<a.length;++h){if(c[0]==="ASK"&&!u&&a[h].name!=="asking"&&(!a[h-1]||a[h-1].name!=="asking")){let g=new hS.default("asking");g.ignore=!0,this.sendCommand(g)}a[h].initPromise(),this.sendCommand(a[h]),u=a[h].inTransaction}let f=!0;typeof this.leftRedirections>"u"&&(this.leftRedirections={});let l=function(){o.exec()},d=this.redis;if(d.handleError(i,this.leftRedirections,{moved:function(h,g){o.preferKey=g,d.slots[c[1]]=[g],d._groupsBySlot[c[1]]=d._groupsIds[d.slots[c[1]].join(";")],d.refreshSlotsCache(),o.exec()},ask:function(h,g){o.preferKey=g,o.exec()},tryagain:l,clusterDown:l,connectionClosed:l,maxRedirections:()=>{f=!1},defaults:()=>{f=!1}}),f)return}}let s=0;for(let n=0;n<this._queue.length-s;++n)this._queue[n+s].ignore&&(s+=1),this._result[n]=this._result[n+s];this.resolve(this._result.slice(0,this._result.length-s))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);let r=this._queue.length;return e.pipelineIndex=r,e.promise.then(s=>{this.fillResult([null,s],r)}).catch(s=>{this.fillResult([s],r)}),this._queue.push(e),this}addBatch(e){let r,s,n;for(let i=0;i<e.length;++i)r=e[i],s=r[0],n=r.slice(1),this[s].apply(this,n);return this}};Gs.default=fe;var mS=fe.prototype.multi;fe.prototype.multi=function(){return this._transactions+=1,mS.apply(this,arguments)};var Tu=fe.prototype.execBuffer;fe.prototype.execBuffer=(0,fS.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),Tu.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");fe.prototype.exec=function(t){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(pS.noop),t&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,Ru.default)(this.promise,t)),this.redis.delayUntilReady(n=>{if(n){this.reject(n);return}this.exec(t)}),this.promise;if(this._transactions>0)return this._transactions-=1,Tu.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,Ru.default)(this.promise,t)),this._queue.length||this.resolve([]);let e;if(this.isCluster){let n=[];for(let i=0;i<this._queue.length;i++){let o=this._queue[i].getKeys();if(o.length&&n.push(o[0]),o.length&&Us.generateMulti(o)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(n.length){if(e=yS(this.redis,n),e<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else e=Math.random()*16384|0}let r=this;return s(),this.promise;function s(){let n=r.replyPending=r._queue.length,i;r.isCluster&&(i={slot:e,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let o="",c,a={isPipeline:!0,destination:r.isCluster?i:{redis:r.redis},write(u){typeof u!="string"?(c||(c=[]),o&&(c.push(Buffer.from(o,"utf8")),o=""),c.push(u)):o+=u,--n||(c?(o&&c.push(Buffer.from(o,"utf8")),a.destination.redis.stream.write(Buffer.concat(c))):a.destination.redis.stream.write(o),n=r._queue.length,o="",c=void 0)}};for(let u=0;u<r._queue.length;++u)r.redis.sendCommand(r._queue[u],a,i);return r.promise}}});var Hs=p(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.addTransactionSupport=void 0;var zs=O(),Vs=ce(),Ou=Qs();function gS(t){t.pipeline=function(s){let n=new Ou.default(this);return Array.isArray(s)&&n.addBatch(s),n};let{multi:e}=t;t.multi=function(s,n){if(typeof n>"u"&&!Array.isArray(s)&&(n=s,s=null),n&&n.pipeline===!1)return e.call(this);let i=new Ou.default(this);i.multi(),Array.isArray(s)&&i.addBatch(s);let o=i.exec;i.exec=function(a){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(zs.noop),(0,Vs.default)(new Promise((f,l)=>{this.redis.delayUntilReady(d=>{if(d){l(d);return}this.exec(i).then(f,l)})}),a);if(this._transactions>0&&o.call(i),this.nodeifiedPromise)return o.call(i);let u=o.call(i);return(0,Vs.default)(u.then(function(f){let l=f[f.length-1];if(typeof l>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(l[0]){l[0].previousErrors=[];for(let d=0;d<f.length-1;++d)f[d][0]&&l[0].previousErrors.push(f[d][0]);throw l[0]}return(0,zs.wrapMultiResult)(l[1])}),a)};let{execBuffer:c}=i;return i.execBuffer=function(a){return this._transactions>0&&c.call(i),i.exec(a)},i};let{exec:r}=t;t.exec=function(s){return(0,Vs.default)(r.call(this).then(function(n){return Array.isArray(n)&&(n=(0,zs.wrapMultiResult)(n)),n}),s)}}or.addTransactionSupport=gS});var Ys=p(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});function SS(t,e){Object.getOwnPropertyNames(e.prototype).forEach(r=>{Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r))})}Ks.default=SS});var Nu=p(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.DEFAULT_CLUSTER_OPTIONS=void 0;var Iu=require("dns");ar.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:t=>Math.min(100+t*2,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:Iu.resolveSrv,dnsLookup:Iu.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var ot=p(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.getConnectionName=L.weightSrvRecords=L.groupSrvRecords=L.getUniqueHostnamesFromOptions=L.normalizeNodeOptions=L.nodeKeyToRedisOptions=L.getNodeKey=void 0;var Pu=O(),bS=require("net");function ES(t){return t.port=t.port||6379,t.host=t.host||"127.0.0.1",t.host+":"+t.port}L.getNodeKey=ES;function wS(t){let e=t.lastIndexOf(":");if(e===-1)throw new Error(`Invalid node key ${t}`);return{host:t.slice(0,e),port:Number(t.slice(e+1))}}L.nodeKeyToRedisOptions=wS;function kS(t){return t.map(e=>{let r={};if(typeof e=="object")Object.assign(r,e);else if(typeof e=="string")Object.assign(r,(0,Pu.parseURL)(e));else if(typeof e=="number")r.port=e;else throw new Error("Invalid argument "+e);return typeof r.port=="string"&&(r.port=parseInt(r.port,10)),delete r.db,r.port||(r.port=6379),r.host||(r.host="127.0.0.1"),(0,Pu.resolveTLSProfile)(r)})}L.normalizeNodeOptions=kS;function AS(t){let e={};return t.forEach(r=>{e[r.host]=!0}),Object.keys(e).filter(r=>!(0,bS.isIP)(r))}L.getUniqueHostnamesFromOptions=AS;function vS(t){let e={};for(let r of t)e.hasOwnProperty(r.priority)?(e[r.priority].totalWeight+=r.weight,e[r.priority].records.push(r)):e[r.priority]={totalWeight:r.weight,records:[r]};return e}L.groupSrvRecords=vS;function xS(t){if(t.records.length===1)return t.totalWeight=0,t.records.shift();let e=Math.floor(Math.random()*(t.totalWeight+t.records.length)),r=0;for(let[s,n]of t.records.entries())if(r+=1+n.weight,r>e)return t.totalWeight-=n.weight,t.records.splice(s,1),n}L.weightSrvRecords=xS;function _S(t,e){let r=`ioredis-cluster(${t})`;return e?`${r}:${e}`:r}L.getConnectionName=_S});var Zs=p(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});var Lu=ot(),Ws=O(),CS=he(),Z=(0,Ws.Debug)("cluster:subscriber"),Xs=class{constructor(e,r,s=!1){this.connectionPool=e,this.emitter=r,this.isSharded=s,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){Z("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}Z("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(n,i)=>{!this.started||!this.subscriber||(0,Lu.getNodeKey)(this.subscriber.options)===i&&(Z("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(Z("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}associateSlotRange(e){return this.isSharded&&(this.slotRange=e),this.slotRange}start(){this.started=!0,this.selectSubscriber(),Z("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null)}isStarted(){return this.started}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let r=(0,Ws.sample)(this.connectionPool.getNodes());if(!r){Z("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:s}=r;Z("selected a subscriber %s:%s",s.host,s.port);let n="subscriber";this.isSharded&&(n="ssubscriber"),this.subscriber=new CS.default({port:s.port,host:s.host,username:s.username,password:s.password,enableReadyCheck:!0,connectionName:(0,Lu.getConnectionName)(n,s.connectionName),lazyConnect:!0,tls:s.tls,retryStrategy:null}),this.subscriber.on("error",Ws.noop),this.subscriber.on("moved",()=>{this.emitter.emit("forceRefresh")}),this.subscriber.once("end",this.onSubscriberEnd);let i={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let o=e.condition||e.prevCondition;o&&o.subscriber&&(i.subscribe=o.subscriber.channels("subscribe"),i.psubscribe=o.subscriber.channels("psubscribe"),i.ssubscribe=o.subscriber.channels("ssubscribe"))}if(i.subscribe.length||i.psubscribe.length||i.ssubscribe.length){let o=0;for(let c of["subscribe","psubscribe","ssubscribe"]){let a=i[c];if(a.length!=0)if(Z("%s %d channels",c,a.length),c==="ssubscribe")for(let u of a)o+=1,this.subscriber[c](u).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{Z("failed to ssubscribe to channel: %s",u)});else o+=1,this.subscriber[c](a).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{Z("failed to %s %d channels",c,a.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let o of["message","messageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)});for(let o of["pmessage","pmessageBuffer"])this.subscriber.on(o,(c,a,u)=>{this.emitter.emit(o,c,a,u)});if(this.isSharded==!0)for(let o of["smessage","smessageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)})}};Js.default=Xs});var sn=p(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});var RS=require("events"),cr=O(),en=ot(),TS=he(),at=(0,cr.Debug)("cluster:connectionPool"),tn=class extends RS.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){let r=this.nodes[e];return Object.keys(r).map(s=>r[s])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let r=Object.keys(this.nodes[e]),s=(0,cr.sample)(r);return this.nodes[e][s]}addMasterNode(e){let r=(0,en.getNodeKey)(e.options),s=this.createRedisFromOptions(e,e.options.readOnly);return e.options.readOnly?!1:(this.nodes.all[r]=s,this.nodes.master[r]=s,!0)}createRedisFromOptions(e,r){return new TS.default((0,cr.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:r},e,this.redisOptions,{lazyConnect:!0}))}findOrCreate(e,r=!1){let s=(0,en.getNodeKey)(e);r=!!r,this.specifiedOptions[s]?Object.assign(e,this.specifiedOptions[s]):this.specifiedOptions[s]=e;let n;return this.nodes.all[s]?(n=this.nodes.all[s],n.options.readOnly!==r&&(n.options.readOnly=r,at("Change role of %s to %s",s,r?"slave":"master"),n[r?"readonly":"readwrite"]().catch(cr.noop),r?(delete this.nodes.master[s],this.nodes.slave[s]=n):(delete this.nodes.slave[s],this.nodes.master[s]=n))):(at("Connecting to %s as %s",s,r?"slave":"master"),n=this.createRedisFromOptions(e,r),this.nodes.all[s]=n,this.nodes[r?"slave":"master"][s]=n,n.once("end",()=>{this.removeNode(s),this.emit("-node",n,s),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",n,s),n.on("error",function(i){this.emit("nodeError",i,s)})),n}reset(e){at("Reset with %O",e);let r={};e.forEach(s=>{let n=(0,en.getNodeKey)(s);s.readOnly&&r[n]||(r[n]=s)}),Object.keys(this.nodes.all).forEach(s=>{r[s]||(at("Disconnect %s because the node does not hold any slot",s),this.nodes.all[s].disconnect(),this.removeNode(s))}),Object.keys(r).forEach(s=>{let n=r[s];this.findOrCreate(n,n.readOnly)})}removeNode(e){let{nodes:r}=this;r.all[e]&&(at("Remove %s from the pool",e),delete r.all[e]),delete r.master[e],delete r.slave[e]}};rn.default=tn});var ur=p((Rw,Mu)=>{"use strict";function v(t,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}v.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var s=this.size();if(!(r>=s||r<-s))return r<0&&(r+=s),r=this._head+r&this._capacityMask,this._list[r]}};v.prototype.get=function(e){return this.peekAt(e)};v.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};v.prototype.peekFront=function(){return this.peek()};v.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(v.prototype,"length",{get:function(){return this.size()}});v.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};v.prototype.unshift=function(e){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};v.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};v.prototype.push=function(e){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};v.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),s}};v.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var s=this.size(),n=this._list.length;if(!(r>=s||r<-s)){r<0&&(r+=s),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<s/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=s-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}};v.prototype.remove=function(e,r){var s=e,n,i=r;if(s===(s|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(s>=o||s<-o||r<1)){if(s<0&&(s+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(s),n;if(s===0&&s+r>=o)return n=this.toArray(),this.clear(),n;s+r>o&&(r=o-s);var a;for(n=new Array(r),a=0;a<r;a++)n[a]=this._list[this._head+s+a&this._capacityMask];if(s=this._head+s&this._capacityMask,e+r===o){for(this._tail=this._tail-r+c&this._capacityMask,a=r;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+c&this._capacityMask,a=r-1;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(s<o/2){for(this._head=this._head+e+r+c&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[s=s-1+c&this._capacityMask]);for(s=this._head-1+c&this._capacityMask;i>0;)this._list[s=s-1+c&this._capacityMask]=void 0,i--;e<0&&(this._tail=s)}else{for(this._tail=s,s=s+r+c&this._capacityMask,a=o-(r+e);a>0;a--)this.push(this._list[s++]);for(s=this._tail;i>0;)this._list[s=s+1+c&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),n}}};v.prototype.splice=function(e,r){var s=e;if(s===(s|0)){var n=this.size();if(s<0&&(s+=n),!(s>n))if(arguments.length>2){var i,o,c,a=arguments.length,u=this._list.length,f=2;if(!n||s<n/2){for(o=new Array(s),i=0;i<s;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(c=[],s>0&&(this._head=this._head+s+u&this._capacityMask)):(c=this.remove(s,r),this._head=this._head+s+u&this._capacityMask);a>f;)this.unshift(arguments[--a]);for(i=s;i>0;i--)this.unshift(o[i-1])}else{o=new Array(n-(s+r));var l=o.length;for(i=0;i<l;i++)o[i]=this._list[this._head+s+r+i&this._capacityMask];for(r===0?(c=[],s!=n&&(this._tail=this._head+s+u&this._capacityMask)):(c=this.remove(s,r),this._tail=this._tail-l+u&this._capacityMask);f<a;)this.push(arguments[f++]);for(i=0;i<l;i++)this.push(o[i])}return c}else return this.remove(s,r)}};v.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};v.prototype.isEmpty=function(){return this._head===this._tail};v.prototype.toArray=function(){return this._copyArray(!1)};v.prototype._fromArray=function(e){var r=e.length,s=this._nextPowerOf2(r);this._list=new Array(s),this._capacityMask=s-1,this._tail=r;for(var n=0;n<r;n++)this._list[n]=e[n]};v.prototype._copyArray=function(e,r){var s=this._list,n=s.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),c=0,a;if(e||this._head>this._tail){for(a=this._head;a<n;a++)o[c++]=s[a];for(a=0;a<this._tail;a++)o[c++]=s[a]}else for(a=this._head;a<this._tail;a++)o[c++]=s[a];return o};v.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};v.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};v.prototype._nextPowerOf2=function(e){var r=Math.log(e)/Math.log(2),s=1<<r+1;return Math.max(s,4)};Mu.exports=v});var qu=p(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});var OS=O(),IS=ur(),NS=(0,OS.Debug)("delayqueue"),nn=class{constructor(){this.queues={},this.timeouts={}}push(e,r,s){let n=s.callback||process.nextTick;this.queues[e]||(this.queues[e]=new IS),this.queues[e].push(r),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{n(()=>{this.timeouts[e]=null,this.execute(e)})},s.timeout))}execute(e){let r=this.queues[e];if(!r)return;let{length:s}=r;if(s)for(NS("send %d commands in %s queue",s,e),this.queues[e]=null;r.length>0;)r.shift()()}};on.default=nn});var ju=p(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});var PS=O(),LS=Zs(),MS=sn(),Du=ot(),lr=st(),Bu=(0,PS.Debug)("cluster:subscriberGroup"),an=class{constructor(e,r){this.cluster=e,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,e.on("+node",s=>{this._addSubscriber(s)}),e.on("-node",s=>{this._removeSubscriber(s)}),e.on("refresh",()=>{this._refreshSlots(e)}),e.on("forceRefresh",()=>{r()})}getResponsibleSubscriber(e){let r=this.clusterSlots[e][0];return this.shardedSubscribers.get(r)}addChannels(e){let r=lr(e[0]);e.forEach(n=>{if(lr(n)!=r)return-1});let s=this.channels.get(r);return s?this.channels.set(r,s.concat(e)):this.channels.set(r,e),[...this.channels.values()].flatMap(n=>n).length}removeChannels(e){let r=lr(e[0]);e.forEach(n=>{if(lr(n)!=r)return-1});let s=this.channels.get(r);if(s){let n=s.filter(i=>!e.includes(i));this.channels.set(r,n)}return[...this.channels.values()].flatMap(n=>n).length}stop(){for(let e of this.shardedSubscribers.values())e.stop()}start(){for(let e of this.shardedSubscribers.values())e.isStarted()||e.start()}_addSubscriber(e){let r=new MS.default(e.options);if(r.addMasterNode(e)){let s=new LS.default(r,this.cluster,!0),n=(0,Du.getNodeKey)(e.options);return this.shardedSubscribers.set(n,s),s.start(),this._resubscribe(),this.cluster.emit("+subscriber"),s}return null}_removeSubscriber(e){let r=(0,Du.getNodeKey)(e.options),s=this.shardedSubscribers.get(r);return s&&(s.stop(),this.shardedSubscribers.delete(r),this._resubscribe(),this.cluster.emit("-subscriber")),this.shardedSubscribers}_refreshSlots(e){if(this._slotsAreEqual(e.slots))Bu("Nothing to refresh because the new cluster map is equal to the previous one.");else{Bu("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let r=0;r<e.slots.length;r++){let s=e.slots[r][0];this.subscriberToSlotsIndex.has(s)||this.subscriberToSlotsIndex.set(s,[]),this.subscriberToSlotsIndex.get(s).push(Number(r))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(e.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){this.shardedSubscribers&&this.shardedSubscribers.forEach((e,r)=>{let s=this.subscriberToSlotsIndex.get(r);s&&(e.associateSlotRange(s),s.forEach(n=>{let i=e.getInstance(),o=this.channels.get(n);o&&o.length>0&&i&&(i.ssubscribe(o),i.on("ready",()=>{i.ssubscribe(o)}))}))})}_slotsAreEqual(e){return this.clusterSlots===void 0?!1:JSON.stringify(this.clusterSlots)===JSON.stringify(e)}};cn.default=an});var fn=p(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});var Fu=Me(),zu=require("events"),ct=Ae(),$u=ce(),Uu=re(),un=Su(),qS=he(),DS=sr(),BS=Hs(),$=O(),jS=Ys(),FS=ir(),$S=Nu(),US=Zs(),GS=sn(),QS=qu(),Fe=ot(),Gu=ur(),zS=ju(),x=(0,$.Debug)("cluster"),Qu=new WeakSet,ut=class t extends FS.default{constructor(e,r={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new QS.default,this.offlineQueue=new Gu,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,zu.EventEmitter.call(this),this.startupNodes=e,this.options=(0,$.defaults)({},r,$S.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0&&(this.shardedSubscribers=new zS.default(this,this.refreshSlotsCache.bind(this))),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new GS.default(this.options.redisOptions),this.connectionPool.on("-node",(s,n)=>{this.emit("-node",s)}),this.connectionPool.on("+node",s=>{this.emit("+node",s)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(s,n)=>{this.emit("node error",s,n)}),this.subscriber=new US.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([s,n])=>{this.defineCommand(s,n)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(s=>{x("connecting failed: %s",s)})}connect(){return new Promise((e,r)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){r(new Error("Redis is already connecting/connected"));return}let s=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(n=>{if(this.connectionEpoch!==s){x("discard connecting after resolving startup nodes because epoch not match: %d != %d",s,this.connectionEpoch),r(new ct.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){x("discard connecting after resolving startup nodes because the status changed to %s",this.status),r(new ct.RedisError("Connection is aborted"));return}this.connectionPool.reset(n);let i=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()},o,c=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",o),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((a,u)=>{a||u?(x("Ready check failed (%s). Reconnecting...",a||u),this.status==="connect"&&this.disconnect(!0)):i()}):i()};o=()=>{let a=new Error("None of startup nodes is available");this.removeListener("refresh",c),this.invokeReadyDelayedCallbacks(a),r(a)},this.once("refresh",c),this.once("close",o),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(a=>{a&&a.message===un.default.defaultMessage&&(qS.default.prototype.silentEmit.call(this,"error",a),this.connectionPool.reset([]))}),this.subscriber.start(),this.options.shardedSubscribers&&this.shardedSubscribers.start()}).catch(n=>{this.setStatus("close"),this.handleCloseEvent(n),this.invokeReadyDelayedCallbacks(n),r(n)})})}disconnect(e=!1){let r=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,x("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){let r=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"){let s=(0,$u.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),s}return(0,$u.default)(Promise.all(this.nodes().map(s=>s.quit().catch(n=>{if(n.message===$.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw n}))).then(()=>"OK"),e)}duplicate(e=[],r={}){let s=e.length>0?e:this.startupNodes.slice(0),n=Object.assign({},this.options,r);return new t(s,n)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave")throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;let r=this,s=c=>{this.isRefreshing=!1;for(let a of this._refreshSlotsCacheCallbacks)a(c);this._refreshSlotsCacheCallbacks=[]},n=(0,$.shuffle)(this.connectionPool.getNodes()),i=null;function o(c){if(c===n.length){let f=new un.default(un.default.defaultMessage,i);return s(f)}let a=n[c],u=`${a.options.host}:${a.options.port}`;x("getting slot cache from %s",u),r.getInfoFromNode(a,function(f){switch(r.status){case"close":case"end":return s(new Error("Cluster is disconnected."));case"disconnecting":return s(new Error("Cluster is disconnecting."))}f?(r.emit("node error",f,u),i=f,o(c+1)):(r.emit("refresh"),s())})}o(0)}sendCommand(e,r,s){if(this.status==="wait"&&this.connect().catch($.noop),this.status==="end")return e.reject(new Error($.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let n=this.options.scaleReads;n!=="master"&&(e.isReadOnly||(0,Fu.exists)(e.name)&&(0,Fu.hasFlag)(e.name,"readonly")||(n="master"));let i=s?s.slot:e.getSlot(),o={},c=this;if(!s&&!Qu.has(e)){Qu.add(e);let u=e.reject;e.reject=function(f){let l=a.bind(null,!0);c.handleError(f,o,{moved:function(d,h){x("command %s is moved to %s",e.name,h),i=Number(d),c.slots[d]?c.slots[d][0]=h:c.slots[d]=[h],c._groupsBySlot[d]=c._groupsIds[c.slots[d].join(";")],c.connectionPool.findOrCreate(c.natMapper(h)),a(),x("refreshing slot caches... (triggered by MOVED error)"),c.refreshSlotsCache()},ask:function(d,h){x("command %s is required to ask %s:%s",e.name,h);let g=c.natMapper(h);c.connectionPool.findOrCreate(g),a(!1,`${g.host}:${g.port}`)},tryagain:l,clusterDown:l,connectionClosed:l,maxRedirections:function(d){u.call(e,d)},defaults:function(){u.call(e,f)}})}}a();function a(u,f){if(c.status==="end"){e.reject(new ct.AbortError("Cluster is ended."));return}let l;if(c.status==="ready"||e.name==="cluster"){if(s&&s.redis)l=s.redis;else if(Uu.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||Uu.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(c.options.shardedSubscribers==!0&&(e.name=="ssubscribe"||e.name=="sunsubscribe")){let d=c.shardedSubscribers.getResponsibleSubscriber(i),h=-1;e.name=="ssubscribe"&&(h=c.shardedSubscribers.addChannels(e.getKeys())),e.name=="sunsubscribe"&&(h=c.shardedSubscribers.removeChannels(e.getKeys())),h!==-1?l=d.getInstance():e.reject(new ct.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else l=c.subscriber.getInstance();if(!l){e.reject(new ct.AbortError("No subscriber for the cluster"));return}}else{if(!u){if(typeof i=="number"&&c.slots[i]){let d=c.slots[i];if(typeof n=="function"){let h=d.map(function(g){return c.connectionPool.getInstanceByKey(g)});l=n(h,e),Array.isArray(l)&&(l=(0,$.sample)(l)),l||(l=h[0])}else{let h;n==="all"?h=(0,$.sample)(d):n==="slave"&&d.length>1?h=(0,$.sample)(d,1):h=d[0],l=c.connectionPool.getInstanceByKey(h)}}f&&(l=c.connectionPool.getInstanceByKey(f),l.asking())}l||(l=(typeof n=="function"?null:c.connectionPool.getSampleInstance(n))||c.connectionPool.getSampleInstance("all"))}s&&!s.redis&&(s.redis=l)}l?l.sendCommand(e,r):c.options.enableOfflineQueue?c.offlineQueue.push({command:e,stream:r,node:s}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return e.promise}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}handleError(e,r,s){if(typeof r.value>"u"?r.value=this.options.maxRedirections:r.value-=1,r.value<=0){s.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}let n=e.message.split(" ");if(n[0]==="MOVED"){let i=this.options.retryDelayOnMoved;i&&typeof i=="number"?this.delayQueue.push("moved",s.moved.bind(null,n[1],n[2]),{timeout:i}):s.moved(n[1],n[2])}else n[0]==="ASK"?s.ask(n[1],n[2]):n[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",s.tryagain,{timeout:this.options.retryDelayOnTryAgain}):n[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",s.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===$.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",s.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):s.defaults()}resetOfflineQueue(){this.offlineQueue=new Gu}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{x('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){x("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){e&&x("closed because %s",e);let r;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(r=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),typeof r=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,x("Cluster is disconnected. Retrying after %dms",r),this.connect().catch(function(s){x("Got error %s when reconnecting. Ignoring...",s)})},r)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(e){let r;for(;r=this.offlineQueue.shift();)r.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){x("send %d commands in offline queue",this.offlineQueue.length);let e=this.offlineQueue;this.resetOfflineQueue();let r;for(;r=e.shift();)this.sendCommand(r.command,r.stream,r.node)}}natMapper(e){let r=typeof e=="string"?e:`${e.host}:${e.port}`,s=null;return this.options.natMap&&typeof this.options.natMap=="function"?s=this.options.natMap(r):this.options.natMap&&typeof this.options.natMap=="object"&&(s=this.options.natMap[r]),s?(x("NAT mapping %s -> %O",r,s),Object.assign({},s)):typeof e=="string"?(0,Fe.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,r){if(!e)return r(new Error("Node is disconnected"));let s=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,Fe.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});s.on("error",$.noop),s.cluster("SLOTS",(0,$.timeout)((n,i)=>{if(s.disconnect(),n)return x("error encountered running CLUSTER.SLOTS: %s",n),r(n);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){x("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",i.length,this.status),r();return}let o=[];x("cluster slots result count: %d",i.length);for(let a=0;a<i.length;++a){let u=i[a],f=u[0],l=u[1],d=[];for(let h=2;h<u.length;h++){if(!u[h][0])continue;let g=this.natMapper({host:u[h][0],port:u[h][1]});g.readOnly=h!==2,o.push(g),d.push(g.host+":"+g.port)}x("cluster slots result [%d]: slots %d~%d served by %s",a,f,l,d);for(let h=f;h<=l;h++)this.slots[h]=d}this._groupsIds=Object.create(null);let c=0;for(let a=0;a<16384;a++){let u=(this.slots[a]||[]).join(";");if(!u.length){this._groupsBySlot[a]=void 0;continue}this._groupsIds[u]||(this._groupsIds[u]=++c),this._groupsBySlot[a]=this._groupsIds[u]}this.connectionPool.reset(o),r()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(let r of this._readyDelayedCallbacks)process.nextTick(r,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(r,s)=>{if(r)return e(r);if(typeof s!="string")return e();let n,i=s.split(`\r
`);for(let o=0;o<i.length;++o){let c=i[o].split(":");if(c[0]==="cluster_state"){n=c[1];break}}n==="fail"?(x("cluster state not ok (%s)",n),e(null,n)):e()})}resolveSrv(e){return new Promise((r,s)=>{this.options.resolveSrv(e,(n,i)=>{if(n)return s(n);let o=this,c=(0,Fe.groupSrvRecords)(i),a=Object.keys(c).sort((f,l)=>parseInt(f)-parseInt(l));function u(f){if(!a.length)return s(f);let l=a[0],d=c[l],h=(0,Fe.weightSrvRecords)(d);d.records.length||a.shift(),o.dnsLookup(h.name).then(g=>r({host:g,port:h.port}),u)}u()})})}dnsLookup(e){return new Promise((r,s)=>{this.options.dnsLookup(e,(n,i)=>{n?(x("failed to resolve hostname %s to IP: %s",e,n.message),s(n)):(x("resolved hostname %s to IP %s",e,i),r(i))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let e=(0,Fe.normalizeNodeOptions)(this.startupNodes),r=(0,Fe.getUniqueHostnamesFromOptions)(e);if(r.length===0)return e;let s=await Promise.all(r.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),n=(0,$.zipMap)(r,s);return e.map(i=>{let o=n.get(i.host);return o?this.options.useSRVRecords?Object.assign({},i,o):Object.assign({},i,{host:o}):i})}createScanStream(e,{key:r,options:s={}}){return new DS.default({objectMode:!0,key:r,redis:this,command:e,...s})}};(0,jS.default)(ut,zu.EventEmitter);(0,BS.addTransactionSupport)(ut.prototype);ln.default=ut});var fr=p(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});var VS=O(),HS=(0,VS.Debug)("AbstractConnector"),hn=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){let e=this.stream,r=setTimeout(()=>{HS("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(r)),e.end()}}};pn.default=hn});var Vu=p(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});var KS=require("net"),YS=require("tls"),WS=O(),XS=fr(),dn=class extends XS.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){let{options:r}=this;this.connecting=!0;let s;return"path"in r&&r.path?s={path:r.path}:(s={},"port"in r&&r.port!=null&&(s.port=r.port),"host"in r&&r.host!=null&&(s.host=r.host),"family"in r&&r.family!=null&&(s.family=r.family)),r.tls&&Object.assign(s,r.tls),new Promise((n,i)=>{process.nextTick(()=>{if(!this.connecting){i(new Error(WS.CONNECTION_CLOSED_ERROR_MSG));return}try{r.tls?this.stream=(0,YS.connect)(s):this.stream=(0,KS.createConnection)(s)}catch(o){i(o);return}this.stream.once("error",o=>{this.firstError=o}),n(this.stream)})})}};yn.default=dn});var Hu=p(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});function JS(t,e){return(t.host||"127.0.0.1")===(e.host||"127.0.0.1")&&(t.port||26379)===(e.port||26379)}var mn=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){let e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++)if(JS(e,this.sentinels[r]))return!1;return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}};gn.default=mn});var Yu=p(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.FailoverDetector=void 0;var ZS=O(),Sn=(0,ZS.Debug)("FailoverDetector"),Ku="+switch-master",bn=class{constructor(e,r){this.isDisconnected=!1,this.connector=e,this.sentinels=r}cleanup(){this.isDisconnected=!0;for(let e of this.sentinels)e.client.disconnect()}async subscribe(){Sn("Starting FailoverDetector");let e=[];for(let r of this.sentinels){let s=r.client.subscribe(Ku).catch(n=>{Sn("Failed to subscribe to failover messages on sentinel %s:%s (%s)",r.address.host||"127.0.0.1",r.address.port||26739,n.message)});e.push(s),r.client.on("message",n=>{!this.isDisconnected&&n===Ku&&this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,Sn("Failover detected, disconnecting"),this.connector.disconnect()}};hr.FailoverDetector=bn});var pr=p(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.SentinelIterator=void 0;var eb=require("net"),lt=O(),tb=require("tls"),Wu=Hu();ft.SentinelIterator=Wu.default;var rb=fr(),sb=he(),nb=Yu(),$e=(0,lt.Debug)("SentinelConnector"),En=class extends rb.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new Wu.default(this.options.sentinels)}check(e){let r=!e.role||this.options.role===e.role;return r||($e("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),r}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){this.connecting=!0,this.retryAttempts=0;let r,s=async()=>{let n=this.sentinelIterator.next();if(n.done){this.sentinelIterator.reset(!1);let a=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,u=typeof a!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${a}ms.`;r&&(u+=` Last error: ${r.message}`),$e(u);let f=new Error(u);if(typeof a=="number")return e("error",f),await new Promise(l=>setTimeout(l,a)),s();throw f}let i=null,o=null;try{i=await this.resolve(n.value)}catch(a){o=a}if(!this.connecting)throw new Error(lt.CONNECTION_CLOSED_ERROR_MSG);let c=n.value.host+":"+n.value.port;if(i)return $e("resolved: %s:%s from sentinel %s",i.host,i.port,c),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(i,this.options.tls),this.stream=(0,tb.connect)(i),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,eb.createConnection)(i),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",a=>{this.firstError=a}),this.stream;{let a=o?"failed to connect to sentinel "+c+" because "+o.message:"connected to sentinel "+c+" successfully, but got an invalid reply: "+i;return $e(a),e("sentinelError",new Error(a)),o&&(r=o),s()}};return s()}async updateSentinels(e){if(!this.options.updateSentinels)return;let r=await e.sentinel("sentinels",this.options.name);Array.isArray(r)&&(r.map(lt.packObject).forEach(s=>{if((s.flags?s.flags.split(","):[]).indexOf("disconnected")===-1&&s.ip&&s.port){let i=this.sentinelNatResolve(Xu(s));this.sentinelIterator.add(i)&&$e("adding sentinel %s:%s",i.host,i.port)}}),$e("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){let r=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(r)?{host:r[0],port:Number(r[1])}:null)}async resolveSlave(e){let r=await e.sentinel("slaves",this.options.name);if(!Array.isArray(r))return null;let s=r.map(lt.packObject).filter(n=>n.flags&&!n.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(ib(s,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;let r=`${e.host}:${e.port}`,s=e;return typeof this.options.natMap=="function"?s=this.options.natMap(r)||e:typeof this.options.natMap=="object"&&(s=this.options.natMap[r]||e),s}connectToSentinel(e,r){return new sb.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...r})}async resolve(e){let r=this.connectToSentinel(e);r.on("error",ob);try{return this.options.role==="slave"?await this.resolveSlave(r):await this.resolveMaster(r)}finally{r.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let r=[];for(;r.length<this.options.sentinelMaxConnections;){let{done:s,value:n}=this.sentinelIterator.next();if(s)break;let i=this.connectToSentinel(n,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});i.on("reconnecting",()=>{var o;(o=this.emitter)===null||o===void 0||o.emit("sentinelReconnecting")}),r.push({address:n,client:i})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new nb.FailoverDetector(this,r),await this.failoverDetector.subscribe(),(e=this.emitter)===null||e===void 0||e.emit("failoverSubscribed")}};ft.default=En;function ib(t,e){if(t.length===0)return null;let r;if(typeof e=="function")r=e(t);else if(e!==null&&typeof e=="object"){let s=Array.isArray(e)?e:[e];s.sort((n,i)=>(n.prio||(n.prio=1),i.prio||(i.prio=1),n.prio<i.prio?-1:n.prio>i.prio?1:0));for(let n=0;n<s.length;n++){for(let i=0;i<t.length;i++){let o=t[i];if(o.ip===s[n].ip&&o.port===s[n].port){r=o;break}}if(r)break}}return r||(r=(0,lt.sample)(t)),Xu(r)}function Xu(t){return{host:t.ip,port:Number(t.port)}}function ob(){}});var Ju=p(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.SentinelConnector=Ue.StandaloneConnector=void 0;var ab=Vu();Ue.StandaloneConnector=ab.default;var cb=pr();Ue.SentinelConnector=cb.default});var Zu=p(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});var ub=Ae(),wn=class extends ub.AbortError{constructor(e){let r=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(r),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};kn.default=wn});var el=p(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.MaxRetriesPerRequestError=void 0;var lb=Zu();dr.MaxRetriesPerRequestError=lb.default});var al=p((Fw,ol)=>{"use strict";var Rn=require("buffer").Buffer,fb=require("string_decoder").StringDecoder,An=new fb,tl=Ae(),hb=tl.ReplyError,pb=tl.ParserError,Y=Rn.allocUnsafe(32*1024),D=0,yr=null,ht=0,vn=0;function db(t){let e=t.buffer.length-1;var r=t.offset,s=0,n=1;for(t.buffer[r]===45&&(n=-1,r++);r<e;){let i=t.buffer[r++];if(i===13)return t.offset=r+1,n*s;s=s*10+(i-48)}}function yb(t){let e=t.buffer.length-1;var r=t.offset,s=0,n="";for(t.buffer[r]===45&&(n+="-",r++);r<e;){var i=t.buffer[r++];if(i===13)return t.offset=r+1,s!==0&&(n+=s),n;s>429496728?(n+=s*10+(i-48),s=0):i===48&&s===0?n+=0:s=s*10+(i-48)}}function rl(t){let e=t.offset,r=t.buffer,s=r.length-1;for(var n=e;n<s;)if(r[n++]===13)return t.offset=n+1,t.optionReturnBuffers===!0?t.buffer.slice(e,n-1):t.buffer.toString("utf8",e,n-1)}function sl(t){let e=t.buffer.length-1;for(var r=t.offset,s=0;r<e;){let n=t.buffer[r++];if(n===13)return t.offset=r+1,s;s=s*10+(n-48)}}function mb(t){return t.optionStringNumbers===!0?yb(t):db(t)}function gb(t){let e=sl(t);if(e===void 0)return;if(e<0)return null;let r=t.offset+e;if(r+2>t.buffer.length){t.bigStrSize=r+2,t.totalChunkSize=t.buffer.length,t.bufferCache.push(t.buffer);return}let s=t.offset;return t.offset=r+2,t.optionReturnBuffers===!0?t.buffer.slice(s,r):t.buffer.toString("utf8",s,r)}function Sb(t){var e=rl(t);if(e!==void 0)return t.optionReturnBuffers===!0&&(e=e.toString()),new hb(e)}function bb(t,e){let r=new pb("Protocol error, got "+JSON.stringify(String.fromCharCode(e))+" as reply type byte",JSON.stringify(t.buffer),t.offset);t.buffer=null,t.returnFatalError(r)}function Eb(t){let e=sl(t);if(e===void 0)return;if(e<0)return null;let r=new Array(e);return nl(t,r,0)}function xn(t,e,r){t.arrayCache.push(e),t.arrayPos.push(r)}function _n(t){let e=t.arrayCache.pop();var r=t.arrayPos.pop();if(t.arrayCache.length){let s=_n(t);if(s===void 0){xn(t,e,r);return}e[r++]=s}return nl(t,e,r)}function nl(t,e,r){let s=t.buffer.length;for(;r<e.length;){let n=t.offset;if(t.offset>=s){xn(t,e,r);return}let i=il(t,t.buffer[t.offset++]);if(i===void 0){t.arrayCache.length||t.bufferCache.length||(t.offset=n),xn(t,e,r);return}e[r]=i,r++}return e}function il(t,e){switch(e){case 36:return gb(t);case 43:return rl(t);case 42:return Eb(t);case 58:return mb(t);case 45:return Sb(t);default:return bb(t,e)}}function wb(){if(Y.length>50*1024)if(ht===1||vn>ht*2){let t=Math.floor(Y.length/10),e=t<D?D:t;D=0,Y=Y.slice(e,Y.length)}else vn++,ht--;else clearInterval(yr),ht=0,vn=0,yr=null}function kb(t){if(Y.length<t+D){let e=t>78643200?2:3;D>1024*1024*111&&(D=1024*1024*50),Y=Rn.allocUnsafe(t*e+D),D=0,ht++,yr===null&&(yr=setInterval(wb,50))}}function Ab(t){let e=t.bufferCache,r=t.offset;var s=e.length,n=t.bigStrSize-t.totalChunkSize;if(t.offset=n,n<=2){if(s===2)return e[0].toString("utf8",r,e[0].length+n-2);s--,n=e[e.length-2].length+n}for(var i=An.write(e[0].slice(r)),o=1;o<s-1;o++)i+=An.write(e[o]);return i+=An.end(e[o].slice(0,n-2)),i}function vb(t){let e=t.bufferCache,r=t.offset,s=t.bigStrSize-r-2;var n=e.length,i=t.bigStrSize-t.totalChunkSize;if(t.offset=i,i<=2){if(n===2)return e[0].slice(r,e[0].length+i-2);n--,i=e[e.length-2].length+i}kb(s);let o=D;e[0].copy(Y,o,r,e[0].length),D+=e[0].length-r;for(var c=1;c<n-1;c++)e[c].copy(Y,D),D+=e[c].length;return e[c].copy(Y,D,0,i-2),D+=i-2,Y.slice(o,D)}var Cn=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if(typeof e.returnError!="function"||typeof e.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if(typeof e!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if(typeof e!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(this.buffer===null)this.buffer=e,this.offset=0;else if(this.bigStrSize===0){let s=this.buffer.length,n=s-this.offset,i=Rn.allocUnsafe(n+e.length);if(this.buffer.copy(i,0,this.offset,s),e.copy(i,n,0,e.length),this.buffer=i,this.offset=0,this.arrayCache.length){let o=_n(this);if(o===void 0)return;this.returnReply(o)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var r=this.optionReturnBuffers?vb(this):Ab(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=r,r=_n(this),r===void 0))return;this.returnReply(r)}else{this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let s=this.offset,n=this.buffer[this.offset++],i=il(this,n);if(i===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=s);return}n===45?this.returnError(i):this.returnReply(i)}this.buffer=null}};ol.exports=Cn});var ul=p(($w,cl)=>{"use strict";cl.exports=al()});var ll=p(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});var On=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,r){this.set[Tn(e)][r]=!0}del(e,r){delete this.set[Tn(e)][r]}channels(e){return Object.keys(this.set[Tn(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}};In.default=On;function Tn(t){return t==="unsubscribe"?"subscribe":t==="punsubscribe"?"psubscribe":t==="sunsubscribe"?"ssubscribe":t}});var dl=p(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});var fl=re(),xb=O(),_b=ul(),Cb=ll(),Rb=(0,xb.Debug)("dataHandler"),Nn=class{constructor(e,r){this.redis=e;let s=new _b({stringNumbers:r.stringNumbers,returnBuffers:!0,returnError:n=>{this.returnError(n)},returnFatalError:n=>{this.returnFatalError(n)},returnReply:n=>{this.returnReply(n)}});e.stream.prependListener("data",n=>{s.execute(n)}),e.stream.resume()}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){let r=this.shiftCommand(e);if(r){if(e.command={name:r.command.name,args:r.command.args},r.command.name=="ssubscribe"&&e.message.includes("MOVED")){this.redis.emit("moved");return}this.redis.handleReconnection(e,r)}}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let r=this.shiftCommand(e);r&&(fl.default.checkFlag("ENTER_SUBSCRIBER_MODE",r.command.name)?(this.redis.condition.subscriber=new Cb.default,this.redis.condition.subscriber.add(r.command.name,e[1].toString()),hl(r.command,e[2])||this.redis.commandQueue.unshift(r)):fl.default.checkFlag("EXIT_SUBSCRIBER_MODE",r.command.name)?pl(r.command,e[2])||this.redis.commandQueue.unshift(r):r.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;let r=Array.isArray(e)?e[0].toString():null;switch(Rb('receive reply "%s" in subscriber mode',r),r){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{let s=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",s,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",s,e[2],e[3]);break}case"smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let s=e[1].toString();this.redis.condition.subscriber.add(r,s);let n=this.shiftCommand(e);if(!n)return;hl(n.command,e[2])||this.redis.commandQueue.unshift(n);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let s=e[1]?e[1].toString():null;s&&this.redis.condition.subscriber.del(r,s);let n=e[2];Number(n)===0&&(this.redis.condition.subscriber=!1);let i=this.shiftCommand(e);if(!i)return;pl(i.command,n)||this.redis.commandQueue.unshift(i);break}default:{let s=this.shiftCommand(e);if(!s)return;s.command.resolve(e)}}return!0}handleMonitorReply(e){if(this.redis.status!=="monitoring")return!1;let r=e.toString();if(r==="OK")return!1;let s=r.indexOf(" "),n=r.slice(0,s),i=r.indexOf('"'),o=r.slice(i+1,-1).split('" "').map(a=>a.replace(/\\"/g,'"')),c=r.slice(s+2,i-2).split(" ");return this.redis.emit("monitor",n,o,c[1],c[0]),!0}shiftCommand(e){let r=this.redis.commandQueue.shift();if(!r){let s="Command queue state error. If you can reproduce this, please report it.",n=new Error(s+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",n),null}return r}};Pn.default=Nn;var pe=new WeakMap;function hl(t,e){let r=pe.has(t)?pe.get(t):t.args.length;return r-=1,r<=0?(t.resolve(e),pe.delete(t),!0):(pe.set(t,r),!1)}function pl(t,e){let r=pe.has(t)?pe.get(t):t.args.length;return r===0?Number(e)===0?(pe.delete(t),t.resolve(e),!0):!1:(r-=1,r<=0?(t.resolve(e),!0):(pe.set(t,r),!1))}});var yl=p(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.readyHandler=V.errorHandler=V.closeHandler=V.connectHandler=void 0;var Tb=Ae(),Ob=re(),Ib=el(),ee=O(),Nb=dl(),I=(0,ee.Debug)("connection");function Pb(t){return function(){var e;t.setStatus("connect"),t.resetCommandQueue();let r=!1,{connectionEpoch:s}=t;t.condition.auth&&t.auth(t.condition.auth,function(i){s===t.connectionEpoch&&i&&(i.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):i.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):i.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(r=!0,t.recoverFromFatalError(i,i)))}),t.condition.select&&t.select(t.condition.select).catch(i=>{t.silentEmit("error",i)}),new Nb.default(t,{stringNumbers:t.options.stringNumbers});let n=[];t.options.connectionName&&(I("set the connection name [%s]",t.options.connectionName),n.push(t.client("setname",t.options.connectionName).catch(ee.noop))),t.options.disableClientInfo||(I("set the client info"),n.push((0,ee.getPackageMeta)().then(i=>t.client("SETINFO","LIB-VER",i.version).catch(ee.noop)).catch(ee.noop)),n.push(t.client("SETINFO","LIB-NAME",!((e=t.options)===null||e===void 0)&&e.clientInfoTag?`ioredis(${t.options.clientInfoTag})`:"ioredis").catch(ee.noop))),Promise.all(n).catch(ee.noop).finally(()=>{t.options.enableReadyCheck||V.readyHandler(t)(),t.options.enableReadyCheck&&t._readyCheck(function(i,o){s===t.connectionEpoch&&(i?r||t.recoverFromFatalError(new Error("Ready check failed: "+i.message),i):t.connector.check(o)?V.readyHandler(t)():t.disconnect(!0))})})}}V.connectHandler=Pb;function Ln(t){let e=new Tb.AbortError("Command aborted due to connection close");return e.command={name:t.name,args:t.args},e}function Lb(t){var e;let r=0;for(let s=0;s<t.length;){let n=(e=t.peekAt(s))===null||e===void 0?void 0:e.command,i=n.pipelineIndex;if((i===void 0||i===0)&&(r=0),i!==void 0&&i!==r++){t.remove(s,1),n.reject(Ln(n));continue}s++}}function Mb(t){var e;for(let r=0;r<t.length;){let s=(e=t.peekAt(r))===null||e===void 0?void 0:e.command;if(s.name==="multi")break;if(s.name==="exec"){t.remove(r,1),s.reject(Ln(s));break}s.inTransaction?(t.remove(r,1),s.reject(Ln(s))):r++}}function qb(t){return function(){let r=t.status;if(t.setStatus("close"),t.commandQueue.length&&Lb(t.commandQueue),t.offlineQueue.length&&Mb(t.offlineQueue),r==="ready"&&(t.prevCondition||(t.prevCondition=t.condition),t.commandQueue.length&&(t.prevCommandQueue=t.commandQueue)),t.manuallyClosing)return t.manuallyClosing=!1,I("skip reconnecting since the connection is manually closed."),e();if(typeof t.options.retryStrategy!="function")return I("skip reconnecting because `retryStrategy` is not a function"),e();let s=t.options.retryStrategy(++t.retryAttempts);if(typeof s!="number")return I("skip reconnecting because `retryStrategy` doesn't return a number"),e();I("reconnect in %sms",s),t.setStatus("reconnecting",s),t.reconnectTimeout=setTimeout(function(){t.reconnectTimeout=null,t.connect().catch(ee.noop)},s);let{maxRetriesPerRequest:n}=t.options;typeof n=="number"&&(n<0?I("maxRetriesPerRequest is negative, ignoring..."):t.retryAttempts%(n+1)===0&&(I("reach maxRetriesPerRequest limitation, flushing command queue..."),t.flushQueue(new Ib.MaxRetriesPerRequestError(n))))};function e(){t.setStatus("end"),t.flushQueue(new Error(ee.CONNECTION_CLOSED_ERROR_MSG))}}V.closeHandler=qb;function Db(t){return function(e){I("error: %s",e),t.silentEmit("error",e)}}V.errorHandler=Db;function Bb(t){return function(){if(t.setStatus("ready"),t.retryAttempts=0,t.options.monitor){t.call("monitor").then(()=>t.setStatus("monitoring"),s=>t.emit("error",s));let{sendCommand:r}=t;t.sendCommand=function(s){return Ob.default.checkFlag("VALID_IN_MONITOR_MODE",s.name)?r.call(t,s):(s.reject(new Error("Connection is in monitoring mode, can't process commands.")),s.promise)},t.once("close",function(){delete t.sendCommand});return}let e=t.prevCondition?t.prevCondition.select:t.condition.select;if(t.options.readOnly&&(I("set the connection to readonly mode"),t.readonly().catch(ee.noop)),t.prevCondition){let r=t.prevCondition;if(t.prevCondition=null,r.subscriber&&t.options.autoResubscribe){t.condition.select!==e&&(I("connect to db [%d]",e),t.select(e));let s=r.subscriber.channels("subscribe");s.length&&(I("subscribe %d channels",s.length),t.subscribe(s));let n=r.subscriber.channels("psubscribe");n.length&&(I("psubscribe %d channels",n.length),t.psubscribe(n));let i=r.subscriber.channels("ssubscribe");if(i.length){I("ssubscribe %s",i.length);for(let o of i)t.ssubscribe(o)}}}if(t.prevCommandQueue)if(t.options.autoResendUnfulfilledCommands)for(I("resend %d unfulfilled commands",t.prevCommandQueue.length);t.prevCommandQueue.length>0;){let r=t.prevCommandQueue.shift();r.select!==t.condition.select&&r.command.name!=="select"&&t.select(r.select),t.sendCommand(r.command,r.stream)}else t.prevCommandQueue=null;if(t.offlineQueue.length){I("send %d commands in offline queue",t.offlineQueue.length);let r=t.offlineQueue;for(t.resetOfflineQueue();r.length>0;){let s=r.shift();s.select!==t.condition.select&&s.command.name!=="select"&&t.select(s.select),t.sendCommand(s.command,s.stream)}}t.condition.select!==e&&(I("connect to db [%d]",e),t.select(e))}}V.readyHandler=Bb});var ml=p(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.DEFAULT_REDIS_OPTIONS=void 0;mr.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:0,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(t){return Math.min(t*50,2e3)},keepAlive:0,noDelay:!0,connectionName:null,disableClientInfo:!1,clientInfoTag:void 0,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(t){return Math.min(t*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var he=p(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});var gl=Me(),bl=require("events"),Mn=ce(),jb=fn(),pt=re(),Fb=Ju(),$b=pr(),de=yl(),Ub=ml(),Gb=sr(),Qb=Hs(),xe=O(),zb=Ys(),Vb=ir(),ye=Xt(),Sl=ur(),me=(0,xe.Debug)("redis"),ge=class t extends Vb.default{constructor(e,r,s){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,r,s),bl.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let n=new $b.default(this.options);n.emitter=this,this.connector=n}else this.connector=new Fb.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([n,i])=>{this.defineCommand(n,i)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(ye.noop)}static createClient(...e){return new t(...e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}connect(e){let r=new Promise((s,n)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){n(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:i}=this;this.condition={select:i.db,auth:i.username?[i.username,i.password]:i.password,subscriber:!1};let o=this;(0,Mn.default)(this.connector.connect(function(c,a){o.silentEmit(c,a)}),function(c,a){if(c){o.flushQueue(c),o.silentEmit("error",c),n(c),o.setStatus("end");return}let u=i.tls?"secureConnect":"connect";if("sentinels"in i&&i.sentinels&&!i.enableTLSForSentinelMode&&(u="connect"),o.stream=a,i.noDelay&&a.setNoDelay(!0),typeof i.keepAlive=="number"&&(a.connecting?a.once(u,()=>{a.setKeepAlive(!0,i.keepAlive)}):a.setKeepAlive(!0,i.keepAlive)),a.connecting){if(a.once(u,de.connectHandler(o)),i.connectTimeout){let d=!1;a.setTimeout(i.connectTimeout,function(){if(d)return;a.setTimeout(0),a.destroy();let h=new Error("connect ETIMEDOUT");h.errorno="ETIMEDOUT",h.code="ETIMEDOUT",h.syscall="connect",de.errorHandler(o)(h)}),a.once(u,function(){d=!0,a.setTimeout(0)})}}else if(a.destroyed){let d=o.connector.firstError;d&&process.nextTick(()=>{de.errorHandler(o)(d)}),process.nextTick(de.closeHandler(o))}else process.nextTick(de.connectHandler(o));a.destroyed||(a.once("error",de.errorHandler(o)),a.once("close",de.closeHandler(o)));let f=function(){o.removeListener("close",l),s()};var l=function(){o.removeListener("ready",f),n(new Error(xe.CONNECTION_CLOSED_ERROR_MSG))};o.once("ready",f),o.once("close",l)})});return(0,Mn.default)(r,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?de.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new t({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":!((e=this.condition)===null||e===void 0)&&e.subscriber?"subscriber":"normal"}monitor(e){let r=this.duplicate({monitor:!0,lazyConnect:!1});return(0,Mn.default)(new Promise(function(s,n){r.once("error",n),r.once("monitoring",function(){s(r)})}),e)}sendCommand(e,r){var s,n;if(this.status==="wait"&&this.connect().catch(ye.noop),this.status==="end")return e.reject(new Error(xe.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if(!((s=this.condition)===null||s===void 0)&&s.subscriber&&!pt.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;typeof this.options.commandTimeout=="number"&&e.setTimeout(this.options.commandTimeout);let i=this.status==="ready"||!r&&this.status==="connect"&&(0,gl.exists)(e.name)&&((0,gl.hasFlag)(e.name,"loading")||pt.default.checkFlag("HANDSHAKE_COMMANDS",e.name));if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(i=!1):i=!1,i)me.enabled&&me("write command[%s]: %d -> %s(%o)",this._getDescription(),(n=this.condition)===null||n===void 0?void 0:n.select,e.name,e.args),r?"isPipeline"in r&&r.isPipeline?r.write(e.toWritable(r.destination.redis.stream)):r.write(e.toWritable(r)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:r,select:this.condition.select}),pt.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if(e.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;me.enabled&&me("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:r,select:this.condition.select})}if(e.name==="select"&&(0,xe.isInt)(e.args[0])){let o=parseInt(e.args[0],10);this.condition.select!==o&&(this.condition.select=o,this.emit("select",o),me("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length!==0&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}silentEmit(e,r){let s;if(!(e==="error"&&(s=r,this.status==="end"||this.manuallyClosing&&s instanceof Error&&(s.message===xe.CONNECTION_CLOSED_ERROR_MSG||s.syscall==="connect"||s.syscall==="read"))))return this.listeners(e).length>0?this.emit.apply(this,arguments):(s&&s instanceof Error&&console.error("[ioredis] Unhandled error event:",s.stack),!1)}recoverFromFatalError(e,r,s){this.flushQueue(r,s),this.silentEmit("error",r),this.disconnect(!0)}handleReconnection(e,r){var s;let n=!1;switch(this.options.reconnectOnError&&!pt.default.checkFlag("IGNORE_RECONNECT_ON_ERROR",r.command.name)&&(n=this.options.reconnectOnError(e)),n){case 1:case!0:this.status!=="reconnecting"&&this.disconnect(!0),r.command.reject(e);break;case 2:this.status!=="reconnecting"&&this.disconnect(!0),((s=this.condition)===null||s===void 0?void 0:s.select)!==r.select&&r.command.name!=="select"&&this.select(r.select),this.sendCommand(r.command);break;default:r.command.reject(e)}}_getDescription(){let e;return"path"in this.options&&this.options.path?e=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?e=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?e=this.options.host+":"+this.options.port:e="",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new Sl}resetOfflineQueue(){this.offlineQueue=new Sl}parseOptions(...e){let r={},s=!1;for(let n=0;n<e.length;++n){let i=e[n];if(!(i===null||typeof i>"u"))if(typeof i=="object")(0,ye.defaults)(r,i);else if(typeof i=="string")(0,ye.defaults)(r,(0,xe.parseURL)(i)),i.startsWith("rediss://")&&(s=!0);else if(typeof i=="number")r.port=i;else throw new Error("Invalid argument "+i)}s&&(0,ye.defaults)(r,{tls:!0}),(0,ye.defaults)(r,t.defaultOptions),typeof r.port=="string"&&(r.port=parseInt(r.port,10)),typeof r.db=="string"&&(r.db=parseInt(r.db,10)),this.options=(0,xe.resolveTLSProfile)(r)}setStatus(e,r){me.enabled&&me("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,r))}createScanStream(e,{key:r,options:s={}}){return new Gb.default({objectMode:!0,key:r,redis:this,command:e,...s})}flushQueue(e,r){r=(0,ye.defaults)({},r,{offlineQueue:!0,commandQueue:!0});let s;if(r.offlineQueue)for(;s=this.offlineQueue.shift();)s.command.reject(e);if(r.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");s=this.commandQueue.shift();)s.command.reject(e)}_readyCheck(e){let r=this;this.info(function(s,n){if(s)return s.message&&s.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${s.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(s);if(typeof n!="string")return e(null,n);let i={},o=n.split(`\r
`);for(let c=0;c<o.length;++c){let[a,...u]=o[c].split(":"),f=u.join(":");f&&(i[a]=f)}if(!i.loading||i.loading==="0")e(null,i);else{let c=(i.loading_eta_seconds||1)*1e3,a=r.options.maxLoadingRetryTime&&r.options.maxLoadingRetryTime<c?r.options.maxLoadingRetryTime:c;me("Redis server still loading, trying again in "+a+"ms"),setTimeout(function(){r._readyCheck(e)},a)}}).catch(ye.noop)}};ge.Cluster=jb.default;ge.Command=pt.default;ge.defaultOptions=Ub.DEFAULT_REDIS_OPTIONS;(0,zb.default)(ge,bl.EventEmitter);(0,Qb.addTransactionSupport)(ge.prototype);qn.default=ge});var kl=p((k,wl)=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.print=k.ReplyError=k.SentinelIterator=k.SentinelConnector=k.AbstractConnector=k.Pipeline=k.ScanStream=k.Command=k.Cluster=k.Redis=k.default=void 0;k=wl.exports=he().default;var Hb=he();Object.defineProperty(k,"default",{enumerable:!0,get:function(){return Hb.default}});var Kb=he();Object.defineProperty(k,"Redis",{enumerable:!0,get:function(){return Kb.default}});var Yb=fn();Object.defineProperty(k,"Cluster",{enumerable:!0,get:function(){return Yb.default}});var Wb=re();Object.defineProperty(k,"Command",{enumerable:!0,get:function(){return Wb.default}});var Xb=sr();Object.defineProperty(k,"ScanStream",{enumerable:!0,get:function(){return Xb.default}});var Jb=Qs();Object.defineProperty(k,"Pipeline",{enumerable:!0,get:function(){return Jb.default}});var Zb=fr();Object.defineProperty(k,"AbstractConnector",{enumerable:!0,get:function(){return Zb.default}});var El=pr();Object.defineProperty(k,"SentinelConnector",{enumerable:!0,get:function(){return El.default}});Object.defineProperty(k,"SentinelIterator",{enumerable:!0,get:function(){return El.SentinelIterator}});k.ReplyError=Ae().ReplyError;Object.defineProperty(k,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(t){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function e1(t,e){console.log(t?"Error: "+t:"Reply: "+e)}k.print=e1});var p1={};$l(p1,{createReport:()=>Ol,default:()=>h1,getReport:()=>Nl,listReports:()=>Il});module.exports=$n(p1);var Hn=Er(Vn(),1),kr;function be(){return kr||(kr=new Hn.PrismaClient),kr}var rf=process.env.FRONTEND_URL||"http://localhost:5173",sf=process.env.NODE_ENV||"development",Kn=sf==="production",nf=()=>{let t=[rf];return Kn&&t.push("https://dkmxy676d3vgc.cloudfront.net"),Kn||t.push("http://localhost:3000","http://localhost:5173"),t},of=t=>{let e=nf(),r=t?.headers?.origin||t?.headers?.Origin||"";return{"Access-Control-Allow-Origin":e.includes(r)?r:e[0],"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,PATCH,OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization,X-CSRF-Token","Access-Control-Max-Age":"86400"}};function _e(t,e=200,r={}){let s=of(r.event);return delete r.event,{statusCode:e,headers:{"content-type":"application/json",...s,"x-content-type-options":"nosniff","referrer-policy":"strict-origin-when-cross-origin","permissions-policy":"camera=(), microphone=(), geolocation=()","strict-transport-security":"max-age=63072000; includeSubDomains; preload",...r},body:JSON.stringify(t)}}function j(t,e=400,r={}){return _e({error:t},e,r)}var xc=Er(vc(),1);var fg=process.env.JWT_SECRET||"dev-secret-key-change-in-production";var jE=process.env.COOKIE_DOMAIN||void 0,FE=process.env.NODE_ENV||"development";var hg=t=>{try{return xc.default.verify(t,fg)}catch{return null}},pg=(t,e="access")=>{let r=e==="access"?"access_token":"refresh_token",s=dg(t.headers?.cookie||t.headers?.Cookie||"");if(s[r])return s[r];if(e==="access"){let n=t.headers?.authorization||t.headers?.Authorization;if(n&&n.startsWith("Bearer "))return n.substring(7)}return null},dg=t=>{let e={};return t&&t.split(";").forEach(r=>{let[s,...n]=r.split("=");s&&n.length>0&&(e[s.trim()]=n.join("=").trim())}),e};var _c=t=>{let e=pg(t,"access");if(!e)return null;let r=hg(e);return!r||r.type!=="access"?null:r.userId||null};function Ht(t){return _c(t)}function yg(){return(process.env.ADMIN_ROLE_IDS||"").split(",").map(e=>e.trim()).filter(Boolean)}async function mg(t){if(!t)return!1;let e=yg();if(e.length===0){let s=await be().user.findUnique({where:{id:t},select:{role:!0}});return s&&(s.role==="admin"||s.role==="moderator")}return e.includes(t)}async function hs(t){let e=Ht(t);return e?await mg(e)?null:j("Forbidden - Admin access required",403):j("Unauthorized - Authentication required",401)}var xl=Er(kl(),1);var dt={auth:{maxRequests:10,windowMs:9e5,message:"Too many authentication attempts. Please try again later."},emailVerification:{maxRequests:5,windowMs:36e5,message:"Too many verification email requests. Please try again later."},reports:{maxRequests:parseInt(process.env.REPORTS_MAX_PER_HOUR||"5",10),windowMs:36e5,message:"Too many reports submitted. Please try again later."},write:{maxRequests:100,windowMs:36e5,message:"Too many write requests. Please try again later."},read:{maxRequests:1e3,windowMs:36e5,message:"Too many read requests. Please try again later."}};function Al(t,e){return t==="/auth/resend-verification"?dt.emailVerification:t==="/reports"&&e==="POST"?dt.reports:t.startsWith("/auth/")?dt.auth:["POST","PUT","DELETE","PATCH"].includes(e.toUpperCase())?dt.write:dt.read}function vl(t){return!(t==="/health"||t==="/meta")}var Ge=null,gr=null,Sr=new Map;function t1(){if(Ge)return Ge;let t=process.env.REDIS_URL;if(!t)return console.warn("[RateLimit] REDIS_URL not configured. Using in-memory fallback (single instance only, not distributed)."),null;try{return Ge=new xl.default(t,{maxRetriesPerRequest:3,retryStrategy:e=>e>3?(console.error("[RateLimit] Redis connection failed after 3 retries"),null):Math.min(e*100,3e3),reconnectOnError:e=>!!e.message.includes("READONLY")}),Ge.on("error",e=>{console.error("[RateLimit] Redis error:",e),gr=e}),Ge.on("connect",()=>{console.log("[RateLimit] Redis connected successfully"),gr=null}),Ge}catch(e){return console.error("[RateLimit] Failed to initialize Redis client:",e),gr=e,null}}function r1(t){if(t.requestContext?.http?.sourceIp)return t.requestContext.http.sourceIp;let e=t.headers?.[" x-forwarded-for"]||t.headers?.["X-Forwarded-For"];return e?e.split(",")[0].trim():"unknown"}function s1(t){return t.userId||null}function n1(t,e,r){let s=r?`user:${r}`:`ip:${e}`;return`rl:${t}:${s}`}async function i1(t,e,r){let s=t1();if(!s||gr)return Dn(t,e,r);try{let n=Math.ceil(r/1e3),i=Date.now(),o=s.pipeline();o.incr(t),o.pttl(t);let c=await o.exec();if(!c||c.some(([h])=>h))return console.error("[RateLimit] Redis pipeline error, falling back to in-memory"),Dn(t,e,r);let a=c[0][1],u=c[1][1];(a===1||u===-1)&&await s.pexpire(t,r);let f=u>0?i+u:i+r,l=a<=e,d=Math.max(0,e-a);return{allowed:l,remaining:d,resetTime:f}}catch(n){return console.error("[RateLimit] Redis check error, falling back to in-memory:",n),Dn(t,e,r)}}async function Dn(t,e,r){let s=Date.now(),n=Sr.get(t);if(!n||s>n.resetTime)return n={count:1,resetTime:s+r},Sr.set(t,n),Math.random()<.01&&o1(),{allowed:!0,remaining:e-1,resetTime:n.resetTime};n.count++;let i=n.count<=e,o=Math.max(0,e-n.count);return{allowed:i,remaining:o,resetTime:n.resetTime}}function o1(){let t=Date.now();for(let[e,r]of Sr.entries())t>r.resetTime&&Sr.delete(e)}async function _l(t,e=null){if(!(process.env.RATE_LIMITING_ENABLED!=="false"))return{allowed:!0};let s=t.requestContext?.http?.method||t.httpMethod||"GET",n=t.requestContext?.http?.path||t.path||"/";if(!vl(n))return{allowed:!0};let i=e||n,o=r1(t),c=s1(t),a=Al(i,s),{maxRequests:u,windowMs:f,message:l}=a,d=n1(i,o,c),{allowed:h,remaining:g,resetTime:E}=await i1(d,u,f);if(!h){let T=Math.ceil((E-Date.now())/1e3);return{allowed:!1,response:{statusCode:429,headers:{"Content-Type":"application/json","Retry-After":T.toString(),"X-RateLimit-Limit":u.toString(),"X-RateLimit-Remaining":"0","X-RateLimit-Reset":Math.ceil(E/1e3).toString()},body:JSON.stringify({error:l,retryAfter:T})}}}return t.rateLimitHeaders={"X-RateLimit-Limit":u.toString(),"X-RateLimit-Remaining":g.toString(),"X-RateLimit-Reset":Math.ceil(E/1e3).toString()},{allowed:!0}}function Cl(t){return{spam:1,abuse:3,unsafe_link:2,profanity:1,privacy:2,other:0}[t]||0}function Bn(t){if(!t||typeof t!="string")return"[redacted]";if(t.length<=10)return"*".repeat(t.length);let e=t.substring(0,6),r=t.substring(t.length-4),s="*".repeat(Math.max(0,t.length-10));return`${e}${s}${r}`}function a1(){return process.env.MODERATION_ALERTS_ENABLED==="true"&&process.env.MODERATION_ALERT_CHANNEL_ID}function c1(t){let e={0:8421504,1:16776960,2:16747520,3:16711680};return e[t]||e[0]}function Rl(t){return t?t.length<=6?t:t.substring(0,6)+"...":"[unknown]"}async function Tl(t){if(!a1())return;let e=process.env.MODERATION_ALERT_CHANNEL_ID,r={title:"\u{1F6A8} New Moderation Report",color:c1(t.severity),fields:[{name:"Report ID",value:t.id,inline:!0},{name:"Reporter",value:Rl(t.reporterId),inline:!0},{name:"Category",value:t.category,inline:!0},{name:"Target",value:`${t.targetType}: ${Rl(t.targetId)}`,inline:!1},{name:"Severity",value:["Info","Low","Medium","High"][t.severity]||"Unknown",inline:!0},{name:"Status",value:t.status,inline:!0}],timestamp:new Date(t.createdAt).toISOString()};t.description&&r.fields.push({name:"Description",value:t.description.substring(0,1e3),inline:!1}),t.evidenceUrls&&t.evidenceUrls.length>0&&r.fields.push({name:"Evidence URLs",value:t.evidenceUrls.slice(0,3).join(`
`),inline:!1}),await u1(e,{embeds:[r]})}async function u1(t,e){try{let r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});r.ok||console.error("[Discord] Webhook failed:",r.status,await r.text())}catch(r){console.error("[Discord] Failed to send webhook:",r)}}var H={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0};function l1(){return(process.env.REPORT_CATEGORY_ALLOWLIST||"spam,abuse,unsafe_link,profanity,privacy,other").split(",").map(e=>e.trim()).filter(Boolean)}function f1(t){let e={};if(!t.targetType||typeof t.targetType!="string")e.targetType="Target type is required";else{let r=["user","profile","post","comment","link"];r.includes(t.targetType)||(e.targetType=`Target type must be one of: ${r.join(", ")}`)}if((!t.targetId||typeof t.targetId!="string")&&(e.targetId="Target ID is required"),!t.category||typeof t.category!="string")e.category="Category is required";else{let r=l1();r.includes(t.category)||(e.category=`Category must be one of: ${r.join(", ")}`)}return t.description&&typeof t.description!="string"&&(e.description="Description must be a string"),t.description&&t.description.length>5e3&&(e.description="Description must be 5000 characters or less"),t.evidenceUrls&&!Array.isArray(t.evidenceUrls)&&(e.evidenceUrls="Evidence URLs must be an array"),t.evidenceUrls&&t.evidenceUrls.length>10&&(e.evidenceUrls="Maximum 10 evidence URLs allowed"),{valid:Object.keys(e).length===0,errors:e}}var Ol=async t=>{try{if(process.env.REPORTS_ENABLED==="false")return j("Reports endpoint is disabled",503,H);let e=Ht(t);if(!e)return j("Unauthorized - Authentication required",401,H);let r=await _l(t,"/reports");if(!r.allowed)return r.response;let s;try{s=typeof t.body=="string"?JSON.parse(t.body):t.body}catch{return j("Invalid JSON body",400,H)}let n=f1(s);if(!n.valid)return _e({errors:n.errors},400,H);let i=be(),o=Cl(s.category),c=await i.moderationReport.create({data:{reporterId:e,targetType:s.targetType,targetId:s.targetId,category:s.category,description:s.description||null,evidenceUrls:s.evidenceUrls||[],status:"open",severity:o}});console.log("[Moderation] Report created:",{id:c.id,reporterId:Bn(e),targetType:c.targetType,targetId:Bn(c.targetId),category:c.category,severity:o});try{await Tl(c)}catch(a){console.error("[Moderation] Failed to send Discord alert:",a)}return _e({id:c.id,status:c.status},201,{...H,...t.rateLimitHeaders})}catch(e){return console.error("[Reports] Create error:",e),j("Internal server error",500,H)}},Il=async t=>{try{let e=await hs(t);if(e)return e;let r=t.queryStringParameters||{},s=r.status,n=r.category,i=r.targetType,o=Math.min(parseInt(r.limit||"50",10),100),c=r.cursor,a={};s&&(a.status=s),n&&(a.category=n),i&&(a.targetType=i),c&&(a.id={lt:c});let f=await be().moderationReport.findMany({where:a,orderBy:{createdAt:"desc"},take:o+1,include:{actions:{orderBy:{createdAt:"desc"},take:5}}}),l=f.length>o,d=l?f.slice(0,o):f,h=l?d[d.length-1].id:null;return _e({items:d,pagination:{limit:o,hasMore:l,nextCursor:h}},200,H)}catch(e){return console.error("[Reports] List error:",e),j("Internal server error",500,H)}},Nl=async t=>{try{let e=await hs(t);if(e)return e;let{id:r}=t.pathParameters||{};if(!r)return j("Report ID is required",400,H);let n=await be().moderationReport.findUnique({where:{id:r},include:{actions:{orderBy:{createdAt:"desc"}}}});return n?_e(n,200,H):j("Report not found",404,H)}catch(e){return console.error("[Reports] Get error:",e),j("Internal server error",500,H)}},h1={createReport:Ol,listReports:Il,getReport:Nl};0&&(module.exports={createReport,getReport,listReports});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
