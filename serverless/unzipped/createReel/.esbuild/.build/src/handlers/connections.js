var w=Object.create;var c=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var A=(r,e)=>()=>(r&&(e=r(r=0)),e);var b=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),N=(r,e)=>{for(var t in e)c(r,t,{get:e[t],enumerable:!0})},d=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of q(e))!C.call(r,o)&&o!==t&&c(r,o,{get:()=>e[o],enumerable:!(n=_(e,o))||n.enumerable});return r};var R=(r,e,t)=>(t=r!=null?w(x(r)):{},d(e||!r||!r.__esModule?c(t,"default",{value:r,enumerable:!0}):t,r)),l=r=>d(c({},"__esModule",{value:!0}),r);var L={};function k(r){return typeof r=="function"?r:e=>e.$extends(r)}function F(r){return r}var u,E,S,T,j,I,D,m,V,H,M,U,g,J,f=A(()=>{"use strict";u=Object.defineProperty,E=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyNames,T=Object.prototype.hasOwnProperty,j=(r,e)=>{for(var t in e)u(r,t,{get:e[t],enumerable:!0})},I=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of S(e))!T.call(r,o)&&o!==t&&u(r,o,{get:()=>e[o],enumerable:!(n=E(e,o))||n.enumerable});return r},D=r=>I(u({},"__esModule",{value:!0}),r),m={};j(m,{Prisma:()=>g,PrismaClient:()=>U,default:()=>J});module.exports=D(m);V={enginesVersion:"2ba551f319ab1df4bc874a89965d8b3641056773"},H="6.19.0",M=H,U=class{constructor(){throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.')}};g={defineExtension:k,getExtensionContext:F,prismaVersion:{client:M,engine:V.enginesVersion}},J={Prisma:g}});var v=b((re,y)=>{y.exports={...(f(),l(L))}});var Y={};N(Y,{approveRequest:()=>Q,listRequests:()=>K,rejectRequest:()=>W,sendRequest:()=>$});module.exports=l(Y);var h=R(v(),1),p;function a(){return p||(p=new h.PrismaClient),p}var z=process.env.FRONTEND_URL||"http://localhost:5173",B=process.env.NODE_ENV||"development",O=B==="production",G=()=>{let r=[z];return O&&r.push("https://dkmxy676d3vgc.cloudfront.net"),O||r.push("http://localhost:3000","http://localhost:5173"),r},X=r=>{let e=G(),t=r?.headers?.origin||r?.headers?.Origin||"";return{"Access-Control-Allow-Origin":e.includes(t)?t:e[0],"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,PATCH,OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization,X-CSRF-Token","Access-Control-Max-Age":"86400"}};function i(r,e=200,t={}){let n=X(t.event);return delete t.event,{statusCode:e,headers:{"content-type":"application/json",...n,"x-content-type-options":"nosniff","referrer-policy":"strict-origin-when-cross-origin","permissions-policy":"camera=(), microphone=(), geolocation=()","strict-transport-security":"max-age=63072000; includeSubDomains; preload",...t},body:JSON.stringify(r)}}function s(r,e=400,t={}){return i({error:r},e,t)}var $=async r=>{try{let{senderId:e,receiverId:t,message:n}=JSON.parse(r.body||"{}");if(!e||!t)return s("senderId and receiverId are required",400);let P=await a().connectionRequest.create({data:{senderId:e,receiverId:t,message:n},include:{sender:!0,receiver:!0}});return i(P,201)}catch(e){return console.error(e),s("Server error: "+e.message,500)}},K=async r=>{try{let{userId:e}=r.queryStringParameters||{};if(!e)return s("userId is required",400);let n=await a().connectionRequest.findMany({where:{receiverId:e,status:"pending"},include:{sender:!0},orderBy:{createdAt:"desc"}});return i(n)}catch(e){return console.error(e),s("Server error: "+e.message,500)}},Q=async r=>{try{let e=r.pathParameters?.id;if(!e)return s("id is required",400);let n=await a().connectionRequest.update({where:{id:e},data:{status:"accepted"}});return i(n)}catch(e){return console.error(e),s("Server error: "+e.message,500)}},W=async r=>{try{let e=r.pathParameters?.id;if(!e)return s("id is required",400);let n=await a().connectionRequest.update({where:{id:e},data:{status:"rejected"}});return i(n)}catch(e){return console.error(e),s("Server error: "+e.message,500)}};0&&(module.exports={approveRequest,listRequests,rejectRequest,sendRequest});
