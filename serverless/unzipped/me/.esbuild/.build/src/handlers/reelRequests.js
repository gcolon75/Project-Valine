var Ml=Object.create;var gt=Object.defineProperty;var Pl=Object.getOwnPropertyDescriptor;var Ll=Object.getOwnPropertyNames;var Dl=Object.getPrototypeOf,Bl=Object.prototype.hasOwnProperty;var jl=(t,e)=>()=>(t&&(e=t(t=0)),e);var d=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Fl=(t,e)=>{for(var r in e)gt(t,r,{get:e[r],enumerable:!0})},li=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ll(e))!Bl.call(t,n)&&n!==r&&gt(t,n,{get:()=>e[n],enumerable:!(s=Pl(e,n))||s.enumerable});return t};var mt=(t,e,r)=>(r=t!=null?Ml(Dl(t)):{},li(e||!t||!t.__esModule?gt(r,"default",{value:t,enumerable:!0}):r,t)),di=t=>li(gt({},"__esModule",{value:!0}),t);var e0={};function Xl(t){return typeof t=="function"?t:e=>e.$extends(t)}function Jl(t){return t}var Ir,$l,Ul,Gl,Hl,Ql,Vl,hi,zl,Kl,Yl,Wl,pi,Zl,yi=jl(()=>{"use strict";Ir=Object.defineProperty,$l=Object.getOwnPropertyDescriptor,Ul=Object.getOwnPropertyNames,Gl=Object.prototype.hasOwnProperty,Hl=(t,e)=>{for(var r in e)Ir(t,r,{get:e[r],enumerable:!0})},Ql=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ul(e))!Gl.call(t,n)&&n!==r&&Ir(t,n,{get:()=>e[n],enumerable:!(s=$l(e,n))||s.enumerable});return t},Vl=t=>Ql(Ir({},"__esModule",{value:!0}),t),hi={};Hl(hi,{Prisma:()=>pi,PrismaClient:()=>Wl,default:()=>Zl});module.exports=Vl(hi);zl={enginesVersion:"2ba551f319ab1df4bc874a89965d8b3641056773"},Kl="6.19.0",Yl=Kl,Wl=class{constructor(){throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.')}};pi={defineExtension:Xl,getExtensionContext:Jl,prismaVersion:{client:Yl,engine:zl.enginesVersion}},Zl={Prisma:pi}});var mi=d((gS,gi)=>{gi.exports={...(yi(),di(e0))}});var wi=d(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});function n0(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var Ei=n0(require("crypto")),i0=(t,e,r)=>Ei.createHmac(t,Buffer.from(e,"hex")).update(Buffer.from(r,"hex")).digest().toString("hex"),o0=(t,e)=>Ei.randomBytes(t).toString(e);xt.createDigest=i0;xt.createRandomBytes=o0});var vi=d(qr=>{"use strict";var a0="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",ki=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];function c0(t){var e=Math.floor(t.length/5);return t.length%5===0?e:e+1}qr.encode=function(t){Buffer.isBuffer(t)||(t=new Buffer(t));for(var e=0,r=0,s=0,n=0,i=new Buffer(c0(t)*8);e<t.length;){var o=t[e];s>3?(n=o&255>>s,s=(s+5)%8,n=n<<s|(e+1<t.length?t[e+1]:0)>>8-s,e++):(n=o>>8-(s+5)&31,s=(s+5)%8,s===0&&e++),i[r]=a0.charCodeAt(n),r++}for(e=r;e<i.length;e++)i[e]=61;return i};qr.decode=function(t){var e=0,r=0,s,n=0;Buffer.isBuffer(t)||(t=new Buffer(t));for(var i=new Buffer(Math.ceil(t.length*5/8)),o=0;o<t.length&&t[o]!==61;o++){var c=t[o]-48;if(c<ki.length)r=ki[c],e<=3?(e=(e+5)%8,e===0?(s|=r,i[n]=s,n++,s=0):s|=255&r<<8-e):(e=(e+5)%8,s|=255&r>>>e,i[n]=s,n++,s=255&r<<8-e);else throw new Error("Invalid input - it is not base32 encoded string")}return i.slice(0,n)}});var Ci=d(Mr=>{var Ai=vi();Mr.encode=Ai.encode;Mr.decode=Ai.decode});var Oi=d(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});function u0(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var _i=u0(Ci()),f0=(t,e)=>_i.decode(t).toString(e),l0=(t,e)=>_i.encode(Buffer.from(t,e).toString("ascii")).toString().replace(/=/g,"");bt.keyDecoder=f0;bt.keyEncoder=l0});var Wi=d(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});function At(t){return Object.keys(t).map(e=>t[e])}(function(t){t.SHA1="sha1",t.SHA256="sha256",t.SHA512="sha512"})(m.HashAlgorithms||(m.HashAlgorithms={}));var Et=At(m.HashAlgorithms);(function(t){t.ASCII="ascii",t.BASE64="base64",t.HEX="hex",t.LATIN1="latin1",t.UTF8="utf8"})(m.KeyEncodings||(m.KeyEncodings={}));var Pr=At(m.KeyEncodings);(function(t){t.HOTP="hotp",t.TOTP="totp"})(m.Strategy||(m.Strategy={}));var Lr=At(m.Strategy),Ct=()=>{throw new Error("Please provide an options.createDigest implementation.")};function jr(t){return/^(\d+)$/.test(t)}function Fr(t,e,r){return t.length>=e?t:`${Array(e+1).join(r)}${t}`.slice(-1*e)}function $r(t){let e=`otpauth://${t.type}/{labelPrefix}:{accountName}?secret={secret}{query}`,r=[];if(Lr.indexOf(t.type)<0)throw new Error(`Expecting options.type to be one of ${Lr.join(", ")}. Received ${t.type}.`);if(t.type==="hotp"){if(t.counter==null||typeof t.counter!="number")throw new Error('Expecting options.counter to be a number when options.type is "hotp".');r.push(`&counter=${t.counter}`)}return t.type==="totp"&&t.step&&r.push(`&period=${t.step}`),t.digits&&r.push(`&digits=${t.digits}`),t.algorithm&&r.push(`&algorithm=${t.algorithm.toUpperCase()}`),t.issuer&&r.push(`&issuer=${encodeURIComponent(t.issuer)}`),e.replace("{labelPrefix}",encodeURIComponent(t.issuer||t.accountName)).replace("{accountName}",encodeURIComponent(t.accountName)).replace("{secret}",t.secret).replace("{query}",r.join(""))}var wt=class t{constructor(e={}){this._defaultOptions=Object.freeze({...e}),this._options=Object.freeze({})}create(e={}){return new t(e)}clone(e={}){let r=this.create({...this._defaultOptions,...e});return r.options=this._options,r}get options(){return Object.freeze({...this._defaultOptions,...this._options})}set options(e){this._options=Object.freeze({...this._options,...e})}allOptions(){return this.options}resetOptions(){this._options=Object.freeze({})}};function Ur(t){if(typeof t.createDigest!="function")throw new Error("Expecting options.createDigest to be a function.");if(typeof t.createHmacKey!="function")throw new Error("Expecting options.createHmacKey to be a function.");if(typeof t.digits!="number")throw new Error("Expecting options.digits to be a number.");if(!t.algorithm||Et.indexOf(t.algorithm)<0)throw new Error(`Expecting options.algorithm to be one of ${Et.join(", ")}. Received ${t.algorithm}.`);if(!t.encoding||Pr.indexOf(t.encoding)<0)throw new Error(`Expecting options.encoding to be one of ${Pr.join(", ")}. Received ${t.encoding}.`)}var Ti=(t,e,r)=>Buffer.from(e,r).toString("hex");function Ii(){return{algorithm:m.HashAlgorithms.SHA1,createHmacKey:Ti,createDigest:Ct,digits:6,encoding:m.KeyEncodings.ASCII}}function Ni(t){let e={...Ii(),...t};return Ur(e),Object.freeze(e)}function qi(t){let e=t.toString(16);return Fr(e,16,"0")}function Mi(t,e){let r=Buffer.from(t,"hex"),s=r[r.length-1]&15,i=((r[s]&127)<<24|(r[s+1]&255)<<16|(r[s+2]&255)<<8|r[s+3]&255)%Math.pow(10,e);return Fr(String(i),e,"0")}function d0(t,e,r){let s=qi(e),n=r.createHmacKey(r.algorithm,t,r.encoding);return r.createDigest(r.algorithm,n,s)}function _t(t,e,r){let s=r.digest||d0(t,e,r);return Mi(s,r.digits)}function Pi(t,e,r,s){if(!jr(t))return!1;let n=_t(e,r,s);return t===n}function Li(t,e,r,s,n){return $r({algorithm:n.algorithm,digits:n.digits,type:m.Strategy.HOTP,accountName:t,counter:s,issuer:e,secret:r})}var kt=class t extends wt{create(e={}){return new t(e)}allOptions(){return Ni(this.options)}generate(e,r){return _t(e,r,this.allOptions())}check(e,r,s){return Pi(e,r,s,this.allOptions())}verify(e){if(typeof e!="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(e.token,e.secret,e.counter)}keyuri(e,r,s,n){return Li(e,r,s,n,this.allOptions())}};function Di(t){if(typeof t=="number")return[Math.abs(t),Math.abs(t)];if(Array.isArray(t)){let[e,r]=t;if(typeof e=="number"&&typeof r=="number")return[Math.abs(e),Math.abs(r)]}throw new Error("Expecting options.window to be an number or [number, number].")}function Gr(t){if(Ur(t),Di(t.window),typeof t.epoch!="number")throw new Error("Expecting options.epoch to be a number.");if(typeof t.step!="number")throw new Error("Expecting options.step to be a number.")}var St=(t,e,r)=>{let s=t.length,n=Buffer.from(t,e).toString("hex");if(s<r){let i=new Array(r-s+1).join(n);return Buffer.from(i,"hex").slice(0,r).toString("hex")}return n},Hr=(t,e,r)=>{switch(t){case m.HashAlgorithms.SHA1:return St(e,r,20);case m.HashAlgorithms.SHA256:return St(e,r,32);case m.HashAlgorithms.SHA512:return St(e,r,64);default:throw new Error(`Expecting algorithm to be one of ${Et.join(", ")}. Received ${t}.`)}};function Bi(){return{algorithm:m.HashAlgorithms.SHA1,createDigest:Ct,createHmacKey:Hr,digits:6,encoding:m.KeyEncodings.ASCII,epoch:Date.now(),step:30,window:0}}function ji(t){let e={...Bi(),...t};return Gr(e),Object.freeze(e)}function Fi(t,e){return Math.floor(t/e/1e3)}function Ot(t,e){let r=Fi(e.epoch,e.step);return _t(t,r,e)}function Ri(t,e,r,s){let n=[];if(s===0)return n;for(let i=1;i<=s;i++){let o=e*i*r;n.push(t+o)}return n}function $i(t,e,r){let s=Di(r),n=e*1e3;return{current:t,past:Ri(t,-1,n,s[0]),future:Ri(t,1,n,s[1])}}function Qr(t,e,r){if(!jr(t))return!1;let s=Ot(e,r);return t===s}function Dr(t,e,r,s){let n=null;return t.some((i,o)=>Qr(e,r,{...s,epoch:i})?(n=o+1,!0):!1),n}function Vr(t,e,r){if(Qr(t,e,r))return 0;let s=$i(r.epoch,r.step,r.window),n=Dr(s.past,t,e,r);return n!==null?n*-1:Dr(s.future,t,e,r)}function zr(t,e){return Math.floor(t/1e3)%e}function Ui(t,e){return e-zr(t,e)}function Gi(t,e,r,s){return $r({algorithm:s.algorithm,digits:s.digits,step:s.step,type:m.Strategy.TOTP,accountName:t,issuer:e,secret:r})}var vt=class t extends kt{create(e={}){return new t(e)}allOptions(){return ji(this.options)}generate(e){return Ot(e,this.allOptions())}checkDelta(e,r){return Vr(e,r,this.allOptions())}check(e,r){return typeof this.checkDelta(e,r)=="number"}verify(e){if(typeof e!="object")throw new Error("Expecting argument 0 of verify to be an object");return this.check(e.token,e.secret)}timeRemaining(){let e=this.allOptions();return Ui(e.epoch,e.step)}timeUsed(){let e=this.allOptions();return zr(e.epoch,e.step)}keyuri(e,r,s){return Gi(e,r,s,this.allOptions())}};function Hi(t){if(Gr(t),typeof t.keyDecoder!="function")throw new Error("Expecting options.keyDecoder to be a function.");if(t.keyEncoder&&typeof t.keyEncoder!="function")throw new Error("Expecting options.keyEncoder to be a function.")}function Qi(){return{algorithm:m.HashAlgorithms.SHA1,createDigest:Ct,createHmacKey:Hr,digits:6,encoding:m.KeyEncodings.HEX,epoch:Date.now(),step:30,window:0}}function Vi(t){let e={...Qi(),...t};return Hi(e),Object.freeze(e)}function Kr(t,e){return e.keyEncoder(t,e.encoding)}function Rt(t,e){return e.keyDecoder(t,e.encoding)}function zi(t,e){let r=e.createRandomBytes(t,e.encoding);return Kr(r,e)}function Ki(t,e){return Ot(Rt(t,e),e)}function Yi(t,e,r){return Vr(t,Rt(e,r),r)}var Br=class t extends vt{create(e={}){return new t(e)}allOptions(){return Vi(this.options)}generate(e){return Ki(e,this.allOptions())}checkDelta(e,r){return Yi(e,r,this.allOptions())}encode(e){return Kr(e,this.allOptions())}decode(e){return Rt(e,this.allOptions())}generateSecret(e=10){return zi(e,this.allOptions())}};m.Authenticator=Br;m.HASH_ALGORITHMS=Et;m.HOTP=kt;m.KEY_ENCODINGS=Pr;m.OTP=wt;m.STRATEGY=Lr;m.TOTP=vt;m.authenticatorCheckWithWindow=Yi;m.authenticatorDecoder=Rt;m.authenticatorDefaultOptions=Qi;m.authenticatorEncoder=Kr;m.authenticatorGenerateSecret=zi;m.authenticatorOptionValidator=Hi;m.authenticatorOptions=Vi;m.authenticatorToken=Ki;m.createDigestPlaceholder=Ct;m.hotpCheck=Pi;m.hotpCounter=qi;m.hotpCreateHmacKey=Ti;m.hotpDefaultOptions=Ii;m.hotpDigestToToken=Mi;m.hotpKeyuri=Li;m.hotpOptions=Ni;m.hotpOptionsValidator=Ur;m.hotpToken=_t;m.isTokenValid=jr;m.keyuri=$r;m.objectValues=At;m.padStart=Fr;m.totpCheck=Qr;m.totpCheckByEpoch=Dr;m.totpCheckWithWindow=Vr;m.totpCounter=Fi;m.totpCreateHmacKey=Hr;m.totpDefaultOptions=Bi;m.totpEpochAvailable=$i;m.totpKeyuri=Gi;m.totpOptions=ji;m.totpOptionsValidator=Gr;m.totpPadSecret=St;m.totpTimeRemaining=Ui;m.totpTimeUsed=zr;m.totpToken=Ot});var Ji=d(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});var Tt=wi(),Xi=Oi(),Yr=Wi(),h0=new Yr.HOTP({createDigest:Tt.createDigest}),p0=new Yr.TOTP({createDigest:Tt.createDigest}),y0=new Yr.Authenticator({createDigest:Tt.createDigest,createRandomBytes:Tt.createRandomBytes,keyDecoder:Xi.keyDecoder,keyEncoder:Xi.keyEncoder});He.authenticator=y0;He.hotp=h0;He.totp=p0});var eo=d(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});var Zi=Ji();Object.keys(Zi).forEach(function(t){t!=="default"&&Object.defineProperty(Wr,t,{enumerable:!0,get:function(){return Zi[t]}})})});var to=d((IS,g0)=>{g0.exports={acl:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},append:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},asking:{arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},auth:{arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},bgrewriteaof:{arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bgsave:{arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},bitcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bitfield:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},bitfield_ro:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bitop:{arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},bitpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},blmove:{arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},blmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},blpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpop:{arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},brpoplpush:{arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},bzmpop:{arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},bzpopmax:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},bzpopmin:{arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},client:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},cluster:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},command:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},config:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},copy:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},dbsize:{arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},debug:{arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},decr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},decrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},del:{arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},discard:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},dump:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},echo:{arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},evalsha_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},exec:{arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},exists:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},expire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},expiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},failover:{arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},fcall:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},fcall_ro:{arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},flushall:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},flushdb:{arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},geodist:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},geohash:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},geopos:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadius:{arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadius_ro:{arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},georadiusbymember:{arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},georadiusbymember_ro:{arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearch:{arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},geosearchstore:{arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},get:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getbit:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},getdel:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getex:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},getrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},getset:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hello:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},hexists:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hpexpire:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},hget:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hgetall:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hincrbyfloat:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hkeys:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmget:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hmset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hrandfield:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},hscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},hset:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hsetnx:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hstrlen:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},hvals:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},incr:{arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrby:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},incrbyfloat:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},info:{arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},keys:{arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},lastsave:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},latency:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},lcs:{arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},lindex:{arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},linsert:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},llen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},lmove:{arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},lmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},lolwut:{arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},lpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},lpos:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},lpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},lrange:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},lrem:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},lset:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ltrim:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},memory:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mget:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},migrate:{arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},module:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},monitor:{arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},move:{arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},mset:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},msetnx:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},multi:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},object:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},persist:{arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpire:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpireat:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},pexpiretime:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},pfadd:{arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},pfcount:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},pfdebug:{arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},pfmerge:{arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},pfselftest:{arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ping:{arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},psetex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},psubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},psync:{arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},pttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},publish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},pubsub:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},punsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},quit:{arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},randomkey:{arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},readonly:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},readwrite:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},rename:{arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},renamenx:{arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},replconf:{arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},replicaof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},reset:{arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},restore:{arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:{arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},rpop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rpoplpush:{arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},rpush:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},rpushx:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},sadd:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},save:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},scan:{arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},scard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},script:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},sdiff:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sdiffstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},select:{arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},set:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setbit:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setex:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},setnx:{arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},setrange:{arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},shutdown:{arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},sinter:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},sinterstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sismember:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},slaveof:{arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},slowlog:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},smembers:{arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},smismember:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},smove:{arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},sort:{arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},sort_ro:{arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},spop:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},spublish:{arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},srandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},srem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},sscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ssubscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},strlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},subscribe:{arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},substr:{arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},sunion:{arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},sunionstore:{arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},sunsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},swapdb:{arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},sync:{arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},time:{arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},touch:{arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},ttl:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},type:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},unlink:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},unsubscribe:{arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},unwatch:{arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wait:{arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},watch:{arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xack:{arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xadd:{arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xautoclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xclaim:{arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdel:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xdelex:{arity:-5,flags:["write","fast"],keyStart:1,keyStop:1,step:1},xgroup:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xinfo:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},xlen:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},xpending:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},xrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xread:{arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xreadgroup:{arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},xrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},xsetid:{arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},xtrim:{arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},zadd:{arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zcard:{arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zdiff:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zdiffstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zincrby:{arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},zinter:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zintercard:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zinterstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},zlexcount:{arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zmpop:{arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},zmscore:{arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zpopmax:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zpopmin:{arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zrandmember:{arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrangestore:{arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},zrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zrem:{arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},zremrangebylex:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyrank:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zremrangebyscore:{arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},zrevrange:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebylex:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrangebyscore:{arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},zrevrank:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zscan:{arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},zscore:{arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},zunion:{arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zunionstore:{arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1}}});var _e=d($=>{"use strict";var m0=$&&$.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty($,"__esModule",{value:!0});$.getKeyIndexes=$.hasFlag=$.exists=$.list=void 0;var It=m0(to());$.list=Object.keys(It.default);var Xr={};$.list.forEach(t=>{Xr[t]=It.default[t].flags.reduce(function(e,r){return e[r]=!0,e},{})});function x0(t){return!!It.default[t]}$.exists=x0;function b0(t,e){if(!Xr[t])throw new Error("Unknown command "+t);return!!Xr[t][e]}$.hasFlag=b0;function S0(t,e,r){let s=It.default[t];if(!s)throw new Error("Unknown command "+t);if(!Array.isArray(e))throw new Error("Expect args to be an array");let n=[],i=!!(r&&r.parseExternalKey),o=(a,u)=>{let l=[],f=Number(a[u]);for(let p=0;p<f;p++)l.push(p+u+1);return l},c=(a,u,l)=>{for(let f=u;f<a.length-1;f+=1)if(String(a[f]).toLowerCase()===l.toLowerCase())return f+1;return null};switch(t){case"zunionstore":case"zinterstore":case"zdiffstore":n.push(0,...o(e,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":n.push(...o(e,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{n.push(...o(e,0));break}case"georadius":{n.push(0);let a=c(e,5,"STORE");a&&n.push(a);let u=c(e,5,"STOREDIST");u&&n.push(u);break}case"georadiusbymember":{n.push(0);let a=c(e,4,"STORE");a&&n.push(a);let u=c(e,4,"STOREDIST");u&&n.push(u);break}case"sort":case"sort_ro":n.push(0);for(let a=1;a<e.length-1;a++){let u=e[a];if(typeof u!="string")continue;let l=u.toUpperCase();l==="GET"?(a+=1,u=e[a],u!=="#"&&(i?n.push([a,ro(u)]):n.push(a))):l==="BY"?(a+=1,i?n.push([a,ro(e[a])]):n.push(a)):l==="STORE"&&(a+=1,n.push(a))}break;case"migrate":if(e[2]==="")for(let a=5;a<e.length-1;a++){let u=e[a];if(typeof u=="string"&&u.toUpperCase()==="KEYS"){for(let l=a+1;l<e.length;l++)n.push(l);break}}else n.push(2);break;case"xreadgroup":case"xread":for(let a=t==="xread"?0:3;a<e.length-1;a++)if(String(e[a]).toUpperCase()==="STREAMS"){for(let u=a+1;u<=a+(e.length-1-a)/2;u++)n.push(u);break}break;default:if(s.step>0){let a=s.keyStart-1,u=s.keyStop>0?s.keyStop:e.length+s.keyStop+1;for(let l=a;l<u;l+=s.step)n.push(l)}break}return n}$.getKeyIndexes=S0;function ro(t){typeof t!="string"&&(t=String(t));let e=t.indexOf("->");return e===-1?t.length:e}});var so=d(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.tryCatch=ie.errorObj=void 0;ie.errorObj={e:{}};var Jr;function E0(t,e){try{let r=Jr;return Jr=null,r.apply(this,arguments)}catch(r){return ie.errorObj.e=r,ie.errorObj}}function w0(t){return Jr=t,E0}ie.tryCatch=w0});var oe=d(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});var Oe=so();function no(t){setTimeout(function(){throw t},0)}function k0(t,e,r){return typeof e=="function"&&t.then(s=>{let n;r!==void 0&&Object(r).spread&&Array.isArray(s)?n=Oe.tryCatch(e).apply(void 0,[null].concat(s)):n=s===void 0?Oe.tryCatch(e)(null):Oe.tryCatch(e)(null,s),n===Oe.errorObj&&no(n.e)},s=>{if(!s){let i=new Error(s+"");Object.assign(i,{cause:s}),s=i}let n=Oe.tryCatch(e)(s);n===Oe.errorObj&&no(n.e)}),t}Zr.default=k0});var ao=d((PS,oo)=>{"use strict";var io=require("assert"),Qe=require("util");function Re(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Qe.inherits(Re,Error);Object.defineProperty(Re.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function es(t,e,r){io(e),io.strictEqual(typeof r,"number"),Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let s=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=s,this.offset=r,this.buffer=e}Qe.inherits(es,Re);Object.defineProperty(es.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function ts(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0});let e=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=e}Qe.inherits(ts,Re);Object.defineProperty(ts.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function Nt(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Qe.inherits(Nt,Re);Object.defineProperty(Nt.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function rs(t){Object.defineProperty(this,"message",{value:t||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}Qe.inherits(rs,Nt);Object.defineProperty(rs.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0});oo.exports={RedisError:Re,ParserError:es,ReplyError:ts,AbortError:Nt,InterruptError:rs}});var fo=d((LS,uo)=>{"use strict";var co=require("assert"),Te=class extends Error{get name(){return this.constructor.name}},ss=class extends Te{constructor(e,r,s){co(r),co.strictEqual(typeof s,"number");let n=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=n,this.offset=s,this.buffer=r}get name(){return this.constructor.name}},ns=class extends Te{constructor(e){let r=Error.stackTraceLimit;Error.stackTraceLimit=2,super(e),Error.stackTraceLimit=r}get name(){return this.constructor.name}},qt=class extends Te{get name(){return this.constructor.name}},is=class extends qt{get name(){return this.constructor.name}};uo.exports={RedisError:Te,ParserError:ss,ReplyError:ns,AbortError:qt,InterruptError:is}});var be=d((DS,lo)=>{"use strict";var v0=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?ao():fo();lo.exports=v0});var Ve=d((BS,os)=>{var ho=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],A0=function(e){for(var r,s=0,n=0,i=[],o=e.length;s<o;s++)r=e.charCodeAt(s),r<128?i[n++]=r:r<2048?(i[n++]=r>>6|192,i[n++]=r&63|128):(r&64512)===55296&&s+1<e.length&&(e.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++s)&1023),i[n++]=r>>18|240,i[n++]=r>>12&63|128,i[n++]=r>>6&63|128,i[n++]=r&63|128):(i[n++]=r>>12|224,i[n++]=r>>6&63|128,i[n++]=r&63|128);return i},po=os.exports=function(e){for(var r,s=0,n=-1,i=0,o=0,c=typeof e=="string"?A0(e):e,a=c.length;s<a;){if(r=c[s++],n===-1)r===123&&(n=s);else if(r!==125)o=ho[(r^o>>8)&255]^o<<8;else if(s-1!==n)return o&16383;i=ho[(r^i>>8)&255]^i<<8}return i&16383};os.exports.generateMulti=function(e){for(var r=1,s=e.length,n=po(e[0]);r<s;)if(po(e[r++])!==n)return-1;return n}});var wo=d((jS,Eo)=>{var go=9007199254740991,C0="[object Arguments]",_0="[object Function]",O0="[object GeneratorFunction]",R0=/^(?:0|[1-9]\d*)$/;function mo(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function T0(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}var ze=Object.prototype,Ke=ze.hasOwnProperty,xo=ze.toString,I0=ze.propertyIsEnumerable,yo=Math.max;function N0(t,e){var r=U0(t)||$0(t)?T0(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||Ke.call(t,i))&&!(n&&(i=="length"||So(i,s)))&&r.push(i);return r}function q0(t,e,r,s){return t===void 0||as(t,ze[r])&&!Ke.call(s,r)?e:t}function M0(t,e,r){var s=t[e];(!(Ke.call(t,e)&&as(s,r))||r===void 0&&!(e in t))&&(t[e]=r)}function P0(t){if(!us(t))return F0(t);var e=j0(t),r=[];for(var s in t)s=="constructor"&&(e||!Ke.call(t,s))||r.push(s);return r}function bo(t,e){return e=yo(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,n=yo(r.length-e,0),i=Array(n);++s<n;)i[s]=r[e+s];s=-1;for(var o=Array(e+1);++s<e;)o[s]=r[s];return o[e]=i,mo(t,this,o)}}function L0(t,e,r,s){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n],c=s?s(r[o],t[o],o,r,t):void 0;M0(r,o,c===void 0?t[o]:c)}return r}function D0(t){return bo(function(e,r){var s=-1,n=r.length,i=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(i=t.length>3&&typeof i=="function"?(n--,i):void 0,o&&B0(r[0],r[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++s<n;){var c=r[s];c&&t(e,c,s,i)}return e})}function So(t,e){return e=e??go,!!e&&(typeof t=="number"||R0.test(t))&&t>-1&&t%1==0&&t<e}function B0(t,e,r){if(!us(r))return!1;var s=typeof e;return(s=="number"?cs(r)&&So(e,r.length):s=="string"&&e in r)?as(r[e],t):!1}function j0(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||ze;return t===r}function F0(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}function as(t,e){return t===e||t!==t&&e!==e}function $0(t){return G0(t)&&Ke.call(t,"callee")&&(!I0.call(t,"callee")||xo.call(t)==C0)}var U0=Array.isArray;function cs(t){return t!=null&&Q0(t.length)&&!H0(t)}function G0(t){return V0(t)&&cs(t)}function H0(t){var e=us(t)?xo.call(t):"";return e==_0||e==O0}function Q0(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=go}function us(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function V0(t){return!!t&&typeof t=="object"}var z0=D0(function(t,e,r,s){L0(e,Y0(e),t,s)}),K0=bo(function(t){return t.push(void 0,q0),mo(z0,void 0,t)});function Y0(t){return cs(t)?N0(t,!0):P0(t)}Eo.exports=K0});var Ao=d((FS,vo)=>{var W0=9007199254740991,X0="[object Arguments]",J0="[object Function]",Z0="[object GeneratorFunction]",fs=Object.prototype,ed=fs.hasOwnProperty,ko=fs.toString,td=fs.propertyIsEnumerable;function rd(t){return nd(t)&&ed.call(t,"callee")&&(!td.call(t,"callee")||ko.call(t)==X0)}function sd(t){return t!=null&&od(t.length)&&!id(t)}function nd(t){return cd(t)&&sd(t)}function id(t){var e=ad(t)?ko.call(t):"";return e==J0||e==Z0}function od(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=W0}function ad(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function cd(t){return!!t&&typeof t=="object"}vo.exports=rd});var Mt=d(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.isArguments=ae.defaults=ae.noop=void 0;var ud=wo();ae.defaults=ud;var fd=Ao();ae.isArguments=fd;function ld(){}ae.noop=ld});var ls=d((US,Co)=>{var Ie=1e3,Ne=Ie*60,qe=Ne*60,Se=qe*24,dd=Se*7,hd=Se*365.25;Co.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return pd(t);if(r==="number"&&isFinite(t))return e.long?gd(t):yd(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function pd(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),s=(e[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*hd;case"weeks":case"week":case"w":return r*dd;case"days":case"day":case"d":return r*Se;case"hours":case"hour":case"hrs":case"hr":case"h":return r*qe;case"minutes":case"minute":case"mins":case"min":case"m":return r*Ne;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ie;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function yd(t){var e=Math.abs(t);return e>=Se?Math.round(t/Se)+"d":e>=qe?Math.round(t/qe)+"h":e>=Ne?Math.round(t/Ne)+"m":e>=Ie?Math.round(t/Ie)+"s":t+"ms"}function gd(t){var e=Math.abs(t);return e>=Se?Pt(t,e,Se,"day"):e>=qe?Pt(t,e,qe,"hour"):e>=Ne?Pt(t,e,Ne,"minute"):e>=Ie?Pt(t,e,Ie,"second"):t+" ms"}function Pt(t,e,r,s){var n=e>=r*1.5;return Math.round(t/r)+" "+s+(n?"s":"")}});var ds=d((GS,_o)=>{function md(t){r.debug=r,r.default=r,r.coerce=a,r.disable=o,r.enable=n,r.enabled=c,r.humanize=ls(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let p=0;p<l.length;p++)f=(f<<5)-f+l.charCodeAt(p),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,p=null,h,x;function E(...j){if(!E.enabled)return;let ne=E,xe=Number(new Date),Ge=xe-(f||xe);ne.diff=Ge,ne.prev=f,ne.curr=xe,f=xe,j[0]=r.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let yt=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(Tr,Nl)=>{if(Tr==="%%")return"%";yt++;let fi=r.formatters[Nl];if(typeof fi=="function"){let ql=j[yt];Tr=fi.call(ne,ql),j.splice(yt,1),yt--}return Tr}),r.formatArgs.call(ne,j),(ne.log||r.log).apply(ne,j)}return E.namespace=l,E.useColors=r.useColors(),E.color=r.selectColor(l),E.extend=s,E.destroy=r.destroy,Object.defineProperty(E,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(h!==r.namespaces&&(h=r.namespaces,x=r.enabled(l)),x),set:j=>{p=j}}),typeof r.init=="function"&&r.init(E),E}function s(l,f){let p=r(this.namespace+(typeof f>"u"?":":f)+l);return p.log=this.log,p}function n(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f=(typeof l=="string"?l:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let p of f)p[0]==="-"?r.skips.push(p.slice(1)):r.names.push(p)}function i(l,f){let p=0,h=0,x=-1,E=0;for(;p<l.length;)if(h<f.length&&(f[h]===l[p]||f[h]==="*"))f[h]==="*"?(x=h,E=p,h++):(p++,h++);else if(x!==-1)h=x+1,E++,p=E;else return!1;for(;h<f.length&&f[h]==="*";)h++;return h===f.length}function o(){let l=[...r.names,...r.skips.map(f=>"-"+f)].join(",");return r.enable(""),l}function c(l){for(let f of r.skips)if(i(l,f))return!1;for(let f of r.names)if(i(l,f))return!0;return!1}function a(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}_o.exports=md});var Oo=d((F,Lt)=>{F.formatArgs=bd;F.save=Sd;F.load=Ed;F.useColors=xd;F.storage=wd();F.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();F.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function xd(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function bd(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Lt.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(s=r))}),t.splice(s,0,e)}F.log=console.debug||console.log||(()=>{});function Sd(t){try{t?F.storage.setItem("debug",t):F.storage.removeItem("debug")}catch{}}function Ed(){let t;try{t=F.storage.getItem("debug")||F.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function wd(){try{return localStorage}catch{}}Lt.exports=ds()(F);var{formatters:kd}=Lt.exports;kd.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var To=d((HS,Ro)=>{"use strict";Ro.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",s=e.indexOf(r+t),n=e.indexOf("--");return s!==-1&&(n===-1||s<n)}});var qo=d((QS,No)=>{"use strict";var vd=require("os"),Io=require("tty"),G=To(),{env:R}=process,Dt;G("no-color")||G("no-colors")||G("color=false")||G("color=never")?Dt=0:(G("color")||G("colors")||G("color=true")||G("color=always"))&&(Dt=1);function Ad(){if("FORCE_COLOR"in R)return R.FORCE_COLOR==="true"?1:R.FORCE_COLOR==="false"?0:R.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(R.FORCE_COLOR,10),3)}function Cd(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function _d(t,{streamIsTTY:e,sniffFlags:r=!0}={}){let s=Ad();s!==void 0&&(Dt=s);let n=r?Dt:s;if(n===0)return 0;if(r){if(G("color=16m")||G("color=full")||G("color=truecolor"))return 3;if(G("color=256"))return 2}if(t&&!e&&n===void 0)return 0;let i=n||0;if(R.TERM==="dumb")return i;if(process.platform==="win32"){let o=vd.release().split(".");return Number(o[0])>=10&&Number(o[2])>=10586?Number(o[2])>=14931?3:2:1}if("CI"in R)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(o=>o in R)||R.CI_NAME==="codeship"?1:i;if("TEAMCITY_VERSION"in R)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(R.TEAMCITY_VERSION)?1:0;if(R.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in R){let o=Number.parseInt((R.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(R.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(R.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(R.TERM)||"COLORTERM"in R?1:i}function hs(t,e={}){let r=_d(t,{streamIsTTY:t&&t.isTTY,...e});return Cd(r)}No.exports={supportsColor:hs,stdout:hs({isTTY:Io.isatty(1)}),stderr:hs({isTTY:Io.isatty(2)})}});var Po=d((T,jt)=>{var Od=require("tty"),Bt=require("util");T.init=Pd;T.log=Nd;T.formatArgs=Td;T.save=qd;T.load=Md;T.useColors=Rd;T.destroy=Bt.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");T.colors=[6,2,3,4,5,1];try{let t=qo();t&&(t.stderr||t).level>=2&&(T.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}T.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[e];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),t[r]=s,t},{});function Rd(){return"colors"in T.inspectOpts?!!T.inspectOpts.colors:Od.isatty(process.stderr.fd)}function Td(t){let{namespace:e,useColors:r}=this;if(r){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${e} \x1B[0m`;t[0]=i+t[0].split(`
`).join(`
`+i),t.push(n+"m+"+jt.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Id()+e+" "+t[0]}function Id(){return T.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Nd(...t){return process.stderr.write(Bt.formatWithOptions(T.inspectOpts,...t)+`
`)}function qd(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function Md(){return process.env.DEBUG}function Pd(t){t.inspectOpts={};let e=Object.keys(T.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=T.inspectOpts[e[r]]}jt.exports=ds()(T);var{formatters:Mo}=jt.exports;Mo.o=function(t){return this.inspectOpts.colors=this.useColors,Bt.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};Mo.O=function(t){return this.inspectOpts.colors=this.useColors,Bt.inspect(t,this.inspectOpts)}});var Lo=d((VS,ps)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?ps.exports=Oo():ps.exports=Po()});var jo=d(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.genRedactedString=te.getStringValue=te.MAX_ARGUMENT_LENGTH=void 0;var Ld=Lo(),ys=200;te.MAX_ARGUMENT_LENGTH=ys;var Dd="ioredis";function Do(t){if(t!==null)switch(typeof t){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(t))return t.toString("hex");if(Array.isArray(t))return t.join(",");try{return JSON.stringify(t)}catch{return}case"string":return t}}te.getStringValue=Do;function Bo(t,e){let{length:r}=t;return r<=e?t:t.slice(0,e)+' ... <REDACTED full-length="'+r+'">'}te.genRedactedString=Bo;function Bd(t){let e=(0,Ld.default)(`${Dd}:${t}`);function r(...s){if(e.enabled){for(let n=1;n<s.length;n++){let i=Do(s[n]);typeof i=="string"&&i.length>ys&&(s[n]=Bo(i,ys))}return e.apply(null,s)}}return Object.defineProperties(r,{namespace:{get(){return e.namespace}},enabled:{get(){return e.enabled}},destroy:{get(){return e.destroy}},log:{get(){return e.log},set(s){e.log=s}}}),r}te.default=Bd});var $o=d(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});var Fo=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,jd={RedisCloudFixed:{ca:Fo},RedisCloudFlexible:{ca:Fo}};gs.default=jd});var I=d(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.noop=S.defaults=S.Debug=S.getPackageMeta=S.zipMap=S.CONNECTION_CLOSED_ERROR_MSG=S.shuffle=S.sample=S.resolveTLSProfile=S.parseURL=S.optimizeErrorStack=S.toArg=S.convertMapToArray=S.convertObjectToArray=S.timeout=S.packObject=S.isInt=S.wrapMultiResult=S.convertBufferToString=void 0;var Fd=require("fs"),$d=require("path"),Uo=require("url"),ms=Mt();Object.defineProperty(S,"defaults",{enumerable:!0,get:function(){return ms.defaults}});Object.defineProperty(S,"noop",{enumerable:!0,get:function(){return ms.noop}});var Ud=jo();S.Debug=Ud.default;var Gd=$o();function Go(t,e){if(t instanceof Buffer)return t.toString(e);if(Array.isArray(t)){let r=t.length,s=Array(r);for(let n=0;n<r;++n)s[n]=t[n]instanceof Buffer&&e==="utf8"?t[n].toString():Go(t[n],e);return s}return t}S.convertBufferToString=Go;function Hd(t){if(!t)return null;let e=[],r=t.length;for(let s=0;s<r;++s){let n=t[s];n instanceof Error?e.push([n]):e.push([null,n])}return e}S.wrapMultiResult=Hd;function Ho(t){let e=parseFloat(t);return!isNaN(t)&&(e|0)===e}S.isInt=Ho;function Qd(t){let e={},r=t.length;for(let s=1;s<r;s+=2)e[t[s-1]]=t[s];return e}S.packObject=Qd;function Vd(t,e){let r=null,s=function(){r&&(clearTimeout(r),r=null,t.apply(this,arguments))};return r=setTimeout(s,e,new Error("timeout")),s}S.timeout=Vd;function zd(t){let e=[],r=Object.keys(t);for(let s=0,n=r.length;s<n;s++)e.push(r[s],t[r[s]]);return e}S.convertObjectToArray=zd;function Kd(t){let e=[],r=0;return t.forEach(function(s,n){e[r]=n,e[r+1]=s,r+=2}),e}S.convertMapToArray=Kd;function Yd(t){return t===null||typeof t>"u"?"":String(t)}S.toArg=Yd;function Wd(t,e,r){let s=e.split(`
`),n="",i;for(i=1;i<s.length&&s[i].indexOf(r)!==-1;++i);for(let o=i;o<s.length;++o)n+=`
`+s[o];if(t.stack){let o=t.stack.indexOf(`
`);t.stack=t.stack.slice(0,o)+n}return t}S.optimizeErrorStack=Wd;function Xd(t){if(Ho(t))return{port:t};let e=(0,Uo.parse)(t,!0,!0);!e.slashes&&t[0]!=="/"&&(t="//"+t,e=(0,Uo.parse)(t,!0,!0));let r=e.query||{},s={};if(e.auth){let n=e.auth.indexOf(":");s.username=n===-1?e.auth:e.auth.slice(0,n),s.password=n===-1?"":e.auth.slice(n+1)}if(e.pathname&&(e.protocol==="redis:"||e.protocol==="rediss:"?e.pathname.length>1&&(s.db=e.pathname.slice(1)):s.path=e.pathname),e.host&&(s.host=e.hostname),e.port&&(s.port=e.port),typeof r.family=="string"){let n=Number.parseInt(r.family,10);Number.isNaN(n)||(s.family=n)}return(0,ms.defaults)(s,r),s}S.parseURL=Xd;function Jd(t){let e=t?.tls;typeof e=="string"&&(e={profile:e});let r=Gd.default[e?.profile];return r&&(e=Object.assign({},r,e),delete e.profile,t=Object.assign({},t,{tls:e})),t}S.resolveTLSProfile=Jd;function Zd(t,e=0){let r=t.length;return e>=r?null:t[e+Math.floor(Math.random()*(r-e))]}S.sample=Zd;function eh(t){let e=t.length;for(;e>0;){let r=Math.floor(Math.random()*e);e--,[t[e],t[r]]=[t[r],t[e]]}return t}S.shuffle=eh;S.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function th(t,e){let r=new Map;return t.forEach((s,n)=>{r.set(s,e[n])}),r}S.zipMap=th;var Me=null;async function rh(){if(Me)return Me;try{let t=(0,$d.resolve)(__dirname,"..","..","package.json"),e=await Fd.promises.readFile(t,"utf8");return Me={version:JSON.parse(e).version},Me}catch{return Me={version:"error-fetching-version"},Me}}S.getPackageMeta=rh});var re=d(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});var Qo=_e(),sh=Ve(),nh=oe(),Ee=I(),W=class t{constructor(e,r=[],s={},n){if(this.name=e,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=s.replyEncoding,this.errorStack=s.errorStack,this.args=r.flat(),this.callback=n,this.initPromise(),s.keyPrefix){let i=s.keyPrefix instanceof Buffer,o=i?s.keyPrefix:null;this._iterateKeys(c=>c instanceof Buffer?(o===null&&(o=Buffer.from(s.keyPrefix)),Buffer.concat([o,c])):i?Buffer.concat([s.keyPrefix,Buffer.from(String(c))]):s.keyPrefix+c)}s.readOnly&&(this.isReadOnly=!0)}static checkFlag(e,r){return!!this.getFlagMap()[e][r]}static setArgumentTransformer(e,r){this._transformer.argument[e]=r}static setReplyTransformer(e,r){this._transformer.reply[e]=r}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(t.FLAGS).reduce((e,r)=>(e[r]={},t.FLAGS[r].forEach(s=>{e[r][s]=!0}),e),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){let e=this.getKeys()[0];this.slot=e==null?null:sh(e)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(e){let r,s="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){let n=new xs;n.push(s);for(let i=0;i<this.args.length;++i){let o=this.args[i];o instanceof Buffer?o.length===0?n.push(`$0\r
\r
`):(n.push("$"+o.length+`\r
`),n.push(o),n.push(`\r
`)):n.push("$"+Buffer.byteLength(o)+`\r
`+o+`\r
`)}r=n.toBuffer()}else{r=s;for(let n=0;n<this.args.length;++n){let i=this.args[n];r+="$"+Buffer.byteLength(i)+`\r
`+i+`\r
`}}return r}stringifyArguments(){for(let e=0;e<this.args.length;++e){let r=this.args[e];typeof r=="string"||(r instanceof Buffer?this.bufferMode=!0:this.args[e]=(0,Ee.toArg)(r))}}transformReply(e){this.replyEncoding&&(e=(0,Ee.convertBufferToString)(e,this.replyEncoding));let r=t._transformer.reply[this.name];return r&&(e=r(e)),e}setTimeout(e){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},e))}initPromise(){let e=new Promise((r,s)=>{if(!this.transformed){this.transformed=!0;let n=t._transformer.argument[this.name];n&&(this.args=n(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(r),this.errorStack?this.reject=n=>{s((0,Ee.optimizeErrorStack)(n,this.errorStack.stack,__dirname))}:this.reject=s});this.promise=(0,nh.default)(e,this.callback)}_iterateKeys(e=r=>r){if(typeof this.keys>"u"&&(this.keys=[],(0,Qo.exists)(this.name))){let r=(0,Qo.getKeyIndexes)(this.name,this.args);for(let s of r)this.args[s]=e(this.args[s]),this.keys.push(this.args[s])}return this.keys}_convertValue(e){return r=>{try{let s=this._commandTimeoutTimer;s&&(clearTimeout(s),delete this._commandTimeoutTimer),e(this.transformReply(r)),this.isResolved=!0}catch(s){this.reject(s)}return this.promise}}};bs.default=W;W.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"],HANDSHAKE_COMMANDS:["auth","select","client","readonly","info"],IGNORE_RECONNECT_ON_ERROR:["client"]};W._transformer={argument:{},reply:{}};var Vo=function(t){if(t.length===1){if(t[0]instanceof Map)return(0,Ee.convertMapToArray)(t[0]);if(typeof t[0]=="object"&&t[0]!==null)return(0,Ee.convertObjectToArray)(t[0])}return t},zo=function(t){if(t.length===2){if(t[1]instanceof Map)return[t[0]].concat((0,Ee.convertMapToArray)(t[1]));if(typeof t[1]=="object"&&t[1]!==null)return[t[0]].concat((0,Ee.convertObjectToArray)(t[1]))}return t};W.setArgumentTransformer("mset",Vo);W.setArgumentTransformer("msetnx",Vo);W.setArgumentTransformer("hset",zo);W.setArgumentTransformer("hmset",zo);W.setReplyTransformer("hgetall",function(t){if(Array.isArray(t)){let e={};for(let r=0;r<t.length;r+=2){let s=t[r],n=t[r+1];s in e?Object.defineProperty(e,s,{value:n,configurable:!0,enumerable:!0,writable:!0}):e[s]=n}return e}return t});var xs=class{constructor(){this.length=0,this.items=[]}push(e){this.length+=Buffer.byteLength(e),this.items.push(e)}toBuffer(){let e=Buffer.allocUnsafe(this.length),r=0;for(let s of this.items){let n=Buffer.byteLength(s);Buffer.isBuffer(s)?s.copy(e,r):e.write(s,r,n),r+=n}return e}}});var Ko=d(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});var ih=be(),Ft=class extends ih.RedisError{constructor(e,r){super(e),this.lastNodeError=r,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};Ss.default=Ft;Ft.defaultMessage="Failed to refresh slots cache."});var $t=d(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});var oh=require("stream"),Es=class extends oh.Readable{constructor(e){super(e),this.opt=e,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}let e=[this._redisCursor];this.opt.key&&e.unshift(this.opt.key),this.opt.match&&e.push("MATCH",this.opt.match),this.opt.type&&e.push("TYPE",this.opt.type),this.opt.count&&e.push("COUNT",String(this.opt.count)),this.opt.noValues&&e.push("NOVALUES"),this.opt.redis[this.opt.command](e,(r,s)=>{if(r){this.emit("error",r);return}this._redisCursor=s[0]instanceof Buffer?s[0].toString():s[0],this._redisCursor==="0"&&(this._redisDrained=!0),this.push(s[1])})}close(){this._redisDrained=!0}};ws.default=Es});var ea=d(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.executeWithAutoPipelining=O.getFirstValueInFlattenedArray=O.shouldUseAutoPipelining=O.notAllowedAutoPipelineCommands=O.kCallbacks=O.kExec=void 0;var Wo=Mt(),ah=Ve(),Yo=oe();O.kExec=Symbol("exec");O.kCallbacks=Symbol("callbacks");O.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select","client"];function Xo(t,e){if(t._runningAutoPipelines.has(e)||!t._autoPipelines.has(e))return;t._runningAutoPipelines.add(e);let r=t._autoPipelines.get(e);t._autoPipelines.delete(e);let s=r[O.kCallbacks];r[O.kCallbacks]=null,r.exec(function(n,i){if(t._runningAutoPipelines.delete(e),n)for(let o=0;o<s.length;o++)process.nextTick(s[o],n);else for(let o=0;o<s.length;o++)process.nextTick(s[o],...i[o]);t._autoPipelines.has(e)&&Xo(t,e)})}function ch(t,e,r){return e&&t.options.enableAutoPipelining&&!t.isPipeline&&!O.notAllowedAutoPipelineCommands.includes(r)&&!t.options.autoPipeliningIgnoredCommands.includes(r)}O.shouldUseAutoPipelining=ch;function Jo(t){for(let e=0;e<t.length;e++){let r=t[e];if(typeof r=="string")return r;if(Array.isArray(r)||(0,Wo.isArguments)(r)){if(r.length===0)continue;return r[0]}let s=[r].flat();if(s.length>0)return s[0]}}O.getFirstValueInFlattenedArray=Jo;function Zo(t,e,r,s,n){if(t.isCluster&&!t.slots.length)return t.status==="wait"&&t.connect().catch(Wo.noop),(0,Yo.default)(new Promise(function(u,l){t.delayUntilReady(f=>{if(f){l(f);return}Zo(t,e,r,s,null).then(u,l)})}),n);let i=t.options.keyPrefix||"",o=t.isCluster?t.slots[ah(`${i}${Jo(s)}`)].join(","):"main";if(!t._autoPipelines.has(o)){let u=t.pipeline();u[O.kExec]=!1,u[O.kCallbacks]=[],t._autoPipelines.set(o,u)}let c=t._autoPipelines.get(o);c[O.kExec]||(c[O.kExec]=!0,setImmediate(Xo,t,o));let a=new Promise(function(u,l){c[O.kCallbacks].push(function(f,p){if(f){l(f);return}u(p)}),e==="call"&&s.unshift(r),c[e](...s)});return(0,Yo.default)(a,n)}O.executeWithAutoPipelining=Zo});var ta=d(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});var uh=require("crypto"),fh=re(),lh=oe(),ks=class{constructor(e,r=null,s="",n=!1){this.lua=e,this.numberOfKeys=r,this.keyPrefix=s,this.readOnly=n,this.sha=(0,uh.createHash)("sha1").update(e).digest("hex");let i=this.sha,o=new WeakSet;this.Command=class extends fh.default{toWritable(a){let u=this.reject;return this.reject=l=>{l.message.indexOf("NOSCRIPT")!==-1&&o.delete(a),u.call(this,l)},o.has(a)?this.name==="eval"&&(this.name="evalsha",this.args[0]=i):(o.add(a),this.name="eval",this.args[0]=e),super.toWritable(a)}}}execute(e,r,s,n){typeof this.numberOfKeys=="number"&&r.unshift(this.numberOfKeys),this.keyPrefix&&(s.keyPrefix=this.keyPrefix),this.readOnly&&(s.readOnly=!0);let i=new this.Command("evalsha",[this.sha,...r],s);return i.promise=i.promise.catch(o=>{if(o.message.indexOf("NOSCRIPT")===-1)throw o;let c=new this.Command("evalsha",[this.sha,...r],s);return(e.isPipeline?e.redis:e).sendCommand(c)}),(0,lh.default)(i.promise,n),e.sendCommand(i)}};vs.default=ks});var Gt=d(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});var dh=_e(),Ut=ea(),hh=re(),ph=ta(),se=class{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return As.slice(0)}createBuiltinCommand(e){return{string:ce(null,e,"utf8"),buffer:ce(null,e,null)}}addBuiltinCommand(e){this.addedBuiltinSet.add(e),this[e]=ce(e,e,"utf8"),this[e+"Buffer"]=ce(e+"Buffer",e,null)}defineCommand(e,r){let s=new ph.default(r.lua,r.numberOfKeys,this.options.keyPrefix,r.readOnly);this.scriptsSet[e]=s,this[e]=ra(e,e,s,"utf8"),this[e+"Buffer"]=ra(e+"Buffer",e,s,null)}sendCommand(e,r,s){throw new Error('"sendCommand" is not implemented')}},As=dh.list.filter(t=>t!=="monitor");As.push("sentinel");As.forEach(function(t){se.prototype[t]=ce(t,t,"utf8"),se.prototype[t+"Buffer"]=ce(t+"Buffer",t,null)});se.prototype.call=ce("call","utf8");se.prototype.callBuffer=ce("callBuffer",null);se.prototype.send_command=se.prototype.call;function ce(t,e,r){return typeof r>"u"&&(r=e,e=null),function(...s){let n=e||s.shift(),i=s[s.length-1];typeof i=="function"?s.pop():i=void 0;let o={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,Ut.shouldUseAutoPipelining)(this,t,n)?(0,Ut.executeWithAutoPipelining)(this,t,n,s,i):this.sendCommand(new hh.default(n,s,o,i))}}function ra(t,e,r,s){return function(...n){let i=typeof n[n.length-1]=="function"?n.pop():void 0,o={replyEncoding:s};return this.options.showFriendlyErrorStack&&(o.errorStack=new Error),(0,Ut.shouldUseAutoPipelining)(this,t,e)?(0,Ut.executeWithAutoPipelining)(this,t,e,n,i):r.execute(this,n,o,i)}}Cs.default=se});var Rs=d(Os=>{"use strict";Object.defineProperty(Os,"__esModule",{value:!0});var _s=Ve(),sa=_e(),na=oe(),yh=require("util"),gh=re(),mh=I(),xh=Gt();function bh(t,e){let r=_s(e[0]),s=t._groupsBySlot[r];for(let n=1;n<e.length;n++)if(t._groupsBySlot[_s(e[n])]!==s)return-1;return r}var ue=class extends xh.default{constructor(e){super(),this.redis=e,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=e.options,Object.keys(e.scriptsSet).forEach(s=>{let n=e.scriptsSet[s];this._shaToScript[n.sha]=n,this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),e.addedBuiltinSet.forEach(s=>{this[s]=e[s],this[s+"Buffer"]=e[s+"Buffer"]}),this.promise=new Promise((s,n)=>{this.resolve=s,this.reject=n});let r=this;Object.defineProperty(this,"length",{get:function(){return r._queue.length}})}fillResult(e,r){if(this._queue[r].name==="exec"&&Array.isArray(e[1])){let n=e[1].length;for(let i=0;i<n;i++){if(e[1][i]instanceof Error)continue;let o=this._queue[r-(n-i)];try{e[1][i]=o.transformReply(e[1][i])}catch(c){e[1][i]=c}}}if(this._result[r]=e,--this.replyPending)return;if(this.isCluster){let n=!0,i;for(let o=0;o<this._result.length;++o){let c=this._result[o][0],a=this._queue[o];if(c){if(a.name==="exec"&&c.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!i)i={name:c.name,message:c.message};else if(i.name!==c.name||i.message!==c.message){n=!1;break}}else if(!a.inTransaction&&!((0,sa.exists)(a.name)&&(0,sa.hasFlag)(a.name,"readonly"))){n=!1;break}}if(i&&n){let o=this,c=i.message.split(" "),a=this._queue,u=!1;this._queue=[];for(let h=0;h<a.length;++h){if(c[0]==="ASK"&&!u&&a[h].name!=="asking"&&(!a[h-1]||a[h-1].name!=="asking")){let x=new gh.default("asking");x.ignore=!0,this.sendCommand(x)}a[h].initPromise(),this.sendCommand(a[h]),u=a[h].inTransaction}let l=!0;typeof this.leftRedirections>"u"&&(this.leftRedirections={});let f=function(){o.exec()},p=this.redis;if(p.handleError(i,this.leftRedirections,{moved:function(h,x){o.preferKey=x,p.slots[c[1]]=[x],p._groupsBySlot[c[1]]=p._groupsIds[p.slots[c[1]].join(";")],p.refreshSlotsCache(),o.exec()},ask:function(h,x){o.preferKey=x,o.exec()},tryagain:f,clusterDown:f,connectionClosed:f,maxRedirections:()=>{l=!1},defaults:()=>{l=!1}}),l)return}}let s=0;for(let n=0;n<this._queue.length-s;++n)this._queue[n+s].ignore&&(s+=1),this._result[n]=this._result[n+s];this.resolve(this._result.slice(0,this._result.length-s))}sendCommand(e){this._transactions>0&&(e.inTransaction=!0);let r=this._queue.length;return e.pipelineIndex=r,e.promise.then(s=>{this.fillResult([null,s],r)}).catch(s=>{this.fillResult([s],r)}),this._queue.push(e),this}addBatch(e){let r,s,n;for(let i=0;i<e.length;++i)r=e[i],s=r[0],n=r.slice(1),this[s].apply(this,n);return this}};Os.default=ue;var Sh=ue.prototype.multi;ue.prototype.multi=function(){return this._transactions+=1,Sh.apply(this,arguments)};var ia=ue.prototype.execBuffer;ue.prototype.execBuffer=(0,yh.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),ia.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");ue.prototype.exec=function(t){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(mh.noop),t&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,na.default)(this.promise,t)),this.redis.delayUntilReady(n=>{if(n){this.reject(n);return}this.exec(t)}),this.promise;if(this._transactions>0)return this._transactions-=1,ia.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,na.default)(this.promise,t)),this._queue.length||this.resolve([]);let e;if(this.isCluster){let n=[];for(let i=0;i<this._queue.length;i++){let o=this._queue[i].getKeys();if(o.length&&n.push(o[0]),o.length&&_s.generateMulti(o)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(n.length){if(e=bh(this.redis,n),e<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else e=Math.random()*16384|0}let r=this;return s(),this.promise;function s(){let n=r.replyPending=r._queue.length,i;r.isCluster&&(i={slot:e,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let o="",c,a={isPipeline:!0,destination:r.isCluster?i:{redis:r.redis},write(u){typeof u!="string"?(c||(c=[]),o&&(c.push(Buffer.from(o,"utf8")),o=""),c.push(u)):o+=u,--n||(c?(o&&c.push(Buffer.from(o,"utf8")),a.destination.redis.stream.write(Buffer.concat(c))):a.destination.redis.stream.write(o),n=r._queue.length,o="",c=void 0)}};for(let u=0;u<r._queue.length;++u)r.redis.sendCommand(r._queue[u],a,i);return r.promise}}});var Ns=d(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.addTransactionSupport=void 0;var Ts=I(),Is=oe(),oa=Rs();function Eh(t){t.pipeline=function(s){let n=new oa.default(this);return Array.isArray(s)&&n.addBatch(s),n};let{multi:e}=t;t.multi=function(s,n){if(typeof n>"u"&&!Array.isArray(s)&&(n=s,s=null),n&&n.pipeline===!1)return e.call(this);let i=new oa.default(this);i.multi(),Array.isArray(s)&&i.addBatch(s);let o=i.exec;i.exec=function(a){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Ts.noop),(0,Is.default)(new Promise((l,f)=>{this.redis.delayUntilReady(p=>{if(p){f(p);return}this.exec(i).then(l,f)})}),a);if(this._transactions>0&&o.call(i),this.nodeifiedPromise)return o.call(i);let u=o.call(i);return(0,Is.default)(u.then(function(l){let f=l[l.length-1];if(typeof f>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(f[0]){f[0].previousErrors=[];for(let p=0;p<l.length-1;++p)l[p][0]&&f[0].previousErrors.push(l[p][0]);throw f[0]}return(0,Ts.wrapMultiResult)(f[1])}),a)};let{execBuffer:c}=i;return i.execBuffer=function(a){return this._transactions>0&&c.call(i),i.exec(a)},i};let{exec:r}=t;t.exec=function(s){return(0,Is.default)(r.call(this).then(function(n){return Array.isArray(n)&&(n=(0,Ts.wrapMultiResult)(n)),n}),s)}}Ht.addTransactionSupport=Eh});var Ms=d(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});function wh(t,e){Object.getOwnPropertyNames(e.prototype).forEach(r=>{Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r))})}qs.default=wh});var ca=d(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.DEFAULT_CLUSTER_OPTIONS=void 0;var aa=require("dns");Qt.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:t=>Math.min(100+t*2,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:aa.resolveSrv,dnsLookup:aa.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],shardedSubscribers:!1}});var Ye=d(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.getConnectionName=q.weightSrvRecords=q.groupSrvRecords=q.getUniqueHostnamesFromOptions=q.normalizeNodeOptions=q.nodeKeyToRedisOptions=q.getNodeKey=void 0;var ua=I(),kh=require("net");function vh(t){return t.port=t.port||6379,t.host=t.host||"127.0.0.1",t.host+":"+t.port}q.getNodeKey=vh;function Ah(t){let e=t.lastIndexOf(":");if(e===-1)throw new Error(`Invalid node key ${t}`);return{host:t.slice(0,e),port:Number(t.slice(e+1))}}q.nodeKeyToRedisOptions=Ah;function Ch(t){return t.map(e=>{let r={};if(typeof e=="object")Object.assign(r,e);else if(typeof e=="string")Object.assign(r,(0,ua.parseURL)(e));else if(typeof e=="number")r.port=e;else throw new Error("Invalid argument "+e);return typeof r.port=="string"&&(r.port=parseInt(r.port,10)),delete r.db,r.port||(r.port=6379),r.host||(r.host="127.0.0.1"),(0,ua.resolveTLSProfile)(r)})}q.normalizeNodeOptions=Ch;function _h(t){let e={};return t.forEach(r=>{e[r.host]=!0}),Object.keys(e).filter(r=>!(0,kh.isIP)(r))}q.getUniqueHostnamesFromOptions=_h;function Oh(t){let e={};for(let r of t)e.hasOwnProperty(r.priority)?(e[r.priority].totalWeight+=r.weight,e[r.priority].records.push(r)):e[r.priority]={totalWeight:r.weight,records:[r]};return e}q.groupSrvRecords=Oh;function Rh(t){if(t.records.length===1)return t.totalWeight=0,t.records.shift();let e=Math.floor(Math.random()*(t.totalWeight+t.records.length)),r=0;for(let[s,n]of t.records.entries())if(r+=1+n.weight,r>e)return t.totalWeight-=n.weight,t.records.splice(s,1),n}q.weightSrvRecords=Rh;function Th(t,e){let r=`ioredis-cluster(${t})`;return e?`${r}:${e}`:r}q.getConnectionName=Th});var Bs=d(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});var fa=Ye(),Ps=I(),Ih=fe(),X=(0,Ps.Debug)("cluster:subscriber"),Ls=class{constructor(e,r,s=!1){this.connectionPool=e,this.emitter=r,this.isSharded=s,this.started=!1,this.subscriber=null,this.slotRange=[],this.onSubscriberEnd=()=>{if(!this.started){X("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}X("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(n,i)=>{!this.started||!this.subscriber||(0,fa.getNodeKey)(this.subscriber.options)===i&&(X("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(X("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}associateSlotRange(e){return this.isSharded&&(this.slotRange=e),this.slotRange}start(){this.started=!0,this.selectSubscriber(),X("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null)}isStarted(){return this.started}selectSubscriber(){let e=this.lastActiveSubscriber;e&&(e.off("end",this.onSubscriberEnd),e.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());let r=(0,Ps.sample)(this.connectionPool.getNodes());if(!r){X("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}let{options:s}=r;X("selected a subscriber %s:%s",s.host,s.port);let n="subscriber";this.isSharded&&(n="ssubscriber"),this.subscriber=new Ih.default({port:s.port,host:s.host,username:s.username,password:s.password,enableReadyCheck:!0,connectionName:(0,fa.getConnectionName)(n,s.connectionName),lazyConnect:!0,tls:s.tls,retryStrategy:null}),this.subscriber.on("error",Ps.noop),this.subscriber.on("moved",()=>{this.emitter.emit("forceRefresh")}),this.subscriber.once("end",this.onSubscriberEnd);let i={subscribe:[],psubscribe:[],ssubscribe:[]};if(e){let o=e.condition||e.prevCondition;o&&o.subscriber&&(i.subscribe=o.subscriber.channels("subscribe"),i.psubscribe=o.subscriber.channels("psubscribe"),i.ssubscribe=o.subscriber.channels("ssubscribe"))}if(i.subscribe.length||i.psubscribe.length||i.ssubscribe.length){let o=0;for(let c of["subscribe","psubscribe","ssubscribe"]){let a=i[c];if(a.length!=0)if(X("%s %d channels",c,a.length),c==="ssubscribe")for(let u of a)o+=1,this.subscriber[c](u).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{X("failed to ssubscribe to channel: %s",u)});else o+=1,this.subscriber[c](a).then(()=>{--o||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{X("failed to %s %d channels",c,a.length)})}}else this.lastActiveSubscriber=this.subscriber;for(let o of["message","messageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)});for(let o of["pmessage","pmessageBuffer"])this.subscriber.on(o,(c,a,u)=>{this.emitter.emit(o,c,a,u)});if(this.isSharded==!0)for(let o of["smessage","smessageBuffer"])this.subscriber.on(o,(c,a)=>{this.emitter.emit(o,c,a)})}};Ds.default=Ls});var Us=d($s=>{"use strict";Object.defineProperty($s,"__esModule",{value:!0});var Nh=require("events"),Vt=I(),js=Ye(),qh=fe(),We=(0,Vt.Debug)("cluster:connectionPool"),Fs=class extends Nh.EventEmitter{constructor(e){super(),this.redisOptions=e,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(e="all"){let r=this.nodes[e];return Object.keys(r).map(s=>r[s])}getInstanceByKey(e){return this.nodes.all[e]}getSampleInstance(e){let r=Object.keys(this.nodes[e]),s=(0,Vt.sample)(r);return this.nodes[e][s]}addMasterNode(e){let r=(0,js.getNodeKey)(e.options),s=this.createRedisFromOptions(e,e.options.readOnly);return e.options.readOnly?!1:(this.nodes.all[r]=s,this.nodes.master[r]=s,!0)}createRedisFromOptions(e,r){return new qh.default((0,Vt.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:r},e,this.redisOptions,{lazyConnect:!0}))}findOrCreate(e,r=!1){let s=(0,js.getNodeKey)(e);r=!!r,this.specifiedOptions[s]?Object.assign(e,this.specifiedOptions[s]):this.specifiedOptions[s]=e;let n;return this.nodes.all[s]?(n=this.nodes.all[s],n.options.readOnly!==r&&(n.options.readOnly=r,We("Change role of %s to %s",s,r?"slave":"master"),n[r?"readonly":"readwrite"]().catch(Vt.noop),r?(delete this.nodes.master[s],this.nodes.slave[s]=n):(delete this.nodes.slave[s],this.nodes.master[s]=n))):(We("Connecting to %s as %s",s,r?"slave":"master"),n=this.createRedisFromOptions(e,r),this.nodes.all[s]=n,this.nodes[r?"slave":"master"][s]=n,n.once("end",()=>{this.removeNode(s),this.emit("-node",n,s),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",n,s),n.on("error",function(i){this.emit("nodeError",i,s)})),n}reset(e){We("Reset with %O",e);let r={};e.forEach(s=>{let n=(0,js.getNodeKey)(s);s.readOnly&&r[n]||(r[n]=s)}),Object.keys(this.nodes.all).forEach(s=>{r[s]||(We("Disconnect %s because the node does not hold any slot",s),this.nodes.all[s].disconnect(),this.removeNode(s))}),Object.keys(r).forEach(s=>{let n=r[s];this.findOrCreate(n,n.readOnly)})}removeNode(e){let{nodes:r}=this;r.all[e]&&(We("Remove %s from the pool",e),delete r.all[e]),delete r.master[e],delete r.slave[e]}};$s.default=Fs});var zt=d((fE,la)=>{"use strict";function C(t,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(t)?this._fromArray(t):(this._capacityMask=3,this._list=new Array(4))}C.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var s=this.size();if(!(r>=s||r<-s))return r<0&&(r+=s),r=this._head+r&this._capacityMask,this._list[r]}};C.prototype.get=function(e){return this.peekAt(e)};C.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};C.prototype.peekFront=function(){return this.peek()};C.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(C.prototype,"length",{get:function(){return this.size()}});C.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.unshift=function(e){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};C.prototype.push=function(e){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};C.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var s=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),s}};C.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var s=this.size(),n=this._list.length;if(!(r>=s||r<-s)){r<0&&(r+=s),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<s/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+n&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=s-1-e;o>0;o--)this._list[r]=this._list[r=r+1+n&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}};C.prototype.remove=function(e,r){var s=e,n,i=r;if(s===(s|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(s>=o||s<-o||r<1)){if(s<0&&(s+=o),r===1||!r)return n=new Array(1),n[0]=this.removeOne(s),n;if(s===0&&s+r>=o)return n=this.toArray(),this.clear(),n;s+r>o&&(r=o-s);var a;for(n=new Array(r),a=0;a<r;a++)n[a]=this._list[this._head+s+a&this._capacityMask];if(s=this._head+s&this._capacityMask,e+r===o){for(this._tail=this._tail-r+c&this._capacityMask,a=r;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+r+c&this._capacityMask,a=r-1;a>0;a--)this._list[s=s+1+c&this._capacityMask]=void 0;return n}if(s<o/2){for(this._head=this._head+e+r+c&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[s=s-1+c&this._capacityMask]);for(s=this._head-1+c&this._capacityMask;i>0;)this._list[s=s-1+c&this._capacityMask]=void 0,i--;e<0&&(this._tail=s)}else{for(this._tail=s,s=s+r+c&this._capacityMask,a=o-(r+e);a>0;a--)this.push(this._list[s++]);for(s=this._tail;i>0;)this._list[s=s+1+c&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),n}}};C.prototype.splice=function(e,r){var s=e;if(s===(s|0)){var n=this.size();if(s<0&&(s+=n),!(s>n))if(arguments.length>2){var i,o,c,a=arguments.length,u=this._list.length,l=2;if(!n||s<n/2){for(o=new Array(s),i=0;i<s;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(c=[],s>0&&(this._head=this._head+s+u&this._capacityMask)):(c=this.remove(s,r),this._head=this._head+s+u&this._capacityMask);a>l;)this.unshift(arguments[--a]);for(i=s;i>0;i--)this.unshift(o[i-1])}else{o=new Array(n-(s+r));var f=o.length;for(i=0;i<f;i++)o[i]=this._list[this._head+s+r+i&this._capacityMask];for(r===0?(c=[],s!=n&&(this._tail=this._head+s+u&this._capacityMask)):(c=this.remove(s,r),this._tail=this._tail-f+u&this._capacityMask);l<a;)this.push(arguments[l++]);for(i=0;i<f;i++)this.push(o[i])}return c}else return this.remove(s,r)}};C.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};C.prototype.isEmpty=function(){return this._head===this._tail};C.prototype.toArray=function(){return this._copyArray(!1)};C.prototype._fromArray=function(e){var r=e.length,s=this._nextPowerOf2(r);this._list=new Array(s),this._capacityMask=s-1,this._tail=r;for(var n=0;n<r;n++)this._list[n]=e[n]};C.prototype._copyArray=function(e,r){var s=this._list,n=s.length,i=this.length;if(r=r|i,r==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var o=new Array(r),c=0,a;if(e||this._head>this._tail){for(a=this._head;a<n;a++)o[c++]=s[a];for(a=0;a<this._tail;a++)o[c++]=s[a]}else for(a=this._head;a<this._tail;a++)o[c++]=s[a];return o};C.prototype._growArray=function(){if(this._head!=0){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};C.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};C.prototype._nextPowerOf2=function(e){var r=Math.log(e)/Math.log(2),s=1<<r+1;return Math.max(s,4)};la.exports=C});var da=d(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});var Mh=I(),Ph=zt(),Lh=(0,Mh.Debug)("delayqueue"),Gs=class{constructor(){this.queues={},this.timeouts={}}push(e,r,s){let n=s.callback||process.nextTick;this.queues[e]||(this.queues[e]=new Ph),this.queues[e].push(r),this.timeouts[e]||(this.timeouts[e]=setTimeout(()=>{n(()=>{this.timeouts[e]=null,this.execute(e)})},s.timeout))}execute(e){let r=this.queues[e];if(!r)return;let{length:s}=r;if(s)for(Lh("send %d commands in %s queue",s,e),this.queues[e]=null;r.length>0;)r.shift()()}};Hs.default=Gs});var ya=d(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});var Dh=I(),Bh=Bs(),jh=Us(),ha=Ye(),Kt=Ve(),pa=(0,Dh.Debug)("cluster:subscriberGroup"),Qs=class{constructor(e,r){this.cluster=e,this.shardedSubscribers=new Map,this.clusterSlots=[],this.subscriberToSlotsIndex=new Map,this.channels=new Map,e.on("+node",s=>{this._addSubscriber(s)}),e.on("-node",s=>{this._removeSubscriber(s)}),e.on("refresh",()=>{this._refreshSlots(e)}),e.on("forceRefresh",()=>{r()})}getResponsibleSubscriber(e){let r=this.clusterSlots[e][0];return this.shardedSubscribers.get(r)}addChannels(e){let r=Kt(e[0]);e.forEach(n=>{if(Kt(n)!=r)return-1});let s=this.channels.get(r);return s?this.channels.set(r,s.concat(e)):this.channels.set(r,e),[...this.channels.values()].flatMap(n=>n).length}removeChannels(e){let r=Kt(e[0]);e.forEach(n=>{if(Kt(n)!=r)return-1});let s=this.channels.get(r);if(s){let n=s.filter(i=>!e.includes(i));this.channels.set(r,n)}return[...this.channels.values()].flatMap(n=>n).length}stop(){for(let e of this.shardedSubscribers.values())e.stop()}start(){for(let e of this.shardedSubscribers.values())e.isStarted()||e.start()}_addSubscriber(e){let r=new jh.default(e.options);if(r.addMasterNode(e)){let s=new Bh.default(r,this.cluster,!0),n=(0,ha.getNodeKey)(e.options);return this.shardedSubscribers.set(n,s),s.start(),this._resubscribe(),this.cluster.emit("+subscriber"),s}return null}_removeSubscriber(e){let r=(0,ha.getNodeKey)(e.options),s=this.shardedSubscribers.get(r);return s&&(s.stop(),this.shardedSubscribers.delete(r),this._resubscribe(),this.cluster.emit("-subscriber")),this.shardedSubscribers}_refreshSlots(e){if(this._slotsAreEqual(e.slots))pa("Nothing to refresh because the new cluster map is equal to the previous one.");else{pa("Refreshing the slots of the subscriber group."),this.subscriberToSlotsIndex=new Map;for(let r=0;r<e.slots.length;r++){let s=e.slots[r][0];this.subscriberToSlotsIndex.has(s)||this.subscriberToSlotsIndex.set(s,[]),this.subscriberToSlotsIndex.get(s).push(Number(r))}return this._resubscribe(),this.clusterSlots=JSON.parse(JSON.stringify(e.slots)),this.cluster.emit("subscribersReady"),!0}return!1}_resubscribe(){this.shardedSubscribers&&this.shardedSubscribers.forEach((e,r)=>{let s=this.subscriberToSlotsIndex.get(r);s&&(e.associateSlotRange(s),s.forEach(n=>{let i=e.getInstance(),o=this.channels.get(n);o&&o.length>0&&i&&(i.ssubscribe(o),i.on("ready",()=>{i.ssubscribe(o)}))}))})}_slotsAreEqual(e){return this.clusterSlots===void 0?!1:JSON.stringify(this.clusterSlots)===JSON.stringify(e)}};Vs.default=Qs});var Ys=d(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});var ga=_e(),Ea=require("events"),Xe=be(),ma=oe(),xa=re(),zs=Ko(),Fh=fe(),$h=$t(),Uh=Ns(),U=I(),Gh=Ms(),Hh=Gt(),Qh=ca(),Vh=Bs(),zh=Us(),Kh=da(),Pe=Ye(),ba=zt(),Yh=ya(),_=(0,U.Debug)("cluster"),Sa=new WeakSet,Je=class t extends Hh.default{constructor(e,r={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new Kh.default,this.offlineQueue=new ba,this.isRefreshing=!1,this._refreshSlotsCacheCallbacks=[],this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,Ea.EventEmitter.call(this),this.startupNodes=e,this.options=(0,U.defaults)({},r,Qh.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.shardedSubscribers==!0&&(this.shardedSubscribers=new Yh.default(this,this.refreshSlotsCache.bind(this))),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new zh.default(this.options.redisOptions),this.connectionPool.on("-node",(s,n)=>{this.emit("-node",s)}),this.connectionPool.on("+node",s=>{this.emit("+node",s)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(s,n)=>{this.emit("node error",s,n)}),this.subscriber=new Vh.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([s,n])=>{this.defineCommand(s,n)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(s=>{_("connecting failed: %s",s)})}connect(){return new Promise((e,r)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){r(new Error("Redis is already connecting/connected"));return}let s=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(n=>{if(this.connectionEpoch!==s){_("discard connecting after resolving startup nodes because epoch not match: %d != %d",s,this.connectionEpoch),r(new Xe.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){_("discard connecting after resolving startup nodes because the status changed to %s",this.status),r(new Xe.RedisError("Connection is aborted"));return}this.connectionPool.reset(n);let i=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),e()},o,c=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",o),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((a,u)=>{a||u?(_("Ready check failed (%s). Reconnecting...",a||u),this.status==="connect"&&this.disconnect(!0)):i()}):i()};o=()=>{let a=new Error("None of startup nodes is available");this.removeListener("refresh",c),this.invokeReadyDelayedCallbacks(a),r(a)},this.once("refresh",c),this.once("close",o),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(a=>{a&&a.message===zs.default.defaultMessage&&(Fh.default.prototype.silentEmit.call(this,"error",a),this.connectionPool.reset([]))}),this.subscriber.start(),this.options.shardedSubscribers&&this.shardedSubscribers.start()}).catch(n=>{this.setStatus("close"),this.handleCloseEvent(n),this.invokeReadyDelayedCallbacks(n),r(n)})})}disconnect(e=!1){let r=this.status;this.setStatus("disconnecting"),e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,_("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(e){let r=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),this.options.shardedSubscribers&&this.shardedSubscribers.stop(),r==="wait"){let s=(0,ma.default)(Promise.resolve("OK"),e);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),s}return(0,ma.default)(Promise.all(this.nodes().map(s=>s.quit().catch(n=>{if(n.message===U.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw n}))).then(()=>"OK"),e)}duplicate(e=[],r={}){let s=e.length>0?e:this.startupNodes.slice(0),n=Object.assign({},this.options,r);return new t(s,n)}nodes(e="all"){if(e!=="all"&&e!=="master"&&e!=="slave")throw new Error('Invalid role "'+e+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(e)}delayUntilReady(e){this._readyDelayedCallbacks.push(e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}refreshSlotsCache(e){if(e&&this._refreshSlotsCacheCallbacks.push(e),this.isRefreshing)return;this.isRefreshing=!0;let r=this,s=c=>{this.isRefreshing=!1;for(let a of this._refreshSlotsCacheCallbacks)a(c);this._refreshSlotsCacheCallbacks=[]},n=(0,U.shuffle)(this.connectionPool.getNodes()),i=null;function o(c){if(c===n.length){let l=new zs.default(zs.default.defaultMessage,i);return s(l)}let a=n[c],u=`${a.options.host}:${a.options.port}`;_("getting slot cache from %s",u),r.getInfoFromNode(a,function(l){switch(r.status){case"close":case"end":return s(new Error("Cluster is disconnected."));case"disconnecting":return s(new Error("Cluster is disconnecting."))}l?(r.emit("node error",l,u),i=l,o(c+1)):(r.emit("refresh"),s())})}o(0)}sendCommand(e,r,s){if(this.status==="wait"&&this.connect().catch(U.noop),this.status==="end")return e.reject(new Error(U.CONNECTION_CLOSED_ERROR_MSG)),e.promise;let n=this.options.scaleReads;n!=="master"&&(e.isReadOnly||(0,ga.exists)(e.name)&&(0,ga.hasFlag)(e.name,"readonly")||(n="master"));let i=s?s.slot:e.getSlot(),o={},c=this;if(!s&&!Sa.has(e)){Sa.add(e);let u=e.reject;e.reject=function(l){let f=a.bind(null,!0);c.handleError(l,o,{moved:function(p,h){_("command %s is moved to %s",e.name,h),i=Number(p),c.slots[p]?c.slots[p][0]=h:c.slots[p]=[h],c._groupsBySlot[p]=c._groupsIds[c.slots[p].join(";")],c.connectionPool.findOrCreate(c.natMapper(h)),a(),_("refreshing slot caches... (triggered by MOVED error)"),c.refreshSlotsCache()},ask:function(p,h){_("command %s is required to ask %s:%s",e.name,h);let x=c.natMapper(h);c.connectionPool.findOrCreate(x),a(!1,`${x.host}:${x.port}`)},tryagain:f,clusterDown:f,connectionClosed:f,maxRedirections:function(p){u.call(e,p)},defaults:function(){u.call(e,l)}})}}a();function a(u,l){if(c.status==="end"){e.reject(new Xe.AbortError("Cluster is ended."));return}let f;if(c.status==="ready"||e.name==="cluster"){if(s&&s.redis)f=s.redis;else if(xa.default.checkFlag("ENTER_SUBSCRIBER_MODE",e.name)||xa.default.checkFlag("EXIT_SUBSCRIBER_MODE",e.name)){if(c.options.shardedSubscribers==!0&&(e.name=="ssubscribe"||e.name=="sunsubscribe")){let p=c.shardedSubscribers.getResponsibleSubscriber(i),h=-1;e.name=="ssubscribe"&&(h=c.shardedSubscribers.addChannels(e.getKeys())),e.name=="sunsubscribe"&&(h=c.shardedSubscribers.removeChannels(e.getKeys())),h!==-1?f=p.getInstance():e.reject(new Xe.AbortError("Can't add or remove the given channels. Are they in the same slot?"))}else f=c.subscriber.getInstance();if(!f){e.reject(new Xe.AbortError("No subscriber for the cluster"));return}}else{if(!u){if(typeof i=="number"&&c.slots[i]){let p=c.slots[i];if(typeof n=="function"){let h=p.map(function(x){return c.connectionPool.getInstanceByKey(x)});f=n(h,e),Array.isArray(f)&&(f=(0,U.sample)(f)),f||(f=h[0])}else{let h;n==="all"?h=(0,U.sample)(p):n==="slave"&&p.length>1?h=(0,U.sample)(p,1):h=p[0],f=c.connectionPool.getInstanceByKey(h)}}l&&(f=c.connectionPool.getInstanceByKey(l),f.asking())}f||(f=(typeof n=="function"?null:c.connectionPool.getSampleInstance(n))||c.connectionPool.getSampleInstance("all"))}s&&!s.redis&&(s.redis=f)}f?f.sendCommand(e,r):c.options.enableOfflineQueue?c.offlineQueue.push({command:e,stream:r,node:s}):e.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return e.promise}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}handleError(e,r,s){if(typeof r.value>"u"?r.value=this.options.maxRedirections:r.value-=1,r.value<=0){s.maxRedirections(new Error("Too many Cluster redirections. Last error: "+e));return}let n=e.message.split(" ");if(n[0]==="MOVED"){let i=this.options.retryDelayOnMoved;i&&typeof i=="number"?this.delayQueue.push("moved",s.moved.bind(null,n[1],n[2]),{timeout:i}):s.moved(n[1],n[2])}else n[0]==="ASK"?s.ask(n[1],n[2]):n[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",s.tryagain,{timeout:this.options.retryDelayOnTryAgain}):n[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",s.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):e.message===U.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",s.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):s.defaults()}resetOfflineQueue(){this.offlineQueue=new ba}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;let e=()=>{this.slotsTimer=setTimeout(()=>{_('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{e()})},this.options.slotsRefreshInterval)};e()}setStatus(e){_("status: %s -> %s",this.status||"[empty]",e),this.status=e,process.nextTick(()=>{this.emit(e)})}handleCloseEvent(e){e&&_("closed because %s",e);let r;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(r=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,e)),typeof r=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,_("Cluster is disconnected. Retrying after %dms",r),this.connect().catch(function(s){_("Got error %s when reconnecting. Ignoring...",s)})},r)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(e){let r;for(;r=this.offlineQueue.shift();)r.command.reject(e)}executeOfflineCommands(){if(this.offlineQueue.length){_("send %d commands in offline queue",this.offlineQueue.length);let e=this.offlineQueue;this.resetOfflineQueue();let r;for(;r=e.shift();)this.sendCommand(r.command,r.stream,r.node)}}natMapper(e){let r=typeof e=="string"?e:`${e.host}:${e.port}`,s=null;return this.options.natMap&&typeof this.options.natMap=="function"?s=this.options.natMap(r):this.options.natMap&&typeof this.options.natMap=="object"&&(s=this.options.natMap[r]),s?(_("NAT mapping %s -> %O",r,s),Object.assign({},s)):typeof e=="string"?(0,Pe.nodeKeyToRedisOptions)(e):e}getInfoFromNode(e,r){if(!e)return r(new Error("Node is disconnected"));let s=e.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,Pe.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});s.on("error",U.noop),s.cluster("SLOTS",(0,U.timeout)((n,i)=>{if(s.disconnect(),n)return _("error encountered running CLUSTER.SLOTS: %s",n),r(n);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){_("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",i.length,this.status),r();return}let o=[];_("cluster slots result count: %d",i.length);for(let a=0;a<i.length;++a){let u=i[a],l=u[0],f=u[1],p=[];for(let h=2;h<u.length;h++){if(!u[h][0])continue;let x=this.natMapper({host:u[h][0],port:u[h][1]});x.readOnly=h!==2,o.push(x),p.push(x.host+":"+x.port)}_("cluster slots result [%d]: slots %d~%d served by %s",a,l,f,p);for(let h=l;h<=f;h++)this.slots[h]=p}this._groupsIds=Object.create(null);let c=0;for(let a=0;a<16384;a++){let u=(this.slots[a]||[]).join(";");if(!u.length){this._groupsBySlot[a]=void 0;continue}this._groupsIds[u]||(this._groupsIds[u]=++c),this._groupsBySlot[a]=this._groupsIds[u]}this.connectionPool.reset(o),r()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(e){for(let r of this._readyDelayedCallbacks)process.nextTick(r,e);this._readyDelayedCallbacks=[]}readyCheck(e){this.cluster("INFO",(r,s)=>{if(r)return e(r);if(typeof s!="string")return e();let n,i=s.split(`\r
`);for(let o=0;o<i.length;++o){let c=i[o].split(":");if(c[0]==="cluster_state"){n=c[1];break}}n==="fail"?(_("cluster state not ok (%s)",n),e(null,n)):e()})}resolveSrv(e){return new Promise((r,s)=>{this.options.resolveSrv(e,(n,i)=>{if(n)return s(n);let o=this,c=(0,Pe.groupSrvRecords)(i),a=Object.keys(c).sort((l,f)=>parseInt(l)-parseInt(f));function u(l){if(!a.length)return s(l);let f=a[0],p=c[f],h=(0,Pe.weightSrvRecords)(p);p.records.length||a.shift(),o.dnsLookup(h.name).then(x=>r({host:x,port:h.port}),u)}u()})})}dnsLookup(e){return new Promise((r,s)=>{this.options.dnsLookup(e,(n,i)=>{n?(_("failed to resolve hostname %s to IP: %s",e,n.message),s(n)):(_("resolved hostname %s to IP %s",e,i),r(i))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");let e=(0,Pe.normalizeNodeOptions)(this.startupNodes),r=(0,Pe.getUniqueHostnamesFromOptions)(e);if(r.length===0)return e;let s=await Promise.all(r.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),n=(0,U.zipMap)(r,s);return e.map(i=>{let o=n.get(i.host);return o?this.options.useSRVRecords?Object.assign({},i,o):Object.assign({},i,{host:o}):i})}createScanStream(e,{key:r,options:s={}}){return new $h.default({objectMode:!0,key:r,redis:this,command:e,...s})}};(0,Gh.default)(Je,Ea.EventEmitter);(0,Uh.addTransactionSupport)(Je.prototype);Ks.default=Je});var Yt=d(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});var Wh=I(),Xh=(0,Wh.Debug)("AbstractConnector"),Ws=class{constructor(e){this.connecting=!1,this.disconnectTimeout=e}check(e){return!0}disconnect(){if(this.connecting=!1,this.stream){let e=this.stream,r=setTimeout(()=>{Xh("stream %s:%s still open, destroying it",e.remoteAddress,e.remotePort),e.destroy()},this.disconnectTimeout);e.on("close",()=>clearTimeout(r)),e.end()}}};Xs.default=Ws});var wa=d(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});var Jh=require("net"),Zh=require("tls"),ep=I(),tp=Yt(),Js=class extends tp.default{constructor(e){super(e.disconnectTimeout),this.options=e}connect(e){let{options:r}=this;this.connecting=!0;let s;return"path"in r&&r.path?s={path:r.path}:(s={},"port"in r&&r.port!=null&&(s.port=r.port),"host"in r&&r.host!=null&&(s.host=r.host),"family"in r&&r.family!=null&&(s.family=r.family)),r.tls&&Object.assign(s,r.tls),new Promise((n,i)=>{process.nextTick(()=>{if(!this.connecting){i(new Error(ep.CONNECTION_CLOSED_ERROR_MSG));return}try{r.tls?this.stream=(0,Zh.connect)(s):this.stream=(0,Jh.createConnection)(s)}catch(o){i(o);return}this.stream.once("error",o=>{this.firstError=o}),n(this.stream)})})}};Zs.default=Js});var ka=d(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});function rp(t,e){return(t.host||"127.0.0.1")===(e.host||"127.0.0.1")&&(t.port||26379)===(e.port||26379)}var en=class{constructor(e){this.cursor=0,this.sentinels=e.slice(0)}next(){let e=this.cursor>=this.sentinels.length;return{done:e,value:e?void 0:this.sentinels[this.cursor++]}}reset(e){e&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(e){for(let r=0;r<this.sentinels.length;r++)if(rp(e,this.sentinels[r]))return!1;return this.sentinels.push(e),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}};tn.default=en});var Aa=d(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.FailoverDetector=void 0;var sp=I(),rn=(0,sp.Debug)("FailoverDetector"),va="+switch-master",sn=class{constructor(e,r){this.isDisconnected=!1,this.connector=e,this.sentinels=r}cleanup(){this.isDisconnected=!0;for(let e of this.sentinels)e.client.disconnect()}async subscribe(){rn("Starting FailoverDetector");let e=[];for(let r of this.sentinels){let s=r.client.subscribe(va).catch(n=>{rn("Failed to subscribe to failover messages on sentinel %s:%s (%s)",r.address.host||"127.0.0.1",r.address.port||26739,n.message)});e.push(s),r.client.on("message",n=>{!this.isDisconnected&&n===va&&this.disconnect()})}await Promise.all(e)}disconnect(){this.isDisconnected=!0,rn("Failover detected, disconnecting"),this.connector.disconnect()}};Wt.FailoverDetector=sn});var Xt=d(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.SentinelIterator=void 0;var np=require("net"),Ze=I(),ip=require("tls"),Ca=ka();et.SentinelIterator=Ca.default;var op=Yt(),ap=fe(),cp=Aa(),Le=(0,Ze.Debug)("SentinelConnector"),nn=class extends op.default{constructor(e){if(super(e.disconnectTimeout),this.options=e,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new Ca.default(this.options.sentinels)}check(e){let r=!e.role||this.options.role===e.role;return r||(Le("role invalid, expected %s, but got %s",this.options.role,e.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),r}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(e){this.connecting=!0,this.retryAttempts=0;let r,s=async()=>{let n=this.sentinelIterator.next();if(n.done){this.sentinelIterator.reset(!1);let a=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null,u=typeof a!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${a}ms.`;r&&(u+=` Last error: ${r.message}`),Le(u);let l=new Error(u);if(typeof a=="number")return e("error",l),await new Promise(f=>setTimeout(f,a)),s();throw l}let i=null,o=null;try{i=await this.resolve(n.value)}catch(a){o=a}if(!this.connecting)throw new Error(Ze.CONNECTION_CLOSED_ERROR_MSG);let c=n.value.host+":"+n.value.port;if(i)return Le("resolved: %s:%s from sentinel %s",i.host,i.port,c),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(i,this.options.tls),this.stream=(0,ip.connect)(i),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,np.createConnection)(i),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",a=>{this.firstError=a}),this.stream;{let a=o?"failed to connect to sentinel "+c+" because "+o.message:"connected to sentinel "+c+" successfully, but got an invalid reply: "+i;return Le(a),e("sentinelError",new Error(a)),o&&(r=o),s()}};return s()}async updateSentinels(e){if(!this.options.updateSentinels)return;let r=await e.sentinel("sentinels",this.options.name);Array.isArray(r)&&(r.map(Ze.packObject).forEach(s=>{if((s.flags?s.flags.split(","):[]).indexOf("disconnected")===-1&&s.ip&&s.port){let i=this.sentinelNatResolve(_a(s));this.sentinelIterator.add(i)&&Le("adding sentinel %s:%s",i.host,i.port)}}),Le("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(e){let r=await e.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(e),this.sentinelNatResolve(Array.isArray(r)?{host:r[0],port:Number(r[1])}:null)}async resolveSlave(e){let r=await e.sentinel("slaves",this.options.name);if(!Array.isArray(r))return null;let s=r.map(Ze.packObject).filter(n=>n.flags&&!n.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(up(s,this.options.preferredSlaves))}sentinelNatResolve(e){if(!e||!this.options.natMap)return e;let r=`${e.host}:${e.port}`,s=e;return typeof this.options.natMap=="function"?s=this.options.natMap(r)||e:typeof this.options.natMap=="object"&&(s=this.options.natMap[r]||e),s}connectToSentinel(e,r){return new ap.default({port:e.port||26379,host:e.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:e.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...r})}async resolve(e){let r=this.connectToSentinel(e);r.on("error",fp);try{return this.options.role==="slave"?await this.resolveSlave(r):await this.resolveMaster(r)}finally{r.disconnect()}}async initFailoverDetector(){var e;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);let r=[];for(;r.length<this.options.sentinelMaxConnections;){let{done:s,value:n}=this.sentinelIterator.next();if(s)break;let i=this.connectToSentinel(n,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});i.on("reconnecting",()=>{var o;(o=this.emitter)===null||o===void 0||o.emit("sentinelReconnecting")}),r.push({address:n,client:i})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new cp.FailoverDetector(this,r),await this.failoverDetector.subscribe(),(e=this.emitter)===null||e===void 0||e.emit("failoverSubscribed")}};et.default=nn;function up(t,e){if(t.length===0)return null;let r;if(typeof e=="function")r=e(t);else if(e!==null&&typeof e=="object"){let s=Array.isArray(e)?e:[e];s.sort((n,i)=>(n.prio||(n.prio=1),i.prio||(i.prio=1),n.prio<i.prio?-1:n.prio>i.prio?1:0));for(let n=0;n<s.length;n++){for(let i=0;i<t.length;i++){let o=t[i];if(o.ip===s[n].ip&&o.port===s[n].port){r=o;break}}if(r)break}}return r||(r=(0,Ze.sample)(t)),_a(r)}function _a(t){return{host:t.ip,port:Number(t.port)}}function fp(){}});var Oa=d(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.SentinelConnector=De.StandaloneConnector=void 0;var lp=wa();De.StandaloneConnector=lp.default;var dp=Xt();De.SentinelConnector=dp.default});var Ra=d(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});var hp=be(),on=class extends hp.AbortError{constructor(e){let r=`Reached the max retries per request limit (which is ${e}). Refer to "maxRetriesPerRequest" option for details.`;super(r),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}};an.default=on});var Ta=d(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.MaxRetriesPerRequestError=void 0;var pp=Ra();Jt.MaxRetriesPerRequestError=pp.default});var Da=d((wE,La)=>{"use strict";var hn=require("buffer").Buffer,yp=require("string_decoder").StringDecoder,cn=new yp,Ia=be(),gp=Ia.ReplyError,mp=Ia.ParserError,K=hn.allocUnsafe(32*1024),L=0,Zt=null,tt=0,un=0;function xp(t){let e=t.buffer.length-1;var r=t.offset,s=0,n=1;for(t.buffer[r]===45&&(n=-1,r++);r<e;){let i=t.buffer[r++];if(i===13)return t.offset=r+1,n*s;s=s*10+(i-48)}}function bp(t){let e=t.buffer.length-1;var r=t.offset,s=0,n="";for(t.buffer[r]===45&&(n+="-",r++);r<e;){var i=t.buffer[r++];if(i===13)return t.offset=r+1,s!==0&&(n+=s),n;s>429496728?(n+=s*10+(i-48),s=0):i===48&&s===0?n+=0:s=s*10+(i-48)}}function Na(t){let e=t.offset,r=t.buffer,s=r.length-1;for(var n=e;n<s;)if(r[n++]===13)return t.offset=n+1,t.optionReturnBuffers===!0?t.buffer.slice(e,n-1):t.buffer.toString("utf8",e,n-1)}function qa(t){let e=t.buffer.length-1;for(var r=t.offset,s=0;r<e;){let n=t.buffer[r++];if(n===13)return t.offset=r+1,s;s=s*10+(n-48)}}function Sp(t){return t.optionStringNumbers===!0?bp(t):xp(t)}function Ep(t){let e=qa(t);if(e===void 0)return;if(e<0)return null;let r=t.offset+e;if(r+2>t.buffer.length){t.bigStrSize=r+2,t.totalChunkSize=t.buffer.length,t.bufferCache.push(t.buffer);return}let s=t.offset;return t.offset=r+2,t.optionReturnBuffers===!0?t.buffer.slice(s,r):t.buffer.toString("utf8",s,r)}function wp(t){var e=Na(t);if(e!==void 0)return t.optionReturnBuffers===!0&&(e=e.toString()),new gp(e)}function kp(t,e){let r=new mp("Protocol error, got "+JSON.stringify(String.fromCharCode(e))+" as reply type byte",JSON.stringify(t.buffer),t.offset);t.buffer=null,t.returnFatalError(r)}function vp(t){let e=qa(t);if(e===void 0)return;if(e<0)return null;let r=new Array(e);return Ma(t,r,0)}function fn(t,e,r){t.arrayCache.push(e),t.arrayPos.push(r)}function ln(t){let e=t.arrayCache.pop();var r=t.arrayPos.pop();if(t.arrayCache.length){let s=ln(t);if(s===void 0){fn(t,e,r);return}e[r++]=s}return Ma(t,e,r)}function Ma(t,e,r){let s=t.buffer.length;for(;r<e.length;){let n=t.offset;if(t.offset>=s){fn(t,e,r);return}let i=Pa(t,t.buffer[t.offset++]);if(i===void 0){t.arrayCache.length||t.bufferCache.length||(t.offset=n),fn(t,e,r);return}e[r]=i,r++}return e}function Pa(t,e){switch(e){case 36:return Ep(t);case 43:return Na(t);case 42:return vp(t);case 58:return Sp(t);case 45:return wp(t);default:return kp(t,e)}}function Ap(){if(K.length>50*1024)if(tt===1||un>tt*2){let t=Math.floor(K.length/10),e=t<L?L:t;L=0,K=K.slice(e,K.length)}else un++,tt--;else clearInterval(Zt),tt=0,un=0,Zt=null}function Cp(t){if(K.length<t+L){let e=t>78643200?2:3;L>1024*1024*111&&(L=1024*1024*50),K=hn.allocUnsafe(t*e+L),L=0,tt++,Zt===null&&(Zt=setInterval(Ap,50))}}function _p(t){let e=t.bufferCache,r=t.offset;var s=e.length,n=t.bigStrSize-t.totalChunkSize;if(t.offset=n,n<=2){if(s===2)return e[0].toString("utf8",r,e[0].length+n-2);s--,n=e[e.length-2].length+n}for(var i=cn.write(e[0].slice(r)),o=1;o<s-1;o++)i+=cn.write(e[o]);return i+=cn.end(e[o].slice(0,n-2)),i}function Op(t){let e=t.bufferCache,r=t.offset,s=t.bigStrSize-r-2;var n=e.length,i=t.bigStrSize-t.totalChunkSize;if(t.offset=i,i<=2){if(n===2)return e[0].slice(r,e[0].length+i-2);n--,i=e[e.length-2].length+i}Cp(s);let o=L;e[0].copy(K,o,r,e[0].length),L+=e[0].length-r;for(var c=1;c<n-1;c++)e[c].copy(K,L),L+=e[c].length;return e[c].copy(K,L,0,i-2),L+=i-2,K.slice(o,L)}var dn=class{constructor(e){if(!e)throw new TypeError("Options are mandatory.");if(typeof e.returnError!="function"||typeof e.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!e.returnBuffers),this.setStringNumbers(!!e.stringNumbers),this.returnError=e.returnError,this.returnFatalError=e.returnFatalError||e.returnError,this.returnReply=e.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(e){if(typeof e!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=e}setStringNumbers(e){if(typeof e!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=e}execute(e){if(this.buffer===null)this.buffer=e,this.offset=0;else if(this.bigStrSize===0){let s=this.buffer.length,n=s-this.offset,i=hn.allocUnsafe(n+e.length);if(this.buffer.copy(i,0,this.offset,s),e.copy(i,n,0,e.length),this.buffer=i,this.offset=0,this.arrayCache.length){let o=ln(this);if(o===void 0)return;this.returnReply(o)}}else if(this.totalChunkSize+e.length>=this.bigStrSize){this.bufferCache.push(e);var r=this.optionReturnBuffers?Op(this):_p(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=e,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=r,r=ln(this),r===void 0))return;this.returnReply(r)}else{this.bufferCache.push(e),this.totalChunkSize+=e.length;return}for(;this.offset<this.buffer.length;){let s=this.offset,n=this.buffer[this.offset++],i=Pa(this,n);if(i===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=s);return}n===45?this.returnError(i):this.returnReply(i)}this.buffer=null}};La.exports=dn});var ja=d((kE,Ba)=>{"use strict";Ba.exports=Da()});var Fa=d(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});var yn=class{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(e,r){this.set[pn(e)][r]=!0}del(e,r){delete this.set[pn(e)][r]}channels(e){return Object.keys(this.set[pn(e)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}};gn.default=yn;function pn(t){return t==="unsubscribe"?"subscribe":t==="punsubscribe"?"psubscribe":t==="sunsubscribe"?"ssubscribe":t}});var Ha=d(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});var $a=re(),Rp=I(),Tp=ja(),Ip=Fa(),Np=(0,Rp.Debug)("dataHandler"),mn=class{constructor(e,r){this.redis=e;let s=new Tp({stringNumbers:r.stringNumbers,returnBuffers:!0,returnError:n=>{this.returnError(n)},returnFatalError:n=>{this.returnFatalError(n)},returnReply:n=>{this.returnReply(n)}});e.stream.prependListener("data",n=>{s.execute(n)}),e.stream.resume()}returnFatalError(e){e.message+=". Please report this.",this.redis.recoverFromFatalError(e,e,{offlineQueue:!1})}returnError(e){let r=this.shiftCommand(e);if(r){if(e.command={name:r.command.name,args:r.command.args},r.command.name=="ssubscribe"&&e.message.includes("MOVED")){this.redis.emit("moved");return}this.redis.handleReconnection(e,r)}}returnReply(e){if(this.handleMonitorReply(e)||this.handleSubscriberReply(e))return;let r=this.shiftCommand(e);r&&($a.default.checkFlag("ENTER_SUBSCRIBER_MODE",r.command.name)?(this.redis.condition.subscriber=new Ip.default,this.redis.condition.subscriber.add(r.command.name,e[1].toString()),Ua(r.command,e[2])||this.redis.commandQueue.unshift(r)):$a.default.checkFlag("EXIT_SUBSCRIBER_MODE",r.command.name)?Ga(r.command,e[2])||this.redis.commandQueue.unshift(r):r.command.resolve(e))}handleSubscriberReply(e){if(!this.redis.condition.subscriber)return!1;let r=Array.isArray(e)?e[0].toString():null;switch(Np('receive reply "%s" in subscriber mode',r),r){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("messageBuffer",e[1],e[2]);break;case"pmessage":{let s=e[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",s,e[2].toString(),e[3].toString()),this.redis.emit("pmessageBuffer",s,e[2],e[3]);break}case"smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",e[1].toString(),e[2]?e[2].toString():""),this.redis.emit("smessageBuffer",e[1],e[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{let s=e[1].toString();this.redis.condition.subscriber.add(r,s);let n=this.shiftCommand(e);if(!n)return;Ua(n.command,e[2])||this.redis.commandQueue.unshift(n);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{let s=e[1]?e[1].toString():null;s&&this.redis.condition.subscriber.del(r,s);let n=e[2];Number(n)===0&&(this.redis.condition.subscriber=!1);let i=this.shiftCommand(e);if(!i)return;Ga(i.command,n)||this.redis.commandQueue.unshift(i);break}default:{let s=this.shiftCommand(e);if(!s)return;s.command.resolve(e)}}return!0}handleMonitorReply(e){if(this.redis.status!=="monitoring")return!1;let r=e.toString();if(r==="OK")return!1;let s=r.indexOf(" "),n=r.slice(0,s),i=r.indexOf('"'),o=r.slice(i+1,-1).split('" "').map(a=>a.replace(/\\"/g,'"')),c=r.slice(s+2,i-2).split(" ");return this.redis.emit("monitor",n,o,c[1],c[0]),!0}shiftCommand(e){let r=this.redis.commandQueue.shift();if(!r){let s="Command queue state error. If you can reproduce this, please report it.",n=new Error(s+(e instanceof Error?` Last error: ${e.message}`:` Last reply: ${e.toString()}`));return this.redis.emit("error",n),null}return r}};xn.default=mn;var le=new WeakMap;function Ua(t,e){let r=le.has(t)?le.get(t):t.args.length;return r-=1,r<=0?(t.resolve(e),le.delete(t),!0):(le.set(t,r),!1)}function Ga(t,e){let r=le.has(t)?le.get(t):t.args.length;return r===0?Number(e)===0?(le.delete(t),t.resolve(e),!0):!1:(r-=1,r<=0?(t.resolve(e),!0):(le.set(t,r),!1))}});var Qa=d(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.readyHandler=H.errorHandler=H.closeHandler=H.connectHandler=void 0;var qp=be(),Mp=re(),Pp=Ta(),J=I(),Lp=Ha(),N=(0,J.Debug)("connection");function Dp(t){return function(){var e;t.setStatus("connect"),t.resetCommandQueue();let r=!1,{connectionEpoch:s}=t;t.condition.auth&&t.auth(t.condition.auth,function(i){s===t.connectionEpoch&&i&&(i.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):i.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):i.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(r=!0,t.recoverFromFatalError(i,i)))}),t.condition.select&&t.select(t.condition.select).catch(i=>{t.silentEmit("error",i)}),new Lp.default(t,{stringNumbers:t.options.stringNumbers});let n=[];t.options.connectionName&&(N("set the connection name [%s]",t.options.connectionName),n.push(t.client("setname",t.options.connectionName).catch(J.noop))),t.options.disableClientInfo||(N("set the client info"),n.push((0,J.getPackageMeta)().then(i=>t.client("SETINFO","LIB-VER",i.version).catch(J.noop)).catch(J.noop)),n.push(t.client("SETINFO","LIB-NAME",!((e=t.options)===null||e===void 0)&&e.clientInfoTag?`ioredis(${t.options.clientInfoTag})`:"ioredis").catch(J.noop))),Promise.all(n).catch(J.noop).finally(()=>{t.options.enableReadyCheck||H.readyHandler(t)(),t.options.enableReadyCheck&&t._readyCheck(function(i,o){s===t.connectionEpoch&&(i?r||t.recoverFromFatalError(new Error("Ready check failed: "+i.message),i):t.connector.check(o)?H.readyHandler(t)():t.disconnect(!0))})})}}H.connectHandler=Dp;function bn(t){let e=new qp.AbortError("Command aborted due to connection close");return e.command={name:t.name,args:t.args},e}function Bp(t){var e;let r=0;for(let s=0;s<t.length;){let n=(e=t.peekAt(s))===null||e===void 0?void 0:e.command,i=n.pipelineIndex;if((i===void 0||i===0)&&(r=0),i!==void 0&&i!==r++){t.remove(s,1),n.reject(bn(n));continue}s++}}function jp(t){var e;for(let r=0;r<t.length;){let s=(e=t.peekAt(r))===null||e===void 0?void 0:e.command;if(s.name==="multi")break;if(s.name==="exec"){t.remove(r,1),s.reject(bn(s));break}s.inTransaction?(t.remove(r,1),s.reject(bn(s))):r++}}function Fp(t){return function(){let r=t.status;if(t.setStatus("close"),t.commandQueue.length&&Bp(t.commandQueue),t.offlineQueue.length&&jp(t.offlineQueue),r==="ready"&&(t.prevCondition||(t.prevCondition=t.condition),t.commandQueue.length&&(t.prevCommandQueue=t.commandQueue)),t.manuallyClosing)return t.manuallyClosing=!1,N("skip reconnecting since the connection is manually closed."),e();if(typeof t.options.retryStrategy!="function")return N("skip reconnecting because `retryStrategy` is not a function"),e();let s=t.options.retryStrategy(++t.retryAttempts);if(typeof s!="number")return N("skip reconnecting because `retryStrategy` doesn't return a number"),e();N("reconnect in %sms",s),t.setStatus("reconnecting",s),t.reconnectTimeout=setTimeout(function(){t.reconnectTimeout=null,t.connect().catch(J.noop)},s);let{maxRetriesPerRequest:n}=t.options;typeof n=="number"&&(n<0?N("maxRetriesPerRequest is negative, ignoring..."):t.retryAttempts%(n+1)===0&&(N("reach maxRetriesPerRequest limitation, flushing command queue..."),t.flushQueue(new Pp.MaxRetriesPerRequestError(n))))};function e(){t.setStatus("end"),t.flushQueue(new Error(J.CONNECTION_CLOSED_ERROR_MSG))}}H.closeHandler=Fp;function $p(t){return function(e){N("error: %s",e),t.silentEmit("error",e)}}H.errorHandler=$p;function Up(t){return function(){if(t.setStatus("ready"),t.retryAttempts=0,t.options.monitor){t.call("monitor").then(()=>t.setStatus("monitoring"),s=>t.emit("error",s));let{sendCommand:r}=t;t.sendCommand=function(s){return Mp.default.checkFlag("VALID_IN_MONITOR_MODE",s.name)?r.call(t,s):(s.reject(new Error("Connection is in monitoring mode, can't process commands.")),s.promise)},t.once("close",function(){delete t.sendCommand});return}let e=t.prevCondition?t.prevCondition.select:t.condition.select;if(t.options.readOnly&&(N("set the connection to readonly mode"),t.readonly().catch(J.noop)),t.prevCondition){let r=t.prevCondition;if(t.prevCondition=null,r.subscriber&&t.options.autoResubscribe){t.condition.select!==e&&(N("connect to db [%d]",e),t.select(e));let s=r.subscriber.channels("subscribe");s.length&&(N("subscribe %d channels",s.length),t.subscribe(s));let n=r.subscriber.channels("psubscribe");n.length&&(N("psubscribe %d channels",n.length),t.psubscribe(n));let i=r.subscriber.channels("ssubscribe");if(i.length){N("ssubscribe %s",i.length);for(let o of i)t.ssubscribe(o)}}}if(t.prevCommandQueue)if(t.options.autoResendUnfulfilledCommands)for(N("resend %d unfulfilled commands",t.prevCommandQueue.length);t.prevCommandQueue.length>0;){let r=t.prevCommandQueue.shift();r.select!==t.condition.select&&r.command.name!=="select"&&t.select(r.select),t.sendCommand(r.command,r.stream)}else t.prevCommandQueue=null;if(t.offlineQueue.length){N("send %d commands in offline queue",t.offlineQueue.length);let r=t.offlineQueue;for(t.resetOfflineQueue();r.length>0;){let s=r.shift();s.select!==t.condition.select&&s.command.name!=="select"&&t.select(s.select),t.sendCommand(s.command,s.stream)}}t.condition.select!==e&&(N("connect to db [%d]",e),t.select(e))}}H.readyHandler=Up});var Va=d(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.DEFAULT_REDIS_OPTIONS=void 0;er.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:0,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(t){return Math.min(t*50,2e3)},keepAlive:0,noDelay:!0,connectionName:null,disableClientInfo:!1,clientInfoTag:void 0,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(t){return Math.min(t*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10}});var fe=d(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});var za=_e(),Ya=require("events"),Sn=oe(),Gp=Ys(),rt=re(),Hp=Oa(),Qp=Xt(),de=Qa(),Vp=Va(),zp=$t(),Kp=Ns(),we=I(),Yp=Ms(),Wp=Gt(),he=Mt(),Ka=zt(),pe=(0,we.Debug)("redis"),ye=class t extends Wp.default{constructor(e,r,s){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(e,r,s),Ya.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){let n=new Qp.default(this.options);n.emitter=this,this.connector=n}else this.connector=new Hp.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([n,i])=>{this.defineCommand(n,i)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(he.noop)}static createClient(...e){return new t(...e)}get autoPipelineQueueSize(){let e=0;for(let r of this._autoPipelines.values())e+=r.length;return e}connect(e){let r=new Promise((s,n)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){n(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");let{options:i}=this;this.condition={select:i.db,auth:i.username?[i.username,i.password]:i.password,subscriber:!1};let o=this;(0,Sn.default)(this.connector.connect(function(c,a){o.silentEmit(c,a)}),function(c,a){if(c){o.flushQueue(c),o.silentEmit("error",c),n(c),o.setStatus("end");return}let u=i.tls?"secureConnect":"connect";if("sentinels"in i&&i.sentinels&&!i.enableTLSForSentinelMode&&(u="connect"),o.stream=a,i.noDelay&&a.setNoDelay(!0),typeof i.keepAlive=="number"&&(a.connecting?a.once(u,()=>{a.setKeepAlive(!0,i.keepAlive)}):a.setKeepAlive(!0,i.keepAlive)),a.connecting){if(a.once(u,de.connectHandler(o)),i.connectTimeout){let p=!1;a.setTimeout(i.connectTimeout,function(){if(p)return;a.setTimeout(0),a.destroy();let h=new Error("connect ETIMEDOUT");h.errorno="ETIMEDOUT",h.code="ETIMEDOUT",h.syscall="connect",de.errorHandler(o)(h)}),a.once(u,function(){p=!0,a.setTimeout(0)})}}else if(a.destroyed){let p=o.connector.firstError;p&&process.nextTick(()=>{de.errorHandler(o)(p)}),process.nextTick(de.closeHandler(o))}else process.nextTick(de.connectHandler(o));a.destroyed||(a.once("error",de.errorHandler(o)),a.once("close",de.closeHandler(o)));let l=function(){o.removeListener("close",f),s()};var f=function(){o.removeListener("ready",l),n(new Error(we.CONNECTION_CLOSED_ERROR_MSG))};o.once("ready",l),o.once("close",f)})});return(0,Sn.default)(r,e)}disconnect(e=!1){e||(this.manuallyClosing=!0),this.reconnectTimeout&&!e&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?de.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(e){return new t({...this.options,...e})}get mode(){var e;return this.options.monitor?"monitor":!((e=this.condition)===null||e===void 0)&&e.subscriber?"subscriber":"normal"}monitor(e){let r=this.duplicate({monitor:!0,lazyConnect:!1});return(0,Sn.default)(new Promise(function(s,n){r.once("error",n),r.once("monitoring",function(){s(r)})}),e)}sendCommand(e,r){var s,n;if(this.status==="wait"&&this.connect().catch(he.noop),this.status==="end")return e.reject(new Error(we.CONNECTION_CLOSED_ERROR_MSG)),e.promise;if(!((s=this.condition)===null||s===void 0)&&s.subscriber&&!rt.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",e.name))return e.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),e.promise;typeof this.options.commandTimeout=="number"&&e.setTimeout(this.options.commandTimeout);let i=this.status==="ready"||!r&&this.status==="connect"&&(0,za.exists)(e.name)&&((0,za.hasFlag)(e.name,"loading")||rt.default.checkFlag("HANDSHAKE_COMMANDS",e.name));if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(i=!1):i=!1,i)pe.enabled&&pe("write command[%s]: %d -> %s(%o)",this._getDescription(),(n=this.condition)===null||n===void 0?void 0:n.select,e.name,e.args),r?"isPipeline"in r&&r.isPipeline?r.write(e.toWritable(r.destination.redis.stream)):r.write(e.toWritable(r)):this.stream.write(e.toWritable(this.stream)),this.commandQueue.push({command:e,stream:r,select:this.condition.select}),rt.default.checkFlag("WILL_DISCONNECT",e.name)&&(this.manuallyClosing=!0),this.options.socketTimeout!==void 0&&this.socketTimeoutTimer===void 0&&this.setSocketTimeout();else{if(!this.options.enableOfflineQueue)return e.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),e.promise;if(e.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),e.resolve(Buffer.from("OK")),e.promise;pe.enabled&&pe("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,e.name,e.args),this.offlineQueue.push({command:e,stream:r,select:this.condition.select})}if(e.name==="select"&&(0,we.isInt)(e.args[0])){let o=parseInt(e.args[0],10);this.condition.select!==o&&(this.condition.select=o,this.emit("select",o),pe("switch to db [%d]",this.condition.select))}return e.promise}setSocketTimeout(){this.socketTimeoutTimer=setTimeout(()=>{this.stream.destroy(new Error(`Socket timeout. Expecting data, but didn't receive any in ${this.options.socketTimeout}ms.`)),this.socketTimeoutTimer=void 0},this.options.socketTimeout),this.stream.once("data",()=>{clearTimeout(this.socketTimeoutTimer),this.socketTimeoutTimer=void 0,this.commandQueue.length!==0&&this.setSocketTimeout()})}scanStream(e){return this.createScanStream("scan",{options:e})}scanBufferStream(e){return this.createScanStream("scanBuffer",{options:e})}sscanStream(e,r){return this.createScanStream("sscan",{key:e,options:r})}sscanBufferStream(e,r){return this.createScanStream("sscanBuffer",{key:e,options:r})}hscanStream(e,r){return this.createScanStream("hscan",{key:e,options:r})}hscanBufferStream(e,r){return this.createScanStream("hscanBuffer",{key:e,options:r})}zscanStream(e,r){return this.createScanStream("zscan",{key:e,options:r})}zscanBufferStream(e,r){return this.createScanStream("zscanBuffer",{key:e,options:r})}silentEmit(e,r){let s;if(!(e==="error"&&(s=r,this.status==="end"||this.manuallyClosing&&s instanceof Error&&(s.message===we.CONNECTION_CLOSED_ERROR_MSG||s.syscall==="connect"||s.syscall==="read"))))return this.listeners(e).length>0?this.emit.apply(this,arguments):(s&&s instanceof Error&&console.error("[ioredis] Unhandled error event:",s.stack),!1)}recoverFromFatalError(e,r,s){this.flushQueue(r,s),this.silentEmit("error",r),this.disconnect(!0)}handleReconnection(e,r){var s;let n=!1;switch(this.options.reconnectOnError&&!rt.default.checkFlag("IGNORE_RECONNECT_ON_ERROR",r.command.name)&&(n=this.options.reconnectOnError(e)),n){case 1:case!0:this.status!=="reconnecting"&&this.disconnect(!0),r.command.reject(e);break;case 2:this.status!=="reconnecting"&&this.disconnect(!0),((s=this.condition)===null||s===void 0?void 0:s.select)!==r.select&&r.command.name!=="select"&&this.select(r.select),this.sendCommand(r.command);break;default:r.command.reject(e)}}_getDescription(){let e;return"path"in this.options&&this.options.path?e=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?e=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?e=this.options.host+":"+this.options.port:e="",this.options.connectionName&&(e+=` (${this.options.connectionName})`),e}resetCommandQueue(){this.commandQueue=new Ka}resetOfflineQueue(){this.offlineQueue=new Ka}parseOptions(...e){let r={},s=!1;for(let n=0;n<e.length;++n){let i=e[n];if(!(i===null||typeof i>"u"))if(typeof i=="object")(0,he.defaults)(r,i);else if(typeof i=="string")(0,he.defaults)(r,(0,we.parseURL)(i)),i.startsWith("rediss://")&&(s=!0);else if(typeof i=="number")r.port=i;else throw new Error("Invalid argument "+i)}s&&(0,he.defaults)(r,{tls:!0}),(0,he.defaults)(r,t.defaultOptions),typeof r.port=="string"&&(r.port=parseInt(r.port,10)),typeof r.db=="string"&&(r.db=parseInt(r.db,10)),this.options=(0,we.resolveTLSProfile)(r)}setStatus(e,r){pe.enabled&&pe("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",e),this.status=e,process.nextTick(this.emit.bind(this,e,r))}createScanStream(e,{key:r,options:s={}}){return new zp.default({objectMode:!0,key:r,redis:this,command:e,...s})}flushQueue(e,r){r=(0,he.defaults)({},r,{offlineQueue:!0,commandQueue:!0});let s;if(r.offlineQueue)for(;s=this.offlineQueue.shift();)s.command.reject(e);if(r.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");s=this.commandQueue.shift();)s.command.reject(e)}_readyCheck(e){let r=this;this.info(function(s,n){if(s)return s.message&&s.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${s.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),e(null,{})):e(s);if(typeof n!="string")return e(null,n);let i={},o=n.split(`\r
`);for(let c=0;c<o.length;++c){let[a,...u]=o[c].split(":"),l=u.join(":");l&&(i[a]=l)}if(!i.loading||i.loading==="0")e(null,i);else{let c=(i.loading_eta_seconds||1)*1e3,a=r.options.maxLoadingRetryTime&&r.options.maxLoadingRetryTime<c?r.options.maxLoadingRetryTime:c;pe("Redis server still loading, trying again in "+a+"ms"),setTimeout(function(){r._readyCheck(e)},a)}}).catch(he.noop)}};ye.Cluster=Gp.default;ye.Command=rt.default;ye.defaultOptions=Vp.DEFAULT_REDIS_OPTIONS;(0,Yp.default)(ye,Ya.EventEmitter);(0,Kp.addTransactionSupport)(ye.prototype);En.default=ye});var Ja=d((w,Xa)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.print=w.ReplyError=w.SentinelIterator=w.SentinelConnector=w.AbstractConnector=w.Pipeline=w.ScanStream=w.Command=w.Cluster=w.Redis=w.default=void 0;w=Xa.exports=fe().default;var Xp=fe();Object.defineProperty(w,"default",{enumerable:!0,get:function(){return Xp.default}});var Jp=fe();Object.defineProperty(w,"Redis",{enumerable:!0,get:function(){return Jp.default}});var Zp=Ys();Object.defineProperty(w,"Cluster",{enumerable:!0,get:function(){return Zp.default}});var ey=re();Object.defineProperty(w,"Command",{enumerable:!0,get:function(){return ey.default}});var ty=$t();Object.defineProperty(w,"ScanStream",{enumerable:!0,get:function(){return ty.default}});var ry=Rs();Object.defineProperty(w,"Pipeline",{enumerable:!0,get:function(){return ry.default}});var sy=Yt();Object.defineProperty(w,"AbstractConnector",{enumerable:!0,get:function(){return sy.default}});var Wa=Xt();Object.defineProperty(w,"SentinelConnector",{enumerable:!0,get:function(){return Wa.default}});Object.defineProperty(w,"SentinelIterator",{enumerable:!0,get:function(){return Wa.SentinelIterator}});w.ReplyError=be().ReplyError;Object.defineProperty(w,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(t){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function ny(t,e){console.log(t?"Error: "+t:"Reply: "+e)}w.print=ny});var Be=d((wn,ec)=>{var tr=require("buffer"),Z=tr.Buffer;function Za(t,e){for(var r in t)e[r]=t[r]}Z.from&&Z.alloc&&Z.allocUnsafe&&Z.allocUnsafeSlow?ec.exports=tr:(Za(tr,wn),wn.Buffer=ke);function ke(t,e,r){return Z(t,e,r)}ke.prototype=Object.create(Z.prototype);Za(Z,ke);ke.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Z(t,e,r)};ke.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var s=Z(t);return e!==void 0?typeof r=="string"?s.fill(e,r):s.fill(e):s.fill(0),s};ke.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Z(t)};ke.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return tr.SlowBuffer(t)}});var kn=d((PE,tc)=>{var rr=Be().Buffer,oy=require("stream"),ay=require("util");function sr(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=rr.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=rr.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}ay.inherits(sr,oy);sr.prototype.write=function(e){this.buffer=rr.concat([this.buffer,rr.from(e)]),this.emit("data",e)};sr.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};tc.exports=sr});var sc=d((LE,rc)=>{"use strict";function vn(t){var e=(t/8|0)+(t%8===0?0:1);return e}var cy={ES256:vn(256),ES384:vn(384),ES512:vn(521)};function uy(t){var e=cy[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}rc.exports=uy});var fc=d((DE,uc)=>{"use strict";var nr=Be().Buffer,ic=sc(),ir=128,oc=0,fy=32,ly=16,dy=2,ac=ly|fy|oc<<6,or=dy|oc<<6;function hy(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function cc(t){if(nr.isBuffer(t))return t;if(typeof t=="string")return nr.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function py(t,e){t=cc(t);var r=ic(e),s=r+1,n=t.length,i=0;if(t[i++]!==ac)throw new Error('Could not find expected "seq"');var o=t[i++];if(o===(ir|1)&&(o=t[i++]),n-i<o)throw new Error('"seq" specified length of "'+o+'", only "'+(n-i)+'" remaining');if(t[i++]!==or)throw new Error('Could not find expected "int" for "r"');var c=t[i++];if(n-i-2<c)throw new Error('"r" specified length of "'+c+'", only "'+(n-i-2)+'" available');if(s<c)throw new Error('"r" specified length of "'+c+'", max of "'+s+'" is acceptable');var a=i;if(i+=c,t[i++]!==or)throw new Error('Could not find expected "int" for "s"');var u=t[i++];if(n-i!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(n-i)+'"');if(s<u)throw new Error('"s" specified length of "'+u+'", max of "'+s+'" is acceptable');var l=i;if(i+=u,i!==n)throw new Error('Expected to consume entire buffer, but "'+(n-i)+'" bytes remain');var f=r-c,p=r-u,h=nr.allocUnsafe(f+c+p+u);for(i=0;i<f;++i)h[i]=0;t.copy(h,i,a+Math.max(-f,0),a+c),i=r;for(var x=i;i<x+p;++i)h[i]=0;return t.copy(h,i,l+Math.max(-p,0),l+u),h=h.toString("base64"),h=hy(h),h}function nc(t,e,r){for(var s=0;e+s<r&&t[e+s]===0;)++s;var n=t[e+s]>=ir;return n&&--s,s}function yy(t,e){t=cc(t);var r=ic(e),s=t.length;if(s!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+s+'"');var n=nc(t,0,r),i=nc(t,r,t.length),o=r-n,c=r-i,a=2+o+1+1+c,u=a<ir,l=nr.allocUnsafe((u?2:3)+a),f=0;return l[f++]=ac,u?l[f++]=a:(l[f++]=ir|1,l[f++]=a&255),l[f++]=or,l[f++]=o,n<0?(l[f++]=0,f+=t.copy(l,f,0,r)):f+=t.copy(l,f,n,r),l[f++]=or,l[f++]=c,i<0?(l[f++]=0,t.copy(l,f,r)):t.copy(l,f,r+i),l}uc.exports={derToJose:py,joseToDer:yy}});var dc=d((BE,lc)=>{"use strict";var st=require("buffer").Buffer,An=require("buffer").SlowBuffer;lc.exports=ar;function ar(t,e){if(!st.isBuffer(t)||!st.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,s=0;s<t.length;s++)r|=t[s]^e[s];return r===0}ar.install=function(){st.prototype.equal=An.prototype.equal=function(e){return ar(this,e)}};var gy=st.prototype.equal,my=An.prototype.equal;ar.restore=function(){st.prototype.equal=gy,An.prototype.equal=my}});var Rn=d((jE,Ec)=>{var Fe=Be().Buffer,Q=require("crypto"),pc=fc(),hc=require("util"),xy=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,nt="secret must be a string or buffer",je="key must be a string or a buffer",by="key must be a string, a buffer or an object",_n=typeof Q.createPublicKey=="function";_n&&(je+=" or a KeyObject",nt+="or a KeyObject");function yc(t){if(!Fe.isBuffer(t)&&typeof t!="string"&&(!_n||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw Y(je)}function gc(t){if(!Fe.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw Y(by)}function Sy(t){if(!Fe.isBuffer(t)){if(typeof t=="string")return t;if(!_n||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw Y(nt)}}function On(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function mc(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function Y(t){var e=[].slice.call(arguments,1),r=hc.format.bind(hc,t).apply(null,e);return new TypeError(r)}function Ey(t){return Fe.isBuffer(t)||typeof t=="string"}function it(t){return Ey(t)||(t=JSON.stringify(t)),t}function xc(t){return function(r,s){Sy(s),r=it(r);var n=Q.createHmac("sha"+t,s),i=(n.update(r),n.digest("base64"));return On(i)}}var Cn,wy="timingSafeEqual"in Q?function(e,r){return e.byteLength!==r.byteLength?!1:Q.timingSafeEqual(e,r)}:function(e,r){return Cn||(Cn=dc()),Cn(e,r)};function ky(t){return function(r,s,n){var i=xc(t)(r,n);return wy(Fe.from(s),Fe.from(i))}}function bc(t){return function(r,s){gc(s),r=it(r);var n=Q.createSign("RSA-SHA"+t),i=(n.update(r),n.sign(s,"base64"));return On(i)}}function Sc(t){return function(r,s,n){yc(n),r=it(r),s=mc(s);var i=Q.createVerify("RSA-SHA"+t);return i.update(r),i.verify(n,s,"base64")}}function vy(t){return function(r,s){gc(s),r=it(r);var n=Q.createSign("RSA-SHA"+t),i=(n.update(r),n.sign({key:s,padding:Q.constants.RSA_PKCS1_PSS_PADDING,saltLength:Q.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return On(i)}}function Ay(t){return function(r,s,n){yc(n),r=it(r),s=mc(s);var i=Q.createVerify("RSA-SHA"+t);return i.update(r),i.verify({key:n,padding:Q.constants.RSA_PKCS1_PSS_PADDING,saltLength:Q.constants.RSA_PSS_SALTLEN_DIGEST},s,"base64")}}function Cy(t){var e=bc(t);return function(){var s=e.apply(null,arguments);return s=pc.derToJose(s,"ES"+t),s}}function _y(t){var e=Sc(t);return function(s,n,i){n=pc.joseToDer(n,"ES"+t).toString("base64");var o=e(s,n,i);return o}}function Oy(){return function(){return""}}function Ry(){return function(e,r){return r===""}}Ec.exports=function(e){var r={hs:xc,rs:bc,ps:vy,es:Cy,none:Oy},s={hs:ky,rs:Sc,ps:Ay,es:_y,none:Ry},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw Y(xy,e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:r[i](o),verify:s[i](o)}}});var Tn=d((FE,wc)=>{var Ty=require("buffer").Buffer;wc.exports=function(e){return typeof e=="string"?e:typeof e=="number"||Ty.isBuffer(e)?e.toString():JSON.stringify(e)}});var Oc=d(($E,_c)=>{var Iy=Be().Buffer,kc=kn(),Ny=Rn(),qy=require("stream"),vc=Tn(),In=require("util");function Ac(t,e){return Iy.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function My(t,e,r){r=r||"utf8";var s=Ac(vc(t),"binary"),n=Ac(vc(e),r);return In.format("%s.%s",s,n)}function Cc(t){var e=t.header,r=t.payload,s=t.secret||t.privateKey,n=t.encoding,i=Ny(e.alg),o=My(e,r,n),c=i.sign(o,s);return In.format("%s.%s",o,c)}function cr(t){var e=t.secret||t.privateKey||t.key,r=new kc(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new kc(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}In.inherits(cr,qy);cr.prototype.sign=function(){try{var e=Cc({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}};cr.sign=Cc;_c.exports=cr});var Bc=d((UE,Dc)=>{var Tc=Be().Buffer,Rc=kn(),Py=Rn(),Ly=require("stream"),Ic=Tn(),Dy=require("util"),By=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function jy(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fy(t){if(jy(t))return t;try{return JSON.parse(t)}catch{return}}function Nc(t){var e=t.split(".",1)[0];return Fy(Tc.from(e,"base64").toString("binary"))}function $y(t){return t.split(".",2).join(".")}function qc(t){return t.split(".")[2]}function Uy(t,e){e=e||"utf8";var r=t.split(".")[1];return Tc.from(r,"base64").toString(e)}function Mc(t){return By.test(t)&&!!Nc(t)}function Pc(t,e,r){if(!e){var s=new Error("Missing algorithm parameter for jws.verify");throw s.code="MISSING_ALGORITHM",s}t=Ic(t);var n=qc(t),i=$y(t),o=Py(e);return o.verify(i,n,r)}function Lc(t,e){if(e=e||{},t=Ic(t),!Mc(t))return null;var r=Nc(t);if(!r)return null;var s=Uy(t);return(r.typ==="JWT"||e.json)&&(s=JSON.parse(s,e.encoding)),{header:r,payload:s,signature:qc(t)}}function $e(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new Rc(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new Rc(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}Dy.inherits($e,Ly);$e.prototype.verify=function(){try{var e=Pc(this.signature.buffer,this.algorithm,this.key.buffer),r=Lc(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(s){this.readable=!1,this.emit("error",s),this.emit("close")}};$e.decode=Lc;$e.isValid=Mc;$e.verify=Pc;Dc.exports=$e});var fr=d(ge=>{var jc=Oc(),ur=Bc(),Gy=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];ge.ALGORITHMS=Gy;ge.sign=jc.sign;ge.verify=ur.verify;ge.decode=ur.decode;ge.isValid=ur.isValid;ge.createSign=function(e){return new jc(e)};ge.createVerify=function(e){return new ur(e)}});var Nn=d((HE,Fc)=>{var Hy=fr();Fc.exports=function(t,e){e=e||{};var r=Hy.decode(t,e);if(!r)return null;var s=r.payload;if(typeof s=="string")try{var n=JSON.parse(s);n!==null&&typeof n=="object"&&(s=n)}catch{}return e.complete===!0?{header:r.header,payload:s,signature:r.signature}:s}});var ot=d((QE,$c)=>{var lr=function(t,e){Error.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=t,e&&(this.inner=e)};lr.prototype=Object.create(Error.prototype);lr.prototype.constructor=lr;$c.exports=lr});var qn=d((VE,Gc)=>{var Uc=ot(),dr=function(t,e){Uc.call(this,t),this.name="NotBeforeError",this.date=e};dr.prototype=Object.create(Uc.prototype);dr.prototype.constructor=dr;Gc.exports=dr});var Mn=d((zE,Qc)=>{var Hc=ot(),hr=function(t,e){Hc.call(this,t),this.name="TokenExpiredError",this.expiredAt=e};hr.prototype=Object.create(Hc.prototype);hr.prototype.constructor=hr;Qc.exports=hr});var Pn=d((KE,Vc)=>{var Qy=ls();Vc.exports=function(t,e){var r=e||Math.floor(Date.now()/1e3);if(typeof t=="string"){var s=Qy(t);return typeof s>"u"?void 0:Math.floor(r+s/1e3)}else return typeof t=="number"?r+t:void 0}});var at=d((YE,zc)=>{"use strict";var Vy="2.0.0",zy=Number.MAX_SAFE_INTEGER||9007199254740991,Ky=16,Yy=250,Wy=["major","premajor","minor","preminor","patch","prepatch","prerelease"];zc.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Ky,MAX_SAFE_BUILD_LENGTH:Yy,MAX_SAFE_INTEGER:zy,RELEASE_TYPES:Wy,SEMVER_SPEC_VERSION:Vy,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ct=d((WE,Kc)=>{"use strict";var Xy=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};Kc.exports=Xy});var Ue=d((ee,Yc)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Ln,MAX_SAFE_BUILD_LENGTH:Jy,MAX_LENGTH:Zy}=at(),eg=ct();ee=Yc.exports={};var tg=ee.re=[],rg=ee.safeRe=[],y=ee.src=[],sg=ee.safeSrc=[],g=ee.t={},ng=0,Dn="[a-zA-Z0-9-]",ig=[["\\s",1],["\\d",Zy],[Dn,Jy]],og=t=>{for(let[e,r]of ig)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},b=(t,e,r)=>{let s=og(e),n=ng++;eg(t,n,e),g[t]=n,y[n]=e,sg[n]=s,tg[n]=new RegExp(e,r?"g":void 0),rg[n]=new RegExp(s,r?"g":void 0)};b("NUMERICIDENTIFIER","0|[1-9]\\d*");b("NUMERICIDENTIFIERLOOSE","\\d+");b("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Dn}*`);b("MAINVERSION",`(${y[g.NUMERICIDENTIFIER]})\\.(${y[g.NUMERICIDENTIFIER]})\\.(${y[g.NUMERICIDENTIFIER]})`);b("MAINVERSIONLOOSE",`(${y[g.NUMERICIDENTIFIERLOOSE]})\\.(${y[g.NUMERICIDENTIFIERLOOSE]})\\.(${y[g.NUMERICIDENTIFIERLOOSE]})`);b("PRERELEASEIDENTIFIER",`(?:${y[g.NONNUMERICIDENTIFIER]}|${y[g.NUMERICIDENTIFIER]})`);b("PRERELEASEIDENTIFIERLOOSE",`(?:${y[g.NONNUMERICIDENTIFIER]}|${y[g.NUMERICIDENTIFIERLOOSE]})`);b("PRERELEASE",`(?:-(${y[g.PRERELEASEIDENTIFIER]}(?:\\.${y[g.PRERELEASEIDENTIFIER]})*))`);b("PRERELEASELOOSE",`(?:-?(${y[g.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${y[g.PRERELEASEIDENTIFIERLOOSE]})*))`);b("BUILDIDENTIFIER",`${Dn}+`);b("BUILD",`(?:\\+(${y[g.BUILDIDENTIFIER]}(?:\\.${y[g.BUILDIDENTIFIER]})*))`);b("FULLPLAIN",`v?${y[g.MAINVERSION]}${y[g.PRERELEASE]}?${y[g.BUILD]}?`);b("FULL",`^${y[g.FULLPLAIN]}$`);b("LOOSEPLAIN",`[v=\\s]*${y[g.MAINVERSIONLOOSE]}${y[g.PRERELEASELOOSE]}?${y[g.BUILD]}?`);b("LOOSE",`^${y[g.LOOSEPLAIN]}$`);b("GTLT","((?:<|>)?=?)");b("XRANGEIDENTIFIERLOOSE",`${y[g.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);b("XRANGEIDENTIFIER",`${y[g.NUMERICIDENTIFIER]}|x|X|\\*`);b("XRANGEPLAIN",`[v=\\s]*(${y[g.XRANGEIDENTIFIER]})(?:\\.(${y[g.XRANGEIDENTIFIER]})(?:\\.(${y[g.XRANGEIDENTIFIER]})(?:${y[g.PRERELEASE]})?${y[g.BUILD]}?)?)?`);b("XRANGEPLAINLOOSE",`[v=\\s]*(${y[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${y[g.XRANGEIDENTIFIERLOOSE]})(?:${y[g.PRERELEASELOOSE]})?${y[g.BUILD]}?)?)?`);b("XRANGE",`^${y[g.GTLT]}\\s*${y[g.XRANGEPLAIN]}$`);b("XRANGELOOSE",`^${y[g.GTLT]}\\s*${y[g.XRANGEPLAINLOOSE]}$`);b("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Ln}})(?:\\.(\\d{1,${Ln}}))?(?:\\.(\\d{1,${Ln}}))?`);b("COERCE",`${y[g.COERCEPLAIN]}(?:$|[^\\d])`);b("COERCEFULL",y[g.COERCEPLAIN]+`(?:${y[g.PRERELEASE]})?(?:${y[g.BUILD]})?(?:$|[^\\d])`);b("COERCERTL",y[g.COERCE],!0);b("COERCERTLFULL",y[g.COERCEFULL],!0);b("LONETILDE","(?:~>?)");b("TILDETRIM",`(\\s*)${y[g.LONETILDE]}\\s+`,!0);ee.tildeTrimReplace="$1~";b("TILDE",`^${y[g.LONETILDE]}${y[g.XRANGEPLAIN]}$`);b("TILDELOOSE",`^${y[g.LONETILDE]}${y[g.XRANGEPLAINLOOSE]}$`);b("LONECARET","(?:\\^)");b("CARETTRIM",`(\\s*)${y[g.LONECARET]}\\s+`,!0);ee.caretTrimReplace="$1^";b("CARET",`^${y[g.LONECARET]}${y[g.XRANGEPLAIN]}$`);b("CARETLOOSE",`^${y[g.LONECARET]}${y[g.XRANGEPLAINLOOSE]}$`);b("COMPARATORLOOSE",`^${y[g.GTLT]}\\s*(${y[g.LOOSEPLAIN]})$|^$`);b("COMPARATOR",`^${y[g.GTLT]}\\s*(${y[g.FULLPLAIN]})$|^$`);b("COMPARATORTRIM",`(\\s*)${y[g.GTLT]}\\s*(${y[g.LOOSEPLAIN]}|${y[g.XRANGEPLAIN]})`,!0);ee.comparatorTrimReplace="$1$2$3";b("HYPHENRANGE",`^\\s*(${y[g.XRANGEPLAIN]})\\s+-\\s+(${y[g.XRANGEPLAIN]})\\s*$`);b("HYPHENRANGELOOSE",`^\\s*(${y[g.XRANGEPLAINLOOSE]})\\s+-\\s+(${y[g.XRANGEPLAINLOOSE]})\\s*$`);b("STAR","(<|>)?=?\\s*\\*");b("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");b("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var pr=d((XE,Wc)=>{"use strict";var ag=Object.freeze({loose:!0}),cg=Object.freeze({}),ug=t=>t?typeof t!="object"?ag:t:cg;Wc.exports=ug});var Bn=d((JE,Zc)=>{"use strict";var Xc=/^[0-9]+$/,Jc=(t,e)=>{if(typeof t=="number"&&typeof e=="number")return t===e?0:t<e?-1:1;let r=Xc.test(t),s=Xc.test(e);return r&&s&&(t=+t,e=+e),t===e?0:r&&!s?-1:s&&!r?1:t<e?-1:1},fg=(t,e)=>Jc(e,t);Zc.exports={compareIdentifiers:Jc,rcompareIdentifiers:fg}});var M=d((ZE,tu)=>{"use strict";var yr=ct(),{MAX_LENGTH:eu,MAX_SAFE_INTEGER:gr}=at(),{safeRe:mr,t:xr}=Ue(),lg=pr(),{compareIdentifiers:jn}=Bn(),Fn=class t{constructor(e,r){if(r=lg(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>eu)throw new TypeError(`version is longer than ${eu} characters`);yr("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let s=e.trim().match(r.loose?mr[xr.LOOSE]:mr[xr.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>gr||this.major<0)throw new TypeError("Invalid major version");if(this.minor>gr||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>gr||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let i=+n;if(i>=0&&i<gr)return i}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(yr("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let s=this.prerelease[r],n=e.prerelease[r];if(yr("prerelease compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return jn(s,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let s=this.build[r],n=e.build[r];if(yr("build compare",r,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return jn(s,n)}while(++r)}inc(e,r,s){if(e.startsWith("pre")){if(!r&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n=`-${r}`.match(this.options.loose?mr[xr.PRERELEASELOOSE]:mr[xr.PRERELEASE]);if(!n||n[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,s),this.inc("pre",r,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,s),this.inc("pre",r,s);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(s)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let i=[r,n];s===!1&&(i=[r]),jn(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};tu.exports=Fn});var ve=d((ew,su)=>{"use strict";var ru=M(),dg=(t,e,r=!1)=>{if(t instanceof ru)return t;try{return new ru(t,e)}catch(s){if(!r)return null;throw s}};su.exports=dg});var iu=d((tw,nu)=>{"use strict";var hg=ve(),pg=(t,e)=>{let r=hg(t,e);return r?r.version:null};nu.exports=pg});var au=d((rw,ou)=>{"use strict";var yg=ve(),gg=(t,e)=>{let r=yg(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};ou.exports=gg});var fu=d((sw,uu)=>{"use strict";var cu=M(),mg=(t,e,r,s,n)=>{typeof r=="string"&&(n=s,s=r,r=void 0);try{return new cu(t instanceof cu?t.version:t,r).inc(e,s,n).version}catch{return null}};uu.exports=mg});var hu=d((nw,du)=>{"use strict";var lu=ve(),xg=(t,e)=>{let r=lu(t,null,!0),s=lu(e,null,!0),n=r.compare(s);if(n===0)return null;let i=n>0,o=i?r:s,c=i?s:r,a=!!o.prerelease.length;if(!!c.prerelease.length&&!a){if(!c.patch&&!c.minor)return"major";if(c.compareMain(o)===0)return c.minor&&!c.patch?"minor":"patch"}let l=a?"pre":"";return r.major!==s.major?l+"major":r.minor!==s.minor?l+"minor":r.patch!==s.patch?l+"patch":"prerelease"};du.exports=xg});var yu=d((iw,pu)=>{"use strict";var bg=M(),Sg=(t,e)=>new bg(t,e).major;pu.exports=Sg});var mu=d((ow,gu)=>{"use strict";var Eg=M(),wg=(t,e)=>new Eg(t,e).minor;gu.exports=wg});var bu=d((aw,xu)=>{"use strict";var kg=M(),vg=(t,e)=>new kg(t,e).patch;xu.exports=vg});var Eu=d((cw,Su)=>{"use strict";var Ag=ve(),Cg=(t,e)=>{let r=Ag(t,e);return r&&r.prerelease.length?r.prerelease:null};Su.exports=Cg});var V=d((uw,ku)=>{"use strict";var wu=M(),_g=(t,e,r)=>new wu(t,r).compare(new wu(e,r));ku.exports=_g});var Au=d((fw,vu)=>{"use strict";var Og=V(),Rg=(t,e,r)=>Og(e,t,r);vu.exports=Rg});var _u=d((lw,Cu)=>{"use strict";var Tg=V(),Ig=(t,e)=>Tg(t,e,!0);Cu.exports=Ig});var br=d((dw,Ru)=>{"use strict";var Ou=M(),Ng=(t,e,r)=>{let s=new Ou(t,r),n=new Ou(e,r);return s.compare(n)||s.compareBuild(n)};Ru.exports=Ng});var Iu=d((hw,Tu)=>{"use strict";var qg=br(),Mg=(t,e)=>t.sort((r,s)=>qg(r,s,e));Tu.exports=Mg});var qu=d((pw,Nu)=>{"use strict";var Pg=br(),Lg=(t,e)=>t.sort((r,s)=>Pg(s,r,e));Nu.exports=Lg});var ut=d((yw,Mu)=>{"use strict";var Dg=V(),Bg=(t,e,r)=>Dg(t,e,r)>0;Mu.exports=Bg});var Sr=d((gw,Pu)=>{"use strict";var jg=V(),Fg=(t,e,r)=>jg(t,e,r)<0;Pu.exports=Fg});var $n=d((mw,Lu)=>{"use strict";var $g=V(),Ug=(t,e,r)=>$g(t,e,r)===0;Lu.exports=Ug});var Un=d((xw,Du)=>{"use strict";var Gg=V(),Hg=(t,e,r)=>Gg(t,e,r)!==0;Du.exports=Hg});var Er=d((bw,Bu)=>{"use strict";var Qg=V(),Vg=(t,e,r)=>Qg(t,e,r)>=0;Bu.exports=Vg});var wr=d((Sw,ju)=>{"use strict";var zg=V(),Kg=(t,e,r)=>zg(t,e,r)<=0;ju.exports=Kg});var Gn=d((Ew,Fu)=>{"use strict";var Yg=$n(),Wg=Un(),Xg=ut(),Jg=Er(),Zg=Sr(),em=wr(),tm=(t,e,r,s)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Yg(t,r,s);case"!=":return Wg(t,r,s);case">":return Xg(t,r,s);case">=":return Jg(t,r,s);case"<":return Zg(t,r,s);case"<=":return em(t,r,s);default:throw new TypeError(`Invalid operator: ${e}`)}};Fu.exports=tm});var Uu=d((ww,$u)=>{"use strict";var rm=M(),sm=ve(),{safeRe:kr,t:vr}=Ue(),nm=(t,e)=>{if(t instanceof rm)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?kr[vr.COERCEFULL]:kr[vr.COERCE]);else{let a=e.includePrerelease?kr[vr.COERCERTLFULL]:kr[vr.COERCERTL],u;for(;(u=a.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||u.index+u[0].length!==r.index+r[0].length)&&(r=u),a.lastIndex=u.index+u[1].length+u[2].length;a.lastIndex=-1}if(r===null)return null;let s=r[2],n=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return sm(`${s}.${n}.${i}${o}${c}`,e)};$u.exports=nm});var Hu=d((kw,Gu)=>{"use strict";var Hn=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};Gu.exports=Hn});var z=d((vw,Ku)=>{"use strict";var im=/\s+/g,Qn=class t{constructor(e,r){if(r=am(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Vn)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(im," "),this.set=this.raw.split("||").map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let s=this.set[0];if(this.set=this.set.filter(n=>!Vu(n[0])),this.set.length===0)this.set=[s];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&pm(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let s=0;s<r.length;s++)s>0&&(this.formatted+=" "),this.formatted+=r[s].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let s=((this.options.includePrerelease&&dm)|(this.options.loose&&hm))+":"+e,n=Qu.get(s);if(n)return n;let i=this.options.loose,o=i?D[P.HYPHENRANGELOOSE]:D[P.HYPHENRANGE];e=e.replace(o,vm(this.options.includePrerelease)),A("hyphen replace",e),e=e.replace(D[P.COMPARATORTRIM],um),A("comparator trim",e),e=e.replace(D[P.TILDETRIM],fm),A("tilde trim",e),e=e.replace(D[P.CARETTRIM],lm),A("caret trim",e);let c=e.split(" ").map(f=>ym(f,this.options)).join(" ").split(/\s+/).map(f=>km(f,this.options));i&&(c=c.filter(f=>(A("loose invalid filter",f,this.options),!!f.match(D[P.COMPARATORLOOSE])))),A("range list",c);let a=new Map,u=c.map(f=>new Vn(f,this.options));for(let f of u){if(Vu(f))return[f];a.set(f.value,f)}a.size>1&&a.has("")&&a.delete("");let l=[...a.values()];return Qu.set(s,l),l}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(s=>zu(s,r)&&e.set.some(n=>zu(n,r)&&s.every(i=>n.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new cm(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Am(this.set[r],e,this.options))return!0;return!1}};Ku.exports=Qn;var om=Hu(),Qu=new om,am=pr(),Vn=ft(),A=ct(),cm=M(),{safeRe:D,t:P,comparatorTrimReplace:um,tildeTrimReplace:fm,caretTrimReplace:lm}=Ue(),{FLAG_INCLUDE_PRERELEASE:dm,FLAG_LOOSE:hm}=at(),Vu=t=>t.value==="<0.0.0-0",pm=t=>t.value==="",zu=(t,e)=>{let r=!0,s=t.slice(),n=s.pop();for(;r&&s.length;)r=s.every(i=>n.intersects(i,e)),n=s.pop();return r},ym=(t,e)=>(t=t.replace(D[P.BUILD],""),A("comp",t,e),t=xm(t,e),A("caret",t),t=gm(t,e),A("tildes",t),t=Sm(t,e),A("xrange",t),t=wm(t,e),A("stars",t),t),B=t=>!t||t.toLowerCase()==="x"||t==="*",gm=(t,e)=>t.trim().split(/\s+/).map(r=>mm(r,e)).join(" "),mm=(t,e)=>{let r=e.loose?D[P.TILDELOOSE]:D[P.TILDE];return t.replace(r,(s,n,i,o,c)=>{A("tilde",t,s,n,i,o,c);let a;return B(n)?a="":B(i)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:B(o)?a=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:c?(A("replaceTilde pr",c),a=`>=${n}.${i}.${o}-${c} <${n}.${+i+1}.0-0`):a=`>=${n}.${i}.${o} <${n}.${+i+1}.0-0`,A("tilde return",a),a})},xm=(t,e)=>t.trim().split(/\s+/).map(r=>bm(r,e)).join(" "),bm=(t,e)=>{A("caret",t,e);let r=e.loose?D[P.CARETLOOSE]:D[P.CARET],s=e.includePrerelease?"-0":"";return t.replace(r,(n,i,o,c,a)=>{A("caret",t,n,i,o,c,a);let u;return B(i)?u="":B(o)?u=`>=${i}.0.0${s} <${+i+1}.0.0-0`:B(c)?i==="0"?u=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.0${s} <${+i+1}.0.0-0`:a?(A("replaceCaret pr",a),i==="0"?o==="0"?u=`>=${i}.${o}.${c}-${a} <${i}.${o}.${+c+1}-0`:u=`>=${i}.${o}.${c}-${a} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${c}-${a} <${+i+1}.0.0-0`):(A("no pr"),i==="0"?o==="0"?u=`>=${i}.${o}.${c}${s} <${i}.${o}.${+c+1}-0`:u=`>=${i}.${o}.${c}${s} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${c} <${+i+1}.0.0-0`),A("caret return",u),u})},Sm=(t,e)=>(A("replaceXRanges",t,e),t.split(/\s+/).map(r=>Em(r,e)).join(" ")),Em=(t,e)=>{t=t.trim();let r=e.loose?D[P.XRANGELOOSE]:D[P.XRANGE];return t.replace(r,(s,n,i,o,c,a)=>{A("xRange",t,s,n,i,o,c,a);let u=B(i),l=u||B(o),f=l||B(c),p=f;return n==="="&&p&&(n=""),a=e.includePrerelease?"-0":"",u?n===">"||n==="<"?s="<0.0.0-0":s="*":n&&p?(l&&(o=0),c=0,n===">"?(n=">=",l?(i=+i+1,o=0,c=0):(o=+o+1,c=0)):n==="<="&&(n="<",l?i=+i+1:o=+o+1),n==="<"&&(a="-0"),s=`${n+i}.${o}.${c}${a}`):l?s=`>=${i}.0.0${a} <${+i+1}.0.0-0`:f&&(s=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`),A("xRange return",s),s})},wm=(t,e)=>(A("replaceStars",t,e),t.trim().replace(D[P.STAR],"")),km=(t,e)=>(A("replaceGTE0",t,e),t.trim().replace(D[e.includePrerelease?P.GTE0PRE:P.GTE0],"")),vm=t=>(e,r,s,n,i,o,c,a,u,l,f,p)=>(B(s)?r="":B(n)?r=`>=${s}.0.0${t?"-0":""}`:B(i)?r=`>=${s}.${n}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,B(u)?a="":B(l)?a=`<${+u+1}.0.0-0`:B(f)?a=`<${u}.${+l+1}.0-0`:p?a=`<=${u}.${l}.${f}-${p}`:t?a=`<${u}.${l}.${+f+1}-0`:a=`<=${a}`,`${r} ${a}`.trim()),Am=(t,e,r)=>{for(let s=0;s<t.length;s++)if(!t[s].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let s=0;s<t.length;s++)if(A(t[s].semver),t[s].semver!==Vn.ANY&&t[s].semver.prerelease.length>0){let n=t[s].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var ft=d((Aw,ef)=>{"use strict";var lt=Symbol("SemVer ANY"),Yn=class t{static get ANY(){return lt}constructor(e,r){if(r=Yu(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Kn("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===lt?this.value="":this.value=this.operator+this.semver.version,Kn("comp",this)}parse(e){let r=this.options.loose?Wu[Xu.COMPARATORLOOSE]:Wu[Xu.COMPARATOR],s=e.match(r);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=s[1]!==void 0?s[1]:"",this.operator==="="&&(this.operator=""),s[2]?this.semver=new Ju(s[2],this.options.loose):this.semver=lt}toString(){return this.value}test(e){if(Kn("Comparator.test",e,this.options.loose),this.semver===lt||e===lt)return!0;if(typeof e=="string")try{e=new Ju(e,this.options)}catch{return!1}return zn(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Zu(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new Zu(this.value,r).test(e.semver):(r=Yu(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||zn(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||zn(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};ef.exports=Yn;var Yu=pr(),{safeRe:Wu,t:Xu}=Ue(),zn=Gn(),Kn=ct(),Ju=M(),Zu=z()});var dt=d((Cw,tf)=>{"use strict";var Cm=z(),_m=(t,e,r)=>{try{e=new Cm(e,r)}catch{return!1}return e.test(t)};tf.exports=_m});var sf=d((_w,rf)=>{"use strict";var Om=z(),Rm=(t,e)=>new Om(t,e).set.map(r=>r.map(s=>s.value).join(" ").trim().split(" "));rf.exports=Rm});var of=d((Ow,nf)=>{"use strict";var Tm=M(),Im=z(),Nm=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Im(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===-1)&&(s=o,n=new Tm(s,r))}),s};nf.exports=Nm});var cf=d((Rw,af)=>{"use strict";var qm=M(),Mm=z(),Pm=(t,e,r)=>{let s=null,n=null,i=null;try{i=new Mm(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!s||n.compare(o)===1)&&(s=o,n=new qm(s,r))}),s};af.exports=Pm});var lf=d((Tw,ff)=>{"use strict";var Wn=M(),Lm=z(),uf=ut(),Dm=(t,e)=>{t=new Lm(t,e);let r=new Wn("0.0.0");if(t.test(r)||(r=new Wn("0.0.0-0"),t.test(r)))return r;r=null;for(let s=0;s<t.set.length;++s){let n=t.set[s],i=null;n.forEach(o=>{let c=new Wn(o.semver.version);switch(o.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!i||uf(c,i))&&(i=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||uf(r,i))&&(r=i)}return r&&t.test(r)?r:null};ff.exports=Dm});var hf=d((Iw,df)=>{"use strict";var Bm=z(),jm=(t,e)=>{try{return new Bm(t,e).range||"*"}catch{return null}};df.exports=jm});var Ar=d((Nw,mf)=>{"use strict";var Fm=M(),gf=ft(),{ANY:$m}=gf,Um=z(),Gm=dt(),pf=ut(),yf=Sr(),Hm=wr(),Qm=Er(),Vm=(t,e,r,s)=>{t=new Fm(t,s),e=new Um(e,s);let n,i,o,c,a;switch(r){case">":n=pf,i=Hm,o=yf,c=">",a=">=";break;case"<":n=yf,i=Qm,o=pf,c="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Gm(t,e,s))return!1;for(let u=0;u<e.set.length;++u){let l=e.set[u],f=null,p=null;if(l.forEach(h=>{h.semver===$m&&(h=new gf(">=0.0.0")),f=f||h,p=p||h,n(h.semver,f.semver,s)?f=h:o(h.semver,p.semver,s)&&(p=h)}),f.operator===c||f.operator===a||(!p.operator||p.operator===c)&&i(t,p.semver))return!1;if(p.operator===a&&o(t,p.semver))return!1}return!0};mf.exports=Vm});var bf=d((qw,xf)=>{"use strict";var zm=Ar(),Km=(t,e,r)=>zm(t,e,">",r);xf.exports=Km});var Ef=d((Mw,Sf)=>{"use strict";var Ym=Ar(),Wm=(t,e,r)=>Ym(t,e,"<",r);Sf.exports=Wm});var vf=d((Pw,kf)=>{"use strict";var wf=z(),Xm=(t,e,r)=>(t=new wf(t,r),e=new wf(e,r),t.intersects(e,r));kf.exports=Xm});var Cf=d((Lw,Af)=>{"use strict";var Jm=dt(),Zm=V();Af.exports=(t,e,r)=>{let s=[],n=null,i=null,o=t.sort((l,f)=>Zm(l,f,r));for(let l of o)Jm(l,e,r)?(i=l,n||(n=l)):(i&&s.push([n,i]),i=null,n=null);n&&s.push([n,null]);let c=[];for(let[l,f]of s)l===f?c.push(l):!f&&l===o[0]?c.push("*"):f?l===o[0]?c.push(`<=${f}`):c.push(`${l} - ${f}`):c.push(`>=${l}`);let a=c.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return a.length<u.length?a:e}});var Nf=d((Dw,If)=>{"use strict";var _f=z(),Jn=ft(),{ANY:Xn}=Jn,ht=dt(),Zn=V(),ex=(t,e,r={})=>{if(t===e)return!0;t=new _f(t,r),e=new _f(e,r);let s=!1;e:for(let n of t.set){for(let i of e.set){let o=rx(n,i,r);if(s=s||o!==null,o)continue e}if(s)return!1}return!0},tx=[new Jn(">=0.0.0-0")],Of=[new Jn(">=0.0.0")],rx=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===Xn){if(e.length===1&&e[0].semver===Xn)return!0;r.includePrerelease?t=tx:t=Of}if(e.length===1&&e[0].semver===Xn){if(r.includePrerelease)return!0;e=Of}let s=new Set,n,i;for(let h of t)h.operator===">"||h.operator===">="?n=Rf(n,h,r):h.operator==="<"||h.operator==="<="?i=Tf(i,h,r):s.add(h.semver);if(s.size>1)return null;let o;if(n&&i){if(o=Zn(n.semver,i.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||i.operator!=="<="))return null}for(let h of s){if(n&&!ht(h,String(n),r)||i&&!ht(h,String(i),r))return null;for(let x of e)if(!ht(h,String(x),r))return!1;return!0}let c,a,u,l,f=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,p=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;f&&f.prerelease.length===1&&i.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let h of e){if(l=l||h.operator===">"||h.operator===">=",u=u||h.operator==="<"||h.operator==="<=",n){if(p&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===p.major&&h.semver.minor===p.minor&&h.semver.patch===p.patch&&(p=!1),h.operator===">"||h.operator===">="){if(c=Rf(n,h,r),c===h&&c!==n)return!1}else if(n.operator===">="&&!ht(n.semver,String(h),r))return!1}if(i){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(a=Tf(i,h,r),a===h&&a!==i)return!1}else if(i.operator==="<="&&!ht(i.semver,String(h),r))return!1}if(!h.operator&&(i||n)&&o!==0)return!1}return!(n&&u&&!i&&o!==0||i&&l&&!n&&o!==0||p||f)},Rf=(t,e,r)=>{if(!t)return e;let s=Zn(t.semver,e.semver,r);return s>0?t:s<0||e.operator===">"&&t.operator===">="?e:t},Tf=(t,e,r)=>{if(!t)return e;let s=Zn(t.semver,e.semver,r);return s<0?t:s>0||e.operator==="<"&&t.operator==="<="?e:t};If.exports=ex});var Cr=d((Bw,Pf)=>{"use strict";var ei=Ue(),qf=at(),sx=M(),Mf=Bn(),nx=ve(),ix=iu(),ox=au(),ax=fu(),cx=hu(),ux=yu(),fx=mu(),lx=bu(),dx=Eu(),hx=V(),px=Au(),yx=_u(),gx=br(),mx=Iu(),xx=qu(),bx=ut(),Sx=Sr(),Ex=$n(),wx=Un(),kx=Er(),vx=wr(),Ax=Gn(),Cx=Uu(),_x=ft(),Ox=z(),Rx=dt(),Tx=sf(),Ix=of(),Nx=cf(),qx=lf(),Mx=hf(),Px=Ar(),Lx=bf(),Dx=Ef(),Bx=vf(),jx=Cf(),Fx=Nf();Pf.exports={parse:nx,valid:ix,clean:ox,inc:ax,diff:cx,major:ux,minor:fx,patch:lx,prerelease:dx,compare:hx,rcompare:px,compareLoose:yx,compareBuild:gx,sort:mx,rsort:xx,gt:bx,lt:Sx,eq:Ex,neq:wx,gte:kx,lte:vx,cmp:Ax,coerce:Cx,Comparator:_x,Range:Ox,satisfies:Rx,toComparators:Tx,maxSatisfying:Ix,minSatisfying:Nx,minVersion:qx,validRange:Mx,outside:Px,gtr:Lx,ltr:Dx,intersects:Bx,simplifyRange:jx,subset:Fx,SemVer:sx,re:ei.re,src:ei.src,tokens:ei.t,SEMVER_SPEC_VERSION:qf.SEMVER_SPEC_VERSION,RELEASE_TYPES:qf.RELEASE_TYPES,compareIdentifiers:Mf.compareIdentifiers,rcompareIdentifiers:Mf.rcompareIdentifiers}});var Df=d((jw,Lf)=>{var $x=Cr();Lf.exports=$x.satisfies(process.version,">=15.7.0")});var jf=d((Fw,Bf)=>{var Ux=Cr();Bf.exports=Ux.satisfies(process.version,">=16.9.0")});var ti=d(($w,Ff)=>{var Gx=Df(),Hx=jf(),Qx={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},Vx={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};Ff.exports=function(t,e){if(!t||!e)return;let r=e.asymmetricKeyType;if(!r)return;let s=Qx[r];if(!s)throw new Error(`Unknown key type "${r}".`);if(!s.includes(t))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${s.join(", ")}.`);if(Gx)switch(r){case"ec":let n=e.asymmetricKeyDetails.namedCurve,i=Vx[t];if(n!==i)throw new Error(`"alg" parameter "${t}" requires curve "${i}".`);break;case"rsa-pss":if(Hx){let o=parseInt(t.slice(-3),10),{hashAlgorithm:c,mgf1HashAlgorithm:a,saltLength:u}=e.asymmetricKeyDetails;if(c!==`sha${o}`||a!==c)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}.`);if(u!==void 0&&u>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}.`)}break}}});var ri=d((Uw,$f)=>{var zx=Cr();$f.exports=zx.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Hf=d((Gw,Gf)=>{var k=ot(),Kx=qn(),Uf=Mn(),Yx=Nn(),Wx=Pn(),Xx=ti(),Jx=ri(),Zx=fr(),{KeyObject:eb,createSecretKey:tb,createPublicKey:rb}=require("crypto"),si=["RS256","RS384","RS512"],sb=["ES256","ES384","ES512"],ni=["RS256","RS384","RS512"],nb=["HS256","HS384","HS512"];Jx&&(si.splice(si.length,0,"PS256","PS384","PS512"),ni.splice(ni.length,0,"PS256","PS384","PS512"));Gf.exports=function(t,e,r,s){typeof r=="function"&&!s&&(s=r,r={}),r||(r={}),r=Object.assign({},r);let n;if(s?n=s:n=function(l,f){if(l)throw l;return f},r.clockTimestamp&&typeof r.clockTimestamp!="number")return n(new k("clockTimestamp must be a number"));if(r.nonce!==void 0&&(typeof r.nonce!="string"||r.nonce.trim()===""))return n(new k("nonce must be a non-empty string"));if(r.allowInvalidAsymmetricKeyTypes!==void 0&&typeof r.allowInvalidAsymmetricKeyTypes!="boolean")return n(new k("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!t)return n(new k("jwt must be provided"));if(typeof t!="string")return n(new k("jwt must be a string"));let o=t.split(".");if(o.length!==3)return n(new k("jwt malformed"));let c;try{c=Yx(t,{complete:!0})}catch(l){return n(l)}if(!c)return n(new k("invalid token"));let a=c.header,u;if(typeof e=="function"){if(!s)return n(new k("verify must be called asynchronous if secret or public key is provided as a callback"));u=e}else u=function(l,f){return f(null,e)};return u(a,function(l,f){if(l)return n(new k("error in secret or public key callback: "+l.message));let p=o[2].trim()!=="";if(!p&&f)return n(new k("jwt signature is required"));if(p&&!f)return n(new k("secret or public key must be provided"));if(!p&&!r.algorithms)return n(new k('please specify "none" in "algorithms" to verify unsigned tokens'));if(f!=null&&!(f instanceof eb))try{f=rb(f)}catch{try{f=tb(typeof f=="string"?Buffer.from(f):f)}catch{return n(new k("secretOrPublicKey is not valid key material"))}}if(r.algorithms||(f.type==="secret"?r.algorithms=nb:["rsa","rsa-pss"].includes(f.asymmetricKeyType)?r.algorithms=ni:f.asymmetricKeyType==="ec"?r.algorithms=sb:r.algorithms=si),r.algorithms.indexOf(c.header.alg)===-1)return n(new k("invalid algorithm"));if(a.alg.startsWith("HS")&&f.type!=="secret")return n(new k(`secretOrPublicKey must be a symmetric key when using ${a.alg}`));if(/^(?:RS|PS|ES)/.test(a.alg)&&f.type!=="public")return n(new k(`secretOrPublicKey must be an asymmetric key when using ${a.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{Xx(a.alg,f)}catch(E){return n(E)}let h;try{h=Zx.verify(t,c.header.alg,f)}catch(E){return n(E)}if(!h)return n(new k("invalid signature"));let x=c.payload;if(typeof x.nbf<"u"&&!r.ignoreNotBefore){if(typeof x.nbf!="number")return n(new k("invalid nbf value"));if(x.nbf>i+(r.clockTolerance||0))return n(new Kx("jwt not active",new Date(x.nbf*1e3)))}if(typeof x.exp<"u"&&!r.ignoreExpiration){if(typeof x.exp!="number")return n(new k("invalid exp value"));if(i>=x.exp+(r.clockTolerance||0))return n(new Uf("jwt expired",new Date(x.exp*1e3)))}if(r.audience){let E=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(x.aud)?x.aud:[x.aud]).some(function(xe){return E.some(function(Ge){return Ge instanceof RegExp?Ge.test(xe):Ge===xe})}))return n(new k("jwt audience invalid. expected: "+E.join(" or ")))}if(r.issuer&&(typeof r.issuer=="string"&&x.iss!==r.issuer||Array.isArray(r.issuer)&&r.issuer.indexOf(x.iss)===-1))return n(new k("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&x.sub!==r.subject)return n(new k("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&x.jti!==r.jwtid)return n(new k("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&x.nonce!==r.nonce)return n(new k("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if(typeof x.iat!="number")return n(new k("iat required when maxAge is specified"));let E=Wx(r.maxAge,x.iat);if(typeof E>"u")return n(new k('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=E+(r.clockTolerance||0))return n(new Uf("maxAge exceeded",new Date(E*1e3)))}if(r.complete===!0){let E=c.signature;return n(null,{header:a,payload:x,signature:E})}return n(null,x)})}});var Wf=d((Hw,Yf)=>{var Qf=1/0,zf=9007199254740991,ib=17976931348623157e292,Vf=NaN,ob="[object Arguments]",ab="[object Function]",cb="[object GeneratorFunction]",ub="[object String]",fb="[object Symbol]",lb=/^\s+|\s+$/g,db=/^[-+]0x[0-9a-f]+$/i,hb=/^0b[01]+$/i,pb=/^0o[0-7]+$/i,yb=/^(?:0|[1-9]\d*)$/,gb=parseInt;function mb(t,e){for(var r=-1,s=t?t.length:0,n=Array(s);++r<s;)n[r]=e(t[r],r,t);return n}function xb(t,e,r,s){for(var n=t.length,i=r+(s?1:-1);s?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function bb(t,e,r){if(e!==e)return xb(t,Sb,r);for(var s=r-1,n=t.length;++s<n;)if(t[s]===e)return s;return-1}function Sb(t){return t!==t}function Eb(t,e){for(var r=-1,s=Array(t);++r<t;)s[r]=e(r);return s}function wb(t,e){return mb(e,function(r){return t[r]})}function kb(t,e){return function(r){return t(e(r))}}var _r=Object.prototype,oi=_r.hasOwnProperty,Or=_r.toString,vb=_r.propertyIsEnumerable,Ab=kb(Object.keys,Object),Cb=Math.max;function _b(t,e){var r=Kf(t)||Nb(t)?Eb(t.length,String):[],s=r.length,n=!!s;for(var i in t)(e||oi.call(t,i))&&!(n&&(i=="length"||Rb(i,s)))&&r.push(i);return r}function Ob(t){if(!Tb(t))return Ab(t);var e=[];for(var r in Object(t))oi.call(t,r)&&r!="constructor"&&e.push(r);return e}function Rb(t,e){return e=e??zf,!!e&&(typeof t=="number"||yb.test(t))&&t>-1&&t%1==0&&t<e}function Tb(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||_r;return t===r}function Ib(t,e,r,s){t=ai(t)?t:Ub(t),r=r&&!s?jb(r):0;var n=t.length;return r<0&&(r=Cb(n+r,0)),Lb(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&bb(t,e,r)>-1}function Nb(t){return qb(t)&&oi.call(t,"callee")&&(!vb.call(t,"callee")||Or.call(t)==ob)}var Kf=Array.isArray;function ai(t){return t!=null&&Pb(t.length)&&!Mb(t)}function qb(t){return ci(t)&&ai(t)}function Mb(t){var e=ii(t)?Or.call(t):"";return e==ab||e==cb}function Pb(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=zf}function ii(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function ci(t){return!!t&&typeof t=="object"}function Lb(t){return typeof t=="string"||!Kf(t)&&ci(t)&&Or.call(t)==ub}function Db(t){return typeof t=="symbol"||ci(t)&&Or.call(t)==fb}function Bb(t){if(!t)return t===0?t:0;if(t=Fb(t),t===Qf||t===-Qf){var e=t<0?-1:1;return e*ib}return t===t?t:0}function jb(t){var e=Bb(t),r=e%1;return e===e?r?e-r:e:0}function Fb(t){if(typeof t=="number")return t;if(Db(t))return Vf;if(ii(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ii(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(lb,"");var r=hb.test(t);return r||pb.test(t)?gb(t.slice(2),r?2:8):db.test(t)?Vf:+t}function $b(t){return ai(t)?_b(t):Ob(t)}function Ub(t){return t?wb(t,$b(t)):[]}Yf.exports=Ib});var Jf=d((Qw,Xf)=>{var Gb="[object Boolean]",Hb=Object.prototype,Qb=Hb.toString;function Vb(t){return t===!0||t===!1||zb(t)&&Qb.call(t)==Gb}function zb(t){return!!t&&typeof t=="object"}Xf.exports=Vb});var sl=d((Vw,rl)=>{var Zf=1/0,Kb=17976931348623157e292,el=NaN,Yb="[object Symbol]",Wb=/^\s+|\s+$/g,Xb=/^[-+]0x[0-9a-f]+$/i,Jb=/^0b[01]+$/i,Zb=/^0o[0-7]+$/i,e1=parseInt,t1=Object.prototype,r1=t1.toString;function s1(t){return typeof t=="number"&&t==a1(t)}function tl(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function n1(t){return!!t&&typeof t=="object"}function i1(t){return typeof t=="symbol"||n1(t)&&r1.call(t)==Yb}function o1(t){if(!t)return t===0?t:0;if(t=c1(t),t===Zf||t===-Zf){var e=t<0?-1:1;return e*Kb}return t===t?t:0}function a1(t){var e=o1(t),r=e%1;return e===e?r?e-r:e:0}function c1(t){if(typeof t=="number")return t;if(i1(t))return el;if(tl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=tl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Wb,"");var r=Jb.test(t);return r||Zb.test(t)?e1(t.slice(2),r?2:8):Xb.test(t)?el:+t}rl.exports=s1});var il=d((zw,nl)=>{var u1="[object Number]",f1=Object.prototype,l1=f1.toString;function d1(t){return!!t&&typeof t=="object"}function h1(t){return typeof t=="number"||d1(t)&&l1.call(t)==u1}nl.exports=h1});var ul=d((Kw,cl)=>{var p1="[object Object]";function y1(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function g1(t,e){return function(r){return t(e(r))}}var m1=Function.prototype,ol=Object.prototype,al=m1.toString,x1=ol.hasOwnProperty,b1=al.call(Object),S1=ol.toString,E1=g1(Object.getPrototypeOf,Object);function w1(t){return!!t&&typeof t=="object"}function k1(t){if(!w1(t)||S1.call(t)!=p1||y1(t))return!1;var e=E1(t);if(e===null)return!0;var r=x1.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&al.call(r)==b1}cl.exports=k1});var ll=d((Yw,fl)=>{var v1="[object String]",A1=Object.prototype,C1=A1.toString,_1=Array.isArray;function O1(t){return!!t&&typeof t=="object"}function R1(t){return typeof t=="string"||!_1(t)&&O1(t)&&C1.call(t)==v1}fl.exports=R1});var gl=d((Ww,yl)=>{var T1="Expected a function",dl=1/0,I1=17976931348623157e292,hl=NaN,N1="[object Symbol]",q1=/^\s+|\s+$/g,M1=/^[-+]0x[0-9a-f]+$/i,P1=/^0b[01]+$/i,L1=/^0o[0-7]+$/i,D1=parseInt,B1=Object.prototype,j1=B1.toString;function F1(t,e){var r;if(typeof e!="function")throw new TypeError(T1);return t=Q1(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}function $1(t){return F1(2,t)}function pl(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function U1(t){return!!t&&typeof t=="object"}function G1(t){return typeof t=="symbol"||U1(t)&&j1.call(t)==N1}function H1(t){if(!t)return t===0?t:0;if(t=V1(t),t===dl||t===-dl){var e=t<0?-1:1;return e*I1}return t===t?t:0}function Q1(t){var e=H1(t),r=e%1;return e===e?r?e-r:e:0}function V1(t){if(typeof t=="number")return t;if(G1(t))return hl;if(pl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=pl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(q1,"");var r=P1.test(t);return r||L1.test(t)?D1(t.slice(2),r?2:8):M1.test(t)?hl:+t}yl.exports=$1});var Al=d((Xw,vl)=>{var ml=Pn(),z1=ri(),K1=ti(),xl=fr(),Y1=Wf(),Rr=Jf(),bl=sl(),ui=il(),El=ul(),me=ll(),W1=gl(),{KeyObject:X1,createSecretKey:J1,createPrivateKey:Z1}=require("crypto"),wl=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];z1&&wl.splice(3,0,"PS256","PS384","PS512");var eS={expiresIn:{isValid:function(t){return bl(t)||me(t)&&t},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(t){return bl(t)||me(t)&&t},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(t){return me(t)||Array.isArray(t)},message:'"audience" must be a string or array'},algorithm:{isValid:Y1.bind(null,wl),message:'"algorithm" must be a valid string enum value'},header:{isValid:El,message:'"header" must be an object'},encoding:{isValid:me,message:'"encoding" must be a string'},issuer:{isValid:me,message:'"issuer" must be a string'},subject:{isValid:me,message:'"subject" must be a string'},jwtid:{isValid:me,message:'"jwtid" must be a string'},noTimestamp:{isValid:Rr,message:'"noTimestamp" must be a boolean'},keyid:{isValid:me,message:'"keyid" must be a string'},mutatePayload:{isValid:Rr,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Rr,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Rr,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},tS={iat:{isValid:ui,message:'"iat" should be a number of seconds'},exp:{isValid:ui,message:'"exp" should be a number of seconds'},nbf:{isValid:ui,message:'"nbf" should be a number of seconds'}};function kl(t,e,r,s){if(!El(r))throw new Error('Expected "'+s+'" to be a plain object.');Object.keys(r).forEach(function(n){let i=t[n];if(!i){if(!e)throw new Error('"'+n+'" is not allowed in "'+s+'"');return}if(!i.isValid(r[n]))throw new Error(i.message)})}function rS(t){return kl(eS,!1,t,"options")}function sS(t){return kl(tS,!0,t,"payload")}var Sl={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},nS=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];vl.exports=function(t,e,r,s){typeof r=="function"?(s=r,r={}):r=r||{};let n=typeof t=="object"&&!Buffer.isBuffer(t),i=Object.assign({alg:r.algorithm||"HS256",typ:n?"JWT":void 0,kid:r.keyid},r.header);function o(u){if(s)return s(u);throw u}if(!e&&r.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof X1))try{e=Z1(e)}catch{try{e=J1(typeof e=="string"?Buffer.from(e):e)}catch{return o(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&e.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(e.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof t>"u")return o(new Error("payload is required"));if(n){try{sS(t)}catch(u){return o(u)}r.mutatePayload||(t=Object.assign({},t))}else{let u=nS.filter(function(l){return typeof r[l]<"u"});if(u.length>0)return o(new Error("invalid "+u.join(",")+" option for "+typeof t+" payload"))}if(typeof t.exp<"u"&&typeof r.expiresIn<"u")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof t.nbf<"u"&&typeof r.notBefore<"u")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{rS(r)}catch(u){return o(u)}if(!r.allowInvalidAsymmetricKeyTypes)try{K1(i.alg,e)}catch(u){return o(u)}let c=t.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete t.iat:n&&(t.iat=c),typeof r.notBefore<"u"){try{t.nbf=ml(r.notBefore,c)}catch(u){return o(u)}if(typeof t.nbf>"u")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof r.expiresIn<"u"&&typeof t=="object"){try{t.exp=ml(r.expiresIn,c)}catch(u){return o(u)}if(typeof t.exp>"u")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(Sl).forEach(function(u){let l=Sl[u];if(typeof r[u]<"u"){if(typeof t[l]<"u")return o(new Error('Bad "options.'+u+'" option. The payload already has an "'+l+'" property.'));t[l]=r[u]}});let a=r.encoding||"utf8";if(typeof s=="function")s=s&&W1(s),xl.createSign({header:i,privateKey:e,payload:t,encoding:a}).once("error",s).once("done",function(u){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)return s(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));s(null,u)});else{let u=xl.sign({header:i,payload:t,secret:e,encoding:a});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return u}}});var _l=d((Jw,Cl)=>{Cl.exports={decode:Nn(),verify:Hf(),sign:Al(),JsonWebTokenError:ot(),NotBeforeError:qn(),TokenExpiredError:Mn()}});var dS={};Fl(dS,{approveReelRequest:()=>fS,createReelRequest:()=>cS,denyReelRequest:()=>lS,listReelRequests:()=>uS});module.exports=di(dS);var xi=mt(mi(),1),Nr;function Ae(){return Nr||(Nr=new xi.PrismaClient),Nr}var t0=process.env.FRONTEND_URL||"http://localhost:5173",r0=process.env.NODE_ENV||"development",bi=r0==="production",s0=()=>{let t=[t0];return bi&&t.push("https://dkmxy676d3vgc.cloudfront.net"),bi||t.push("http://localhost:3000","http://localhost:5173"),t},Si=t=>{let e=s0(),r=t?.headers?.origin||t?.headers?.Origin||"";return{"Access-Control-Allow-Origin":e.includes(r)?r:e[0],"Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,DELETE,PATCH,OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization,X-CSRF-Token","Access-Control-Max-Age":"86400"}};function Ce(t,e=200,r={}){let s=Si(r.event);return delete r.event,{statusCode:e,headers:{"content-type":"application/json",...s,"x-content-type-options":"nosniff","referrer-policy":"strict-origin-when-cross-origin","permissions-policy":"camera=(), microphone=(), geolocation=()","strict-transport-security":"max-age=63072000; includeSubDomains; preload",...r},body:JSON.stringify(t)}}function v(t,e=400,r={}){return Ce({error:t},e,r)}var bS=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;var SS="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");var aS=mt(eo(),1);var RS=process.env.CSRF_ENABLED==="true";var iy=mt(Ja(),1);var RE={auth:{maxRequests:10,windowMs:9e5,message:"Too many authentication attempts. Please try again later."},emailVerification:{maxRequests:5,windowMs:36e5,message:"Too many verification email requests. Please try again later."},reports:{maxRequests:parseInt(process.env.REPORTS_MAX_PER_HOUR||"5",10),windowMs:36e5,message:"Too many reports submitted. Please try again later."},write:{maxRequests:100,windowMs:36e5,message:"Too many write requests. Please try again later."},read:{maxRequests:1e3,windowMs:36e5,message:"Too many read requests. Please try again later."}};var Ol=mt(_l(),1);var iS=process.env.JWT_SECRET||"dev-secret-key-change-in-production";var Zw=process.env.COOKIE_DOMAIN||void 0,e2=process.env.NODE_ENV||"development";var Rl=t=>{try{return Ol.default.verify(t,iS)}catch{return null}},Tl=(t,e="access")=>{let r=e==="access"?"access_token":"refresh_token",s=oS(t.headers?.cookie||t.headers?.Cookie||"");if(s[r])return s[r];if(e==="access"){let n=t.headers?.authorization||t.headers?.Authorization;if(n&&n.startsWith("Bearer "))return n.substring(7)}return null},oS=t=>{let e={};return t&&t.split(";").forEach(r=>{let[s,...n]=r.split("=");s&&n.length>0&&(e[s.trim()]=n.join("=").trim())}),e};var Il=t=>{let e=Tl(t,"access");if(!e)return null;let r=Rl(e);return!r||r.type!=="access"?null:r.userId||null};function pt(t){try{return Il(t)||null}catch{return null}}var cS=async t=>{try{let{id:e}=t.pathParameters||{};if(!e)return v("mediaId is required",400);let r=pt(t);if(!r)return v("Unauthorized",401);let s=JSON.parse(t.body||"{}"),{message:n}=s,i=Ae(),o=await i.media.findUnique({where:{id:e},include:{profile:{include:{user:{select:{id:!0,username:!0,displayName:!0}}}}}});if(!o)return v("Media not found",404);if(o.privacy!=="on-request")return v("This media does not require access requests",400);let c=o.profile.userId;if(r===c)return v("You cannot request access to your own media",400);let a=await i.reelRequest.findUnique({where:{mediaId_requesterId:{mediaId:e,requesterId:r}}});if(a){if(a.status==="approved")return v("You already have access to this media",400);if(a.status==="pending")return v("You already have a pending request for this media",400);if(a.status==="denied")return v("Your previous request was denied",400)}let u=await i.reelRequest.create({data:{mediaId:e,requesterId:r,ownerId:c,message:n||null,status:"pending"},include:{requester:{select:{id:!0,username:!0,displayName:!0,avatar:!0}},media:{select:{id:!0,type:!0,title:!0,posterS3Key:!0}}}});return await i.notification.create({data:{type:"reel_request",message:`${u.requester.displayName} requested access to your ${o.type}`,recipientId:c,triggererId:r,metadata:{requestId:u.id,mediaId:e}}}),Ce(u,201)}catch(e){return console.error("Create reel request error:",e),v("Server error: "+e.message,500)}},uS=async t=>{try{let e=pt(t);if(!e)return v("Unauthorized",401);let{status:r,type:s="received"}=t.queryStringParameters||{},n=Ae(),i=s==="sent"?{requesterId:e}:{ownerId:e};r&&(i.status=r);let o=await n.reelRequest.findMany({where:i,include:{requester:{select:{id:!0,username:!0,displayName:!0,avatar:!0}},owner:{select:{id:!0,username:!0,displayName:!0,avatar:!0}},media:{select:{id:!0,type:!0,title:!0,description:!0,posterS3Key:!0}}},orderBy:{createdAt:"desc"}});return Ce(o)}catch(e){return console.error("List reel requests error:",e),v("Server error: "+e.message,500)}},fS=async t=>{try{let{id:e}=t.pathParameters||{};if(!e)return v("id is required",400);let r=pt(t);if(!r)return v("Unauthorized",401);let s=JSON.parse(t.body||"{}"),{response:n}=s,i=Ae(),o=await i.reelRequest.findUnique({where:{id:e},include:{media:!0}});if(!o)return v("Request not found",404);if(o.ownerId!==r)return v("Forbidden - not media owner",403);if(o.status!=="pending")return v("Request has already been processed",400);let c=await i.reelRequest.update({where:{id:e},data:{status:"approved",response:n||null},include:{requester:{select:{id:!0,username:!0,displayName:!0,avatar:!0}},media:{select:{id:!0,type:!0,title:!0}}}});return await i.notification.create({data:{type:"reel_request_approved",message:`Your request to view "${o.media.title||"a reel"}" has been approved`,recipientId:o.requesterId,triggererId:r,metadata:{requestId:e,mediaId:o.mediaId}}}),Ce(c)}catch(e){return console.error("Approve reel request error:",e),v("Server error: "+e.message,500)}},lS=async t=>{try{let{id:e}=t.pathParameters||{};if(!e)return v("id is required",400);let r=pt(t);if(!r)return v("Unauthorized",401);let s=JSON.parse(t.body||"{}"),{response:n}=s,i=Ae(),o=await i.reelRequest.findUnique({where:{id:e},include:{media:!0}});if(!o)return v("Request not found",404);if(o.ownerId!==r)return v("Forbidden - not media owner",403);if(o.status!=="pending")return v("Request has already been processed",400);let c=await i.reelRequest.update({where:{id:e},data:{status:"denied",response:n||null},include:{requester:{select:{id:!0,username:!0,displayName:!0,avatar:!0}},media:{select:{id:!0,type:!0,title:!0}}}});return await i.notification.create({data:{type:"reel_request_denied",message:`Your request to view "${o.media.title||"a reel"}" has been denied`,recipientId:o.requesterId,triggererId:r,metadata:{requestId:e,mediaId:o.mediaId}}}),Ce(c)}catch(e){return console.error("Deny reel request error:",e),v("Server error: "+e.message,500)}};0&&(module.exports={approveReelRequest,createReelRequest,denyReelRequest,listReelRequests});
/*! Bundled license information:

@otplib/plugin-crypto/index.js:
  (**
   * @otplib/plugin-crypto
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/plugin-thirty-two/index.js:
  (**
   * @otplib/plugin-thirty-two
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/core/index.js:
  (**
   * @otplib/core
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

@otplib/preset-default/index.js:
  (**
   * @otplib/preset-default
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

otplib/index.js:
  (**
   * otplib
   *
   * @author Gerald Yeo <contact@fusedthought.com>
   * @version: 12.0.1
   * @license: MIT
   **)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
